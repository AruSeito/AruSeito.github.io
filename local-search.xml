<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ç¼“å­˜èƒŒé”…ï¼Ÿ</title>
    <link href="/article/85e77354/"/>
    <url>/article/85e77354/</url>
    
    <content type="html"><![CDATA[<h2 id="èµ·å› "><a href="#èµ·å› " class="headerlink" title="èµ·å› "></a>èµ·å› </h2><p>æˆ‘ä»¬å›½å†…ç«™æœ‰åšä¸­å›½ä¼ ç»ŸèŠ‚å‡æ—¥çš„æé†’ï¼Œå› ä¸ºä¸­å›½ä¼ ç»ŸèŠ‚å‡æ—¥ä¸å¤ªæ–¹ä¾¿è®¡ç®—ï¼Œæ‰€ä»¥æ¯å¹´éƒ½è¦åœ¨å¯¹è±¡å­˜å‚¨æ¡¶é‡Œæ›´æ–°å¯¹åº”çš„æ–‡ä»¶ã€‚</p><p>å¤§å‰å¤©æ¥åˆ°å·¥å•åé¦ˆè¯´æˆ‘ä»¬æ²¡æœ‰ 2022 å¹´çš„æ—¥å†æé†’ï¼Œç„¶åè¿ç»´åŒå­¦å°±åœ¨å¯¹åº”æ–‡ä»¶è¿›è¡Œäº†æ–‡ä»¶çš„æ›´æ–°ã€‚</p><p>è¿‡äº†ä¸€ä¼šå„¿ä¹‹åæµ‹è¯•åŒå­¦è·Ÿæˆ‘è¯´ï¼šweb è¿™é¢æ²¡åŠæ³•æ‹‰å–åˆ°æœ€æ–°çš„æ–‡ä»¶ï¼Œä½†æ˜¯ç›´æ¥è®¿é—®è¯·æ±‚å¯ä»¥æ‹¿åˆ°ã€‚è¿˜ç»™æˆ‘æˆªå›¾çœ‹äº†ä¸€ä¸‹è¯·æ±‚å¤´ï¼Œè¯´æˆ‘æ²¡æŒ‰ç…§å½“æ—¶çš„æ–¹æ¡ˆåšï¼šè¯·æ±‚çš„æ—¶å€™åŠ ä¸Š<code>if-modified-since</code>è¿™ä¸ªã€‚</p><p>æˆ‘å¯»æ€ç€è¿™äº›ä¸œè¥¿ç°åœ¨æµè§ˆå™¨ä¸éƒ½æ˜¯ä¼šè‡ªåŠ¨åŠ ä¸Šå—ï¼Ÿç„¶åè‡ªå·±å»çº¿ä¸Šçœ‹äº†ä¸€ä¸‹ï¼Œä¹Ÿæ‹‰åˆ°äº†æœ€æ–°çš„èŠ‚æ—¥ä¿¡æ¯ï¼Œæ— æ³•å¤ç°ã€‚ç„¶åç”¨äº†å¦å¤–å‡ ä¸ªåŒå­¦çš„ç”µè„‘ï¼ˆä¸€å®šä¼šæœ‰ç¼“å­˜ï¼Œä½†æ˜¯æœ€è¿‘ä¸¤å¤©æ²¡æ‰“å¼€è¿‡çº¿ä¸Šçš„ï¼‰çœ‹äº†ä¸€ä¸‹ä¹Ÿæ²¡é—®é¢˜ã€‚</p><p>ä¸€è„¸æ‡µé€¼ï¼Œåªèƒ½å…ˆç”©é”…å†è¯´ï¼šå½“æ—¶åšè¿™ä¸ªåŠŸèƒ½çš„æ—¶å€™ä¸æ˜¯æµ‹è¯•è¿‡ç¼“å­˜å—ï¼Ÿå½“æ—¶éƒ½æ˜¯æ­£å¸¸çš„ï¼Œæœ€è¿‘ä¹Ÿæ²¡éœ€æ±‚æ”¹åŠ¨è¿™ä¸ªï¼Œè‚¯å®šæ²¡é—®é¢˜å•Šã€‚</p><h2 id="è¿½å› "><a href="#è¿½å› " class="headerlink" title="è¿½å› "></a>è¿½å› </h2><p>å…ˆæ¸…æ¥šè‡ªå·±çš„ç¼“å­˜ï¼Œç„¶ååœ¨æµ‹è¯•ç¯å¢ƒçœ‹ä¸€ä¸‹è¯·æ±‚ï¼Œæ²¡ä»€ä¹ˆå¤§é—®é¢˜ã€‚å¤šäº†å‡ ä¸ªç‰¹æ®Šå­—æ®µå¼•èµ·äº†æˆ‘çš„æ³¨æ„ï¼š<code>x-swift-cachetime</code>å’Œ<code>x-swift-savetime</code>ã€‚</p><p>æŸ¥çœ‹äº†ä¸€ä¸‹é˜¿é‡Œäº‘çš„è¯´æ˜ï¼š</p><ul><li><code>x-swift-savetime</code>:ä»£è¡¨å¼€å§‹åœ¨ cdn ä¸Šç¼“å­˜çš„æ—¶é—´</li><li><code>x-swift-cachetime</code>:cdn é»˜è®¤ç¼“å­˜æ—¶é—´,è¶…è¿‡äº†è¿™ä¸ªæ—¶é—´ï¼Œè¯¥ç¼“å­˜å°±ä¸¢å¼ƒäº†ï¼Œéœ€è¦é‡æ–°å›æºè·å–ã€‚</li><li><code>age</code>:ä»£è¡¨åœ¨ cdn ä¸Šå·²ç»ç¼“å­˜çš„æ—¶é—´</li></ul><p>ä¸€ä¸ªå¤§èƒ†çš„æƒ³æ³•åœ¨æˆ‘è„‘æµ·ä¸­æˆç«‹ï¼š</p><p>è¿ç»´åœ¨æ›´æ–°å¥½æ–‡ä»¶ä¹‹åï¼Œå¹¶æ²¡æœ‰æŒ‰ç…§ä»¥å¾€çš„å¼ºåˆ¶åˆ·æ–° cdn ç¼“å­˜ï¼Œç„¶åå› ä¸ºæˆ‘ä»¬çš„çº¿ä¸Šç¯å¢ƒ<code>cachetime</code>æ˜¯ 3600sï¼Œæ‰€ä»¥æµ‹è¯•åŒå­¦å¯èƒ½æ˜¯åœ¨ 3600s å†…åœ¨ web é¡µé¢è¿›è¡Œäº†æµ‹è¯•ï¼Œå‘ç°æ²¡æœ‰æ›´æ–°ï¼Œç„¶åå»ç›´æ¥è®¿é—®æ–‡ä»¶é“¾æ¥ï¼Œä½†æ˜¯è¿™æ—¶å€™å·²ç»è¿‡äº† 3600sï¼Œæ‰€ä»¥ä¸€é¢æ‹¿åˆ°çš„æ˜¯è€çš„ï¼Œä¸€é¢æ‹¿åˆ°çš„æ˜¯æ–°çš„ã€‚</p><p>ç„¶åå¼€å§‹å®è·µ</p><h2 id="å¤ç›˜"><a href="#å¤ç›˜" class="headerlink" title="å¤ç›˜"></a>å¤ç›˜</h2><p>é¦–å…ˆåœ¨æµ‹è¯•ç¯å¢ƒçœ‹äº†ä¸€ä¸‹<code>cachetime</code>ä¸º 13ï¼Œé‚£æˆ‘åœ¨ 13s å†…å’Œ 13s ååˆ†åˆ«è¯·æ±‚ä¸€æ¬¡è¿™ä¸ªæ–‡ä»¶çœ‹çœ‹ä»€ä¹ˆæ•ˆæœã€‚</p><p>13s å†…è¯·æ±‚å‘ç°ï¼šchromeDevTools æ˜¾ç¤ºçŠ¶æ€ä»£ç  200ï¼Œæ¥è‡ªç£ç›˜ç¼“å­˜ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/20211030/13%E5%86%85%E8%AF%B7%E6%B1%82.png" alt="13så†…çš„è¯·æ±‚"></p><p>13 åè¯·æ±‚å‘ç°ï¼šçŠ¶æ€ç è¿˜æ˜¯ 200ï¼Œè¯·æ±‚å¤´å†…å¸¦ä¸Šäº†<code>if-modified-since</code>å’Œ<code>if-none-match</code>ï¼Œå“åº” tab é‡Œæç¤ºæ­¤è¯·æ±‚æ²¡æœ‰å¯ç”¨çš„å“åº”æ•°æ®</p><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/20211030/13%E5%A4%96%E8%AF%B7%E6%B1%82.png" alt="13såçš„è¯·æ±‚"></p><p>okï¼Œç ´æ¡ˆã€‚å’Œæˆ‘æƒ³çš„ä¸€æ ·ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>éšæ‰‹è®°å½•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åå•†ç¼“å­˜</tag>
      
      <tag>å¼ºåˆ¶ç¼“å­˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è™šæ‹Ÿåˆ—è¡¨çš„å®ç°</title>
    <link href="/article/66276cbc/"/>
    <url>/article/66276cbc/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯è™šæ‹Ÿåˆ—è¡¨"><a href="#ä»€ä¹ˆæ˜¯è™šæ‹Ÿåˆ—è¡¨" class="headerlink" title="ä»€ä¹ˆæ˜¯è™šæ‹Ÿåˆ—è¡¨"></a>ä»€ä¹ˆæ˜¯è™šæ‹Ÿåˆ—è¡¨</h2><p>åªæ¸²æŸ“å¯æ˜¯åŒºåŸŸçš„åˆ—è¡¨èŠ‚ç‚¹ï¼Œæ»šåŠ¨çš„æ—¶å€™è¿›è¡Œæ•°æ®çš„åŠ¨æ€æ›¿æ¢ã€‚</p><h2 id="å®ç°æ­¥éª¤"><a href="#å®ç°æ­¥éª¤" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h2><ol><li><p>è®¡ç®—å‡ºå½“å‰å¯è§†åŒºåŸŸèµ·å§‹æ•°æ®çš„ç´¢å¼• startIndex</p></li><li><p>è®¡ç®—å‡ºå½“å‰å¯è§†åŒºåŸŸç»“æŸæ•°æ®çš„ç´¢å¼• endIndex</p></li><li><p>è®¡ç®—å‡ºå½“å‰å¯è§†åŒºåŸŸå†…çš„æ•°æ®ï¼Œå¹¶æ¸²æŸ“</p></li><li><p>æ»šåŠ¨å‘ç”Ÿæ—¶ï¼Œè®¡ç®— startIndex å¯¹åº”çš„æ•°æ®ï¼Œåœ¨æ•´ä¸ªåˆ—è¡¨çš„åç§»ä½ç½® startOffset ï¼Œå¹¶ä¸”æ›´æ–°åˆ°åˆ—è¡¨ä¸Š</p></li></ol><h2 id="ç»“æ„è®¾è®¡"><a href="#ç»“æ„è®¾è®¡" class="headerlink" title="ç»“æ„è®¾è®¡"></a>ç»“æ„è®¾è®¡</h2><ul><li><p>çœŸæ­£æ¸²æŸ“çš„å…ƒç´  virtual-list</p></li><li><p>æ’‘å¼€é«˜åº¦çš„å…ƒç´ ï¼Œä¿è¯æ»šåŠ¨ virtual-list-phantom</p></li><li><p>å®¹å™¨å…ƒç´  virtual-list-container</p></li></ul><h2 id="ç›‘å¬æ»šåŠ¨"><a href="#ç›‘å¬æ»šåŠ¨" class="headerlink" title="ç›‘å¬æ»šåŠ¨"></a>ç›‘å¬æ»šåŠ¨</h2><p>ç›‘å¬ virtual-list-container çš„æ»šåŠ¨äº‹ä»¶ï¼Œè·å–æ»šåŠ¨æ¡åˆ°é¡¶éƒ¨çš„è·ç¦» scrollTop</p><h2 id="éœ€è¦å‡†å¤‡çš„æ•°æ®"><a href="#éœ€è¦å‡†å¤‡çš„æ•°æ®" class="headerlink" title="éœ€è¦å‡†å¤‡çš„æ•°æ®"></a>éœ€è¦å‡†å¤‡çš„æ•°æ®</h2><p>å¯è§†åŒºåŸŸçš„é«˜åº¦ï¼šscreenHeight</p><p>åˆ—è¡¨é¡¹çš„é«˜åº¦ï¼šitemSize</p><p>åˆ—è¡¨æ•°æ®ï¼šlistData</p><p>å½“å‰çš„æ»šåŠ¨ä½ç½®ï¼šscrollTop</p><h2 id="å¾—å‡ºæœ€ç»ˆæƒ³è¦çš„æ•°æ®"><a href="#å¾—å‡ºæœ€ç»ˆæƒ³è¦çš„æ•°æ®" class="headerlink" title="å¾—å‡ºæœ€ç»ˆæƒ³è¦çš„æ•°æ®"></a>å¾—å‡ºæœ€ç»ˆæƒ³è¦çš„æ•°æ®</h2><p>åˆ—è¡¨æ€»é«˜åº¦:<code>listHeight = itemSize * listData.length</code></p><p>å¯æ˜¾ç¤ºçš„åˆ—è¡¨é¡¹æ•°:<code>showedCount = Math.ceil(screenHeight / itemSize)</code></p><p>æ•°æ®çš„èµ·å§‹ç´¢å¼•:<code>startIndex = Math.floor(scrollTop / itemSize)</code></p><p>æ•°æ®çš„ç»“æŸç´¢å¼•:<code>endIndex = startIndex + showedCount</code></p><p>åˆ—è¡¨æ˜¾ç¤ºçš„æ•°æ®:<code>showedData = listData.slice(startIndex,endIndex)</code></p><p>åç§»é‡ï¼ˆåˆ—è¡¨æ•°æ®çš„ç¬¬ä¸€ä¸ªæ•°æ®åˆ°ç°åœ¨å¼€å¤´æ•°æ®çš„ç´¢å¼•çš„å·®å€¼ï¼‰<code>startOffset = scrollTop - (scrollTop % itemSize)</code></p><h2 id="æœ€ç»ˆä»£ç "><a href="#æœ€ç»ˆä»£ç " class="headerlink" title="æœ€ç»ˆä»£ç "></a>æœ€ç»ˆä»£ç </h2><p><a href="https://github.com/AruSeito/daily-practice/blob/main/my-react-app/src/component/VirtualList.jsx">Github</a></p>]]></content>
    
    
    <categories>
      
      <category>æ‰‹æ’•æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>é¡µé¢æ€§èƒ½è°ƒä¼˜è®°å½•</title>
    <link href="/article/86b01b74/"/>
    <url>/article/86b01b74/</url>
    
    <content type="html"><![CDATA[<p>å‰ä¸¤å¤©æ”¶åˆ°æµ‹è¯•çš„åé¦ˆï¼Œæ—¥å†é¡µé¢ä¼šéå¸¸å¡ï¼Œæ¯æ¬¡åˆ‡æ¢æœˆä»½éƒ½è¦å¡é¡¿ 10s å¤šã€‚</p><p>æˆ‘å¯»æ€æœ€è¿‘ä¹Ÿæ²¡æœ‰è¿™é¢çš„éœ€æ±‚å•Šï¼Œä¹Ÿæ²¡æœ‰æ”¹åŠ¨è¿‡ä»€ä¹ˆï¼Œä¸ºå•¥ä¼šå¡å‘¢ã€‚</p><p>è‡´å‘½ç”©é”…ä¸‰è¿é—®ï¼š</p><ol><li><p>æ˜¯ä¸æ˜¯ç”µè„‘é—®é¢˜å•Šï¼Œä½ å…ˆæŠŠä½ æ²¡ç”¨çš„éƒ½å…³äº†å†çœ‹ä¸€ä¸‹</p></li><li><p>æœ€è¿‘ä¹Ÿæ²¡è¿™é¢çš„éœ€æ±‚ï¼Œè¦å¡åº”è¯¥ä¹‹å‰å°±å¡äº†ï¼Œä¸ä¼šè¿™æ—¶å¡å•Šã€‚</p></li><li><p>ä¸è¡Œä½ æ¢ä¸ªæµè§ˆå™¨è¯•è¯•ã€‚</p></li></ol><p>è™½ç„¶æµ‹è¯•è¿™é¢åº”ä»˜è¿‡å»äº†ï¼Œä½†æ˜¯æœ¬ç€æ±‚å®çš„æ€åº¦ï¼Œé»˜é»˜çš„è‡ªå·±æ‰“å¼€äº† DevTools å¼€å§‹æŒ‰ç…§æµ‹è¯•è¯´çš„æ“ä½œæ¥çœ‹ä¸€ä¸‹æ˜¯å¦æœ‰æŠ¥é”™/ç½‘ç»œè¯·æ±‚å¡é¡¿ä¹‹ç±»çš„ã€‚</p><p>ç„¶åå‘ç°æœ‰ä¸ªè¯·æ±‚ï¼Œä»è¿›å…¥ pending åˆ° 200 å¤§æ¦‚ç»å†äº† 10sï¼Œæˆ‘ç‚¹å¼€è¿™ä¸ªè¯·æ±‚ä¸€çœ‹ï¼Œæˆ‘éº»äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/20210919/%E8%AF%B7%E6%B1%82.jpeg" alt="è¯·æ±‚"></p><p>ç„¶åçœ‹äº†ä¸€ä¸‹å®ƒçš„ waterfallï¼Œå‘ç°å„é¡¹æŒ‡æ ‡éƒ½æ­£å¸¸ï¼Œæ€»å…±èŠ±è´¹ 60ms+ã€‚é‚£åº”è¯¥è·Ÿç½‘ç»œè¯·æ±‚æ²¡å…³ç³»ã€‚</p><p>ç„¶åæ‰“å¡ Performance å¼€å§‹å½•åˆ¶ã€‚å½•åˆ¶å®Œä¹‹åæˆ‘å†ä¸€æ¬¡éº»äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/20210919/performance.png" alt="performance"></p><p>é—®é¢˜å¾ˆå¤§å•Šã€‚å…ˆä¸ç®¡è¿™äº›ï¼Œå…ˆçœ‹ä¸€ä¸‹è¿™ä¸ªè¯·æ±‚ä¸ºä»€ä¹ˆå¡ä½ï¼Œé¦–å…ˆä»ç«ç‚¬å›¾ä¸Šå¯ä»¥çœ‹åˆ°çš„æ˜¯ä»–åœ¨è¿™ä¸€ä¸ªç‰‡æ®µé‡Œæ‰§è¡Œäº† N æ­¤<code>mergeWithServer</code>ï¼Œè¿™ä¸ªæ–¹æ³•åº”è¯¥æ˜¯ redux çš„ã€‚</p><p>ç„¶åç‚¹å¼€ä»–å¯¹åº”çš„æœ€ä¸Šå±‚æ‰“å¼€ callTree ä¸€å±‚ä¸€å±‚çœ‹ï¼Œå‘ç°<code>mergeWithServer</code>è¿™ä¸ªæ–¹æ³•ä¸‹<code>dispatch</code>ä¸€å…±å äº† 6s å¤šã€‚</p><p>é‚£é—®é¢˜ä¹Ÿå°±å‡ºç°åœ¨è¿™ã€‚çœ‹ä¸€ä¸‹æºç æ€ä¹ˆå†™çš„</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">ids.map(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// ä¸€ç³»åˆ—æ“ä½œ</span><br>  dispatch(doSomeThing(data));<br>&#125;);<br></code></pre></div></td></tr></table></figure><p>å¥½å®¶ä¼™ï¼Œéš¾æ€ªç½‘ç»œè¯·æ±‚ç›´æ¥ä¼šè¢«å¡æ­»ï¼ŒåŸæ¥ä¸»çº¿ç¨‹éƒ½è¢«å¡æ­»äº†ã€‚æœ‰ 150 ä¸ª idï¼Œåœ¨è¿™ dispatch äº† 150 æ¬¡ã€‚ã€‚ã€‚æµè§ˆå™¨ä¸»çº¿ç¨‹ç›´æ¥è¢«å¡æ­»äº†ã€‚</p><p>ä¼˜åŒ–æ–¹æ¡ˆéå¸¸ç®€å•ï¼š</p><p>åœ¨ map çš„æ—¶å€™æŠŠæ•°æ®ç›´æ¥åšå¥½ï¼Œç„¶ååª dispatch ä¸€æ¬¡å°±å¯ä»¥äº†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æ€§èƒ½ä¼˜åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redux</tag>
      
      <tag>æ€§èƒ½ä¼˜åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>emojiåœ¨Chromeæ˜¾ç¤ºé—®é¢˜</title>
    <link href="/article/a835eac3/"/>
    <url>/article/a835eac3/</url>
    
    <content type="html"><![CDATA[<p>å‰å‡ å¤©æ¥åˆ°ä¸€ä¸ªè«åå…¶å¦™çš„éœ€æ±‚ï¼Œè¯´æ–‡æœ¬ä¸­æœ‰ emojiï¼Œç„¶åæ–‡å­—å’Œ emoji ç²˜è¿äº†ï¼Œéœ€è¦åˆ†å¼€ã€‚</p><p>ä½†æ˜¯æˆ‘æ‰“å¼€çœ‹äº†ä¸€ä¸‹äº§å“è¯´çš„ä½ç½®ï¼Œå‘ç°å¹¶æ²¡æœ‰ç²˜è¿ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/20210919/%E4%BA%A7%E5%93%81%E6%88%AA%E5%9B%BE.png" alt="äº§å“çœ‹åˆ°çš„"></p><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/20210919/%E6%88%91%E7%9A%84%E6%88%AA%E5%9B%BE.png" alt="æˆ‘çœ‹åˆ°çš„"></p><p>å¼€å§‹ä¸€é¡¿ç”©é”…æ“ä½œï¼Œè‡´å‘½ä¸‰è¿é—®ï¼š</p><ol><li><p>ä½ æ˜¯ä»€ä¹ˆæµè§ˆå™¨ï¼Ÿ</p></li><li><p>æµè§ˆå™¨ä»€ä¹ˆç‰ˆæœ¬ï¼Ÿ</p></li><li><p>æ˜¯ä¸æ˜¯æµè§ˆå™¨è°ƒæ•´äº†å…¶ä»–å­—ä½“ã€‚</p></li></ol><p>å‘ç°è¿™äº›å±…ç„¶è·Ÿæˆ‘çš„éƒ½ä¸€æ ·ï¼Œå±…ç„¶ä¼šäº§ç”Ÿè¿™ç§å·®å¼‚ã€‚</p><p>åœ¨ç»è¿‡ä¸€ç³»åˆ—æœç´¢åæ‰¾åˆ°äº†ç­”æ¡ˆï¼š</p><p>åŸæ–‡è¿æ¥:<a href="https://segmentfault.com/q/1010000011020467?utm_source=sf-similar-question">emoji å’Œæ–‡å­—ä¼šé‡åˆ</a></p><p>åŸå› å¦‚ä¸‹ï¼š</p><p>Chrome æ¸²æŸ“ emoji çš„æ–¹å¼ä¸å…¶ä»–æµè§ˆå™¨ï¼ˆå¦‚ Safariï¼‰ç›¸æ¯”æœ‰äº›ä¸åŒã€‚åœ¨ Retina å±å¹•ä¸‹ï¼ŒChrome æ¸²æŸ“æ­£å¸¸ï¼Œè€Œåœ¨é Retina å±å¹•ä¸‹ä¼šå‡ºç° emoji ä¸æ–‡å­—é‡å çš„é—®é¢˜ã€‚</p><p>æˆ‘æƒŠå‘†äº†ã€‚ä¸å¤ªæ•¢ç›¸ä¿¡æ˜¯è¿™ä¸ªé—®é¢˜ï¼Œç„¶åæˆ‘å°±æŠŠç¬”è®°æœ¬æ¥åˆ°ä¸€å—é retina å±ä¸Šæ¥å›æ‹–åŠ¨ï¼Œè¿˜çœŸæ˜¯è¿™æ ·ï¼Œåœ¨ retina ä¸Šä¼šæ›´å°ä¸€ç‚¹ã€‚</p><p>è§£å†³æ–¹æ¡ˆä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯åœ¨ emoji ä¸‹æ’å…¥ä¸€ä¸ªç©ºæ ¼ã€‚</p><p>PSï¼š åŸæ–‡ç­”æ¡ˆè¿™ç§è§£å†³æ–¹æ¡ˆä¹Ÿå¯ä»¥ï¼Œåªä¸è¿‡æˆ‘ä»¬æœ‰çš„åœ°æ–¹å¹¶ä¸é€‚åˆç»™ emoji å•ç‹¬æ’ä¸€ä¸ª span æ¥è§£å†³ï¼Œæ‰€ä»¥é‡‡ç”¨äº† js çš„æ–¹æ³•ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// ä»ğŸ‘‡è¿™ä¸ªæºæ›´æ–°æ­£åˆ™è¡¨è¾¾å¼</span><br><span class="hljs-comment">// https://github.com/twitter/twemoji-parser/blob/master/src/lib/regex.js</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> addSpaceAfterEmoji = <span class="hljs-function">(<span class="hljs-params">str</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> reg =<br>    <span class="hljs-regexp">/(?:\ud83d\udc68\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d])|(?:\ud83d[\udc68\udc69]|\ud83e\uddd1)(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf7c\udf84\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc70\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|(?:\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc3b\u200d\u2744\ufe0f|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f|\ud83d\udc08\u200d\u2b1b)|[#*0-9]\ufe0f?\u20e3|(?:[Â©Â®\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0c\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\udd77\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5-\uded7\udeeb\udeec\udef4-\udefc\udfe0-\udfeb]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd1d\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd76\udd78\udd7a-\uddb4\uddb7\uddba\uddbc-\uddcb\uddd0\uddde-\uddff\ude70-\ude74\ude78-\ude7a\ude80-\ude86\ude90-\udea8\udeb0-\udeb6\udec0-\udec2\uded0-\uded6]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g</span>;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> str === <span class="hljs-string">&quot;string&quot;</span><br>    ? str.replace(reg, <span class="hljs-function">(<span class="hljs-params">word</span>) =&gt;</span> &#123;<br>        <span class="hljs-keyword">return</span> word + <span class="hljs-string">&quot; &quot;</span>;<br>      &#125;)<br>    : str;<br>&#125;;<br></code></pre></div></td></tr></table></figure><p>ç„¶åé¡ºåˆ©è§£å†³æ”¶å·¥ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>emoji</tag>
      
      <tag>Chrome</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ‰‹æ’•ä¸€ä¸ªeventBus</title>
    <link href="/article/27b53d37/"/>
    <url>/article/27b53d37/</url>
    
    <content type="html"><![CDATA[<p>é¦–å…ˆéœ€è¦çŸ¥é“ eventBus ä¸­çš„æ–¹æ³•éƒ½æœ‰å“ªäº›ã€‚æŒ‰ç…§æ–¹æ³•è¿›è¡ŒåŸºç¡€æ¡†æ¶çš„æ­å»º</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">eventBus</span> </span>&#123;<br>  <span class="hljs-comment">// åˆå§‹åŒ–</span><br>  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"></span>)</span> &#123;&#125;<br><br>  <span class="hljs-comment">// è§¦å‘äº‹ä»¶</span><br>  <span class="hljs-function"><span class="hljs-title">emit</span>(<span class="hljs-params">eventName, ...args</span>)</span> &#123;&#125;<br><br>  <span class="hljs-comment">// æ³¨å†Œäº‹ä»¶</span><br>  <span class="hljs-function"><span class="hljs-title">on</span>(<span class="hljs-params">eventName, cb</span>)</span> &#123;&#125;<br><br>  <span class="hljs-comment">// æ³¨å†Œäº‹ä»¶ä½†åªè§¦å‘ä¸€æ¬¡</span><br>  <span class="hljs-function"><span class="hljs-title">onOnce</span>(<span class="hljs-params">eventName, cb</span>)</span> &#123;&#125;<br><br>  <span class="hljs-comment">// å–æ¶ˆäº‹ä»¶</span><br>  <span class="hljs-function"><span class="hljs-title">off</span>(<span class="hljs-params">eventName</span>)</span> &#123;&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>new çš„æ—¶å€™å¯¹ event è¿›è¡Œåˆå§‹åŒ–ã€‚ç„¶ååˆ†åˆ«å¡«å…¥é€»è¾‘</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">eventBus</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-built_in">this</span>.events = &#123;&#125;;<br>  &#125;<br><br>  <span class="hljs-function"><span class="hljs-title">emit</span>(<span class="hljs-params">eventName, ...args</span>)</span> &#123;<br>    <span class="hljs-keyword">const</span> cb = <span class="hljs-built_in">this</span>.events[eventName];<br>    <span class="hljs-keyword">if</span> (!cb) &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&quot;æ²¡è¿™ä¸ªäº‹ä»¶å•Š&quot;</span>);<br>    &#125;<br><br>    cb.forEach(<span class="hljs-function">(<span class="hljs-params">cb</span>) =&gt;</span> cb.apply(<span class="hljs-built_in">this</span>, args));<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>  &#125;<br><br>  <span class="hljs-function"><span class="hljs-title">on</span>(<span class="hljs-params">eventName, cb</span>)</span> &#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">this</span>.events[eventName]) &#123;<br>      <span class="hljs-built_in">this</span>.events[eventName] = [];<br>    &#125;<br>    <span class="hljs-built_in">this</span>.events[eventName].push(cb);<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>  &#125;<br><br>  <span class="hljs-function"><span class="hljs-title">onOnce</span>(<span class="hljs-params">eventName, cb</span>)</span> &#123;<br>    <span class="hljs-keyword">const</span> func = <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> &#123;<br>      <span class="hljs-built_in">this</span>.off(eventName, func);<br>      cb.apply(<span class="hljs-built_in">this</span>, args);<br>    &#125;;<br>    <span class="hljs-built_in">this</span>.on(eventName, func);<br>  &#125;<br><br>  <span class="hljs-function"><span class="hljs-title">off</span>(<span class="hljs-params">eventName, cb</span>)</span> &#123;<br>    <span class="hljs-keyword">if</span> (!cb) &#123;<br>      <span class="hljs-built_in">this</span>.events[eventName] = <span class="hljs-literal">null</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-built_in">this</span>.events[event] = <span class="hljs-built_in">this</span>.events[event].filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item !== cb);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ‰‹æ’•æºç </category>
      
    </categories>
    
    
    <tags>
      
      <tag>eventBus</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è¿‘æœŸé¢è¯•å¤ç›˜</title>
    <link href="/article/c0cc8344/"/>
    <url>/article/c0cc8344/</url>
    
    <content type="html"><![CDATA[<h2 id="æ»´æ»´"><a href="#æ»´æ»´" class="headerlink" title="æ»´æ»´"></a>æ»´æ»´</h2><p>å°±è®°ä½è¿™å‡ ä¸ªã€‚</p><ol><li><p>react-router åŠ¨æ€è·¯ç”±</p></li><li><p>Webpack ä¸­çš„ loader å’Œ plugin åŒºåˆ«<br>Loader çš„ä½œç”¨æ˜¯è®© webpack æ‹¥æœ‰åŠ è½½å’Œè§£æé JavaScript æ–‡ä»¶çš„èƒ½åŠ›ã€‚Plugin æ˜¯æ‰©å±• Webpack çš„åŠŸèƒ½ï¼Œåœ¨ webpack è¿è¡Œçš„ç”Ÿå‘½å‘¨æœŸä¸­ã€‚</p></li><li><p>Chunk å’Œ bundle çš„åŒºåˆ«<br>chunk æ˜¯æ‰“åŒ…è¿‡ç¨‹ä¸­çš„æ–‡ä»¶ï¼Œbundle æ˜¯æ‰“åŒ…çš„ç»“æœã€‚</p></li><li><p>Webpack çš„æ„å»ºä¼˜åŒ–<br>å¯ä»¥çœ‹æˆ‘å¦å¤–ä¸€ç¯‡å†™çš„æ„å»ºä¼˜åŒ–</p></li><li><p>Hookï¼šuseEffect useRef useCallback useMemo<br>è§£é‡Šäº†ä¸€ä¸‹ç”¨æ³•ï¼ŒåŸç†ã€‚ä»€ä¹ˆæ—¶å€™ç”¨ã€‚</p></li><li><p>æè¿° Redux æ•°æ®æµ<br>å•é¡¹æ•°æ®æµï¼šdispatch(Action)-&gt;Reducer-&gt;Store.</p></li><li><p>React-sugar ç”¨è¿‡å—ï¼Ÿ<br>æ²¡ç”¨è¿‡ã€‚</p></li><li><p>React æ˜¯å¦‚ä½•æ•°æ®é©±åŠ¨è§†å›¾çš„<br>çœ‹<a href="https://react.iamkasong.com/">å¡é¢‚å¤§ä½¬çš„ React æºç è§£æ</a>ã€‚</p></li><li><p>Node çš„äº‹ä»¶å¾ªç¯ï¼ˆ10 ä¸ºåˆ†ç•Œçº¿ï¼‰<br>çœ‹æˆ‘æ‘˜æŠ„æ·˜å®å‰ç«¯å›¢é˜Ÿçš„é‚£ç¯‡æ–‡ç« ã€ŠJavaScript ä¹‹äº‹ä»¶å¾ªç¯ã€‹</p></li><li><p>å¼ºç¼“å­˜åå•†ç¼“å­˜</p><ul><li>å¼ºç¼“å­˜ï¼šcache- control å’Œ expiress</li><li>åå•†ç¼“å­˜ï¼šlast-modify å’Œ If-Modified-Sinceï¼šå’Œæ—¶é—´æœ‰å…³ï¼Œæ—¶é—´ä¸ä¸€è‡´ä¼šæœ‰é—®é¢˜ã€‚Etag å’Œ If-None-Matchï¼šæœåŠ¡ç«¯å…ˆå¯¹æ–‡ä»¶ç”Ÿæˆå”¯ä¸€æ ‡è¯† ETagï¼Œåœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚çš„æ—¶å€™å¸¦å›æ¥ï¼Œç¬¬äºŒæ¬¡è¯·æ±‚çš„æ—¶å€™è¯·æ±‚å¤´ä¼šæœ‰ If-None-Matchï¼šETag å€¼çš„å½¢å¼ï¼Œå¦‚æœ ETag ä¸åŒ¹é…å°±æ‹¿æ–°èµ„æºï¼ŒåŒ¹é…å°±è¿”å› 304ã€‚</li></ul></li><li><p>æ€ä¹ˆåˆ¤æ–­å•¥æ—¶å€™è¯¥å»è¯·æ±‚æœ€æ–°çš„èµ„æºï¼Œå•¥æ—¶å€™å»è¯·æ±‚ service Worker<br>è¿™ä¸ªæ²¡å›ç­”ï¼Œå› ä¸ºä¸äº†è§£ ServiceWorkerï¼Œç„¶åè·Ÿé¢è¯•å®˜è®²äº†ä¸€ä¸‹æˆ‘æ‰€çŸ¥é“çš„ serviceWorkerï¼ŒPWA ä»¥åŠç”¨ serviceWorker å®ç°çš„ mock æ–¹æ¡ˆè¿™äº›ã€‚<br>å…·ä½“å¯ä»¥çœ‹<a href="https://www.cnblogs.com/blueball/p/13268160.html">service Worker</a>ç¬¬åç‚¹çš„ç¼“å­˜ç®¡ç†ï¼Œå¤§æ¦‚å°±æ˜¯åœ¨ servicerWoker çš„ install é˜¶æ®µæ—¶ï¼Œopen å¾…ç‰ˆæœ¬å·çš„ cacheï¼Œç‰ˆæœ¬å·å˜äº†å°±ä¼šæ›´æ–°äº†ã€‚</p></li><li><p>å®ç°æ·±æ‹·è´<br>å½“æ—¶æ²¡å®ç°å‡ºæ¥ï¼Œå“ˆå“ˆå“ˆå“ˆå“ˆï¼Œåªæ˜¯é¢è¯•å®˜è¯´äº†ä¸€ä¸‹é€’å½’ï¼Œé‡åˆ° object å°±ä¸‹ä¸€å±‚è¿™æ ·çš„ä¸€ä¸ªæ€è·¯ã€‚å› ä¸ºä½†æ˜¯åªè®°å¾—å¤„ç† Object</p></li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javaScript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deepClone</span>(<span class="hljs-params">value, hashMap = <span class="hljs-keyword">new</span> <span class="hljs-built_in">WeakMap</span>()</span>) </span>&#123;<br>  <span class="hljs-keyword">if</span> (value == <span class="hljs-literal">undefined</span> || <span class="hljs-keyword">typeof</span> value !== <span class="hljs-string">&#x27;object&#x27;</span>) &#123;<br>    <span class="hljs-keyword">return</span> value;<br>  &#125;<br><br>  <span class="hljs-keyword">if</span> (value <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Date</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(value);<br>  &#125;<br><br>  <span class="hljs-keyword">if</span> (value <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">RegExp</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(value);<br>  &#125;<br><br>  <span class="hljs-keyword">const</span> hashKey = hashMap.get(value);<br>  <span class="hljs-keyword">if</span> (hashKey) &#123;<br>    <span class="hljs-keyword">return</span> hashKey;<br>  &#125;<br><br><br>  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">new</span> value.constructor();<br>  hashMap.set(value, result);<br>  <span class="hljs-built_in">Object</span>.keys(value).forEach(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> &#123;<br>    result[key] = deepClone(value[key], hashMap);<br>  &#125;)<br><br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></div></td></tr></table></figure><ol start="13"><li>æ•°ç»„å»é‡<br>å“ˆå“ˆå“ˆå“ˆå“ˆï¼Œè¿™ä¸ªæˆ‘ä¹Ÿæ²¡å®ç°ã€‚æˆ‘æ¯”è¾ƒçš®çš„è¯´äº†ä¸€å¥ <code>Array.from(new Set())</code>ï¼Œç„¶åé¢è¯•å®˜è¯´ä¸è¡Œã€‚<br>ç„¶åæˆ‘å°±æäº†ä¸ª Mapï¼Œéå†å…¨éƒ¨å…¨éƒ¨å…ƒç´ ï¼Œkey å°±æ˜¯ array[i]ã€‚ç„¶åé¢è¯•å®˜é—®æˆ‘è¿™ç§æ–¹å¼é‡åˆ°<code>undefined</code>æ€ä¹ˆåŠï¼Œæˆ‘è¯´<code>undefined</code>æ˜¯å¯ä»¥ä½œä¸º key çš„ï¼Œä¹‹å‰æ‰‹æ»‘ç»™è¿‡ä¸€æ¬¡ undefinedï¼Œç„¶åå¼•å‘äº† bug å“ˆå“ˆå“ˆå“ˆï¼Œç„¶ååˆé—®æˆ‘èƒ½ä¸èƒ½å­˜<code>[1,2,3,[4,5]]</code>çš„ç¬¬ä¸‰é¡¹ï¼Œæˆ‘å½“æ—¶ä¸å¤ªç¡®å®šèƒ½ä¸èƒ½å­˜ï¼Œå‘Šè¯‰é¢è¯•å®˜ä¸ç¡®å®šã€‚</li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javaScript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">arrayNonRepeatfy</span>(<span class="hljs-params">arr</span>) </span>&#123;<br>  <span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();<br>  <span class="hljs-keyword">let</span> array = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) &#123;<br>    <span class="hljs-keyword">if</span>(map.has(arr[i])) &#123;<br>      map.set(arr[i], i);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      map.set(arr[i], i);<br>      array.push(arr[i]);<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> array ;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä¸è¿‡è¿™ç§ä¸èƒ½åº”å¯¹<code>[1,2,3,[4,5],5,[4,5]]</code>å»é‡ã€‚å¯ä»¥åˆ¤æ–­ä¸€ä¸‹æ˜¯<code>Array.isArray(num)||(typeof num === &quot;object&quot; &amp;&amp; num !== null)</code>ï¼Œç„¶åç”¨ JSON.stringify ä¸€ä¸‹å†å­˜åˆ° Map é‡Œï¼Œåœ¨ has åˆ¤æ–­çš„æ—¶å€™ä¹Ÿå…ˆåºåˆ—åŒ–ä¸€ä¸‹ã€‚</p><ol start="14"><li>å®ç°ä¸€ä¸ª moment.format<br>è¿™ä¸ªå½“æ—¶ä¹Ÿæ²¡å®ç°ï¼Œä¹Ÿæ˜¯ä»…ä»…å®ç°äº†ä¸ªä¸ä¼  paramDate å’Œ formatStr çš„æœ€ç®€å•ç‰ˆæœ¬ï¼Œåªæ˜¯è·Ÿé¢è¯•å®˜è¯´äº†ä¸€ä¸‹è¦æƒ³å®ç°ä¼ å…¥ formatStr çš„è¿™ä¸ªï¼Œç”¨æ­£åˆ™ä¼šæ–¹ä¾¿ç‚¹ã€‚</li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> format = <span class="hljs-function">(<span class="hljs-params">paramDate, formatStr</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(paramDate) || <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();<br>  <span class="hljs-keyword">const</span> year = date.getFullYear();<br>  <span class="hljs-keyword">const</span> month = date.getMonth() + <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">const</span> day = date.getDate();<br>  <span class="hljs-keyword">const</span> week = date.getDay();<br>  <span class="hljs-keyword">const</span> hour = date.getHours();<br>  <span class="hljs-keyword">const</span> minute = date.getMinutes();<br>  <span class="hljs-keyword">const</span> second = date.getSeconds();<br><br>  <span class="hljs-keyword">return</span> formatStr<br>    ? formatStr.replace(<br>        <span class="hljs-regexp">/Y&#123;2,4&#125;|M&#123;1,2&#125;|D&#123;1,2&#125;|d&#123;1,4&#125;|H&#123;1,2&#125;|m&#123;1,2&#125;|s&#123;1,2&#125;/g</span>,<br>        <span class="hljs-function">(<span class="hljs-params">match</span>) =&gt;</span> &#123;<br>          <span class="hljs-keyword">switch</span> (match) &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;YY&quot;</span>:<br>              <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(year).slice(-<span class="hljs-number">2</span>);<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;YYY&quot;</span>:<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;YYYY&quot;</span>:<br>              <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(year);<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;M&quot;</span>:<br>              <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(month);<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;MM&quot;</span>:<br>              <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(month).padStart(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;0&quot;</span>);<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;D&quot;</span>:<br>              <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(day);<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;DD&quot;</span>:<br>              <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(day).padStart(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;0&quot;</span>);<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;d&quot;</span>:<br>              <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(week);<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;dd&quot;</span>:<br>              <span class="hljs-keyword">return</span> weeks[week];<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;ddd&quot;</span>:<br>              <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;å‘¨&quot;</span> + weeks[week];<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;dddd&quot;</span>:<br>              <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;æ˜ŸæœŸ&quot;</span> + weeks[week];<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;H&quot;</span>:<br>              <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(hour);<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;HH&quot;</span>:<br>              <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(hour).padStart(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;0&quot;</span>);<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;m&quot;</span>:<br>              <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(minute);<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;mm&quot;</span>:<br>              <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(minute).padStart(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;0&quot;</span>);<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;s&quot;</span>:<br>              <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(second);<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;ss&quot;</span>:<br>              <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(second).padStart(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;0&quot;</span>);<br>            <span class="hljs-keyword">default</span>:<br>              <span class="hljs-keyword">return</span> match;<br>          &#125;<br>        &#125;<br>      )<br>    : <span class="hljs-string">`<span class="hljs-subst">$&#123;year&#125;</span>-<span class="hljs-subst">$&#123;month&#125;</span>-<span class="hljs-subst">$&#123;day&#125;</span> <span class="hljs-subst">$&#123;hour&#125;</span>:<span class="hljs-subst">$&#123;minute&#125;</span>:<span class="hljs-subst">$&#123;second&#125;</span>`</span>;<br>&#125;;<br></code></pre></div></td></tr></table></figure><ol start="15"><li><p>å®ç°ä¸€ä¸ªç¬¦åˆ promise/A+çš„ promiseã€‚</p><p>çœ‹æˆ‘å‰æ®µæ—¶é—´å†™çš„æ‰‹æ’• promise</p></li><li><p>çœ‹ä»£ç é¢˜</p></li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// 1.å¼‚æ­¥è¾“å‡º</span><br><span class="hljs-comment">//è¯·å†™å‡ºè¾“å‡ºå†…å®¹</span><br><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">async1</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;async1 start&quot;</span>);<br>  <span class="hljs-keyword">await</span> async2(); <span class="hljs-comment">//ç­‰è¿™ä¸ªæ‰§è¡Œå®Œã€‚</span><br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;async1 end&quot;</span>);<br>&#125;<br><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">async2</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) </span>&#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;promise1&quot;</span>);<br>    resolve();<br>  &#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;promise2&quot;</span>);<br>  &#125;);<br>&#125;<br><br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;script start&quot;</span>);<br><br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;setTimeout&quot;</span>); <span class="hljs-comment">//1.è¿›hong</span><br>&#125;, <span class="hljs-number">0</span>);<br><br>async1();<br><br><span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;promise3&quot;</span>);<br>  resolve(); <span class="hljs-comment">//3].è¿›å¾®ä»»åŠ¡</span><br>&#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;promise4&quot;</span>);<br>&#125;);<br><br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;script end&quot;</span>);<br></code></pre></div></td></tr></table></figure><ol start="17"><li>å®ç°ä¸€ä¸ª sleep å‡½æ•°ï¼Œå¤šç§æ–¹å¼ï¼Œæ¯”å¦‚ sleep(1000)</li></ol><p>é˜»å¡ js æ‰§è¡Œå°±å¯ä»¥</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> sleep = <span class="hljs-function">(<span class="hljs-params">num, fn</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">let</span> start = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime();<br>  <span class="hljs-keyword">while</span> (<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime() - start &lt; num);<br>  fn();<br>&#125;;<br><br><span class="hljs-keyword">const</span> sleep = <span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123;<br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>      resolve();<br>    &#125;, num);<br>  &#125;);<br>&#125;;<br></code></pre></div></td></tr></table></figure><ol start="18"><li>åˆå¹¶ä¸¤ä¸ªæœ‰åºæ•´æ•°æ•°ç»„ï¼Œä½¿ä¹‹æˆä¸ºä¸€ä¸ªæœ‰åºæ•°ç»„ï¼Œfunction(arr, brr) ï¼Œå‡è®¾ arr é•¿åº¦åˆšå¥½å®¹çº³æ‰€æœ‰æ•°æ®</li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> merge = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">nums1, nums2</span>) </span>&#123;<br>  <span class="hljs-keyword">let</span> nums1First = nums1.length - nums2.length - <span class="hljs-number">1</span>,<br>    nums1Second = nums1.length - <span class="hljs-number">1</span>,<br>    nums2First = nums2.length - <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">while</span> (nums1First &gt;= <span class="hljs-number">0</span> &amp;&amp; nums2First &gt;= <span class="hljs-number">0</span>) &#123;<br>    nums1[nums1Second--] =<br>      nums1[nums1First] &gt; nums2[nums2First]<br>        ? nums1[nums1First--]<br>        : nums2[nums2First--];<br>  &#125;<br>  nums1.splice(<span class="hljs-number">0</span>, nums2First + <span class="hljs-number">1</span>, ...nums2.slice(<span class="hljs-number">0</span>, nums2First + <span class="hljs-number">1</span>));<br>  <span class="hljs-keyword">return</span> nums1;<br>&#125;;<br></code></pre></div></td></tr></table></figure><h2 id="ç¾å›¢æ‰“è½¦"><a href="#ç¾å›¢æ‰“è½¦" class="headerlink" title="ç¾å›¢æ‰“è½¦"></a>ç¾å›¢æ‰“è½¦</h2><ol><li>å®ç° checkbox ç»„ä»¶ï¼Œæä¾›ç»™å…¶ä»–äººä½¿ç”¨</li><li>çœ‹ä»£ç é¢˜</li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> name = <span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>;<br><span class="hljs-keyword">const</span> people = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;æå››&quot;</span>,<br>  <span class="hljs-function"><span class="hljs-title">sayName</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.name);<br>  &#125;,<br>&#125;;<br><span class="hljs-comment">// Q1</span><br>people.sayName();<br><span class="hljs-keyword">const</span> temp = people.sayName;<br><span class="hljs-comment">// Q2</span><br>temp();<br><span class="hljs-comment">// Q3 èƒ½å¦åˆ©ç”¨call/applyä½¿è¾“å‡ºç»“æœä¸ºå¼ ä¸‰</span><br></code></pre></div></td></tr></table></figure><ol start="3"><li>ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œç§»é™¤æ‰€æœ‰ç›¸é‚»ç›¸åŒæ•°å­—ï¼Œç›´åˆ°æ²¡æœ‰ç›¸é‚»ç›¸åŒæ•°å­—ä¸ºæ­¢ã€‚</li></ol><p>Input:Â  [1, 2, 3, 3, 4, 4, 2, 5, 7, 7, 5, 6, 8, 1]<br>Output:Â  [1, 6, 8, 1]</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> filter = <span class="hljs-function">(<span class="hljs-params">arr</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> res = [];<br>  arr.forEach(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (res[res.length - <span class="hljs-number">1</span>] === item) &#123;<br>      res.pop();<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      res.push(item);<br>    &#125;<br>  &#125;);<br>  <span class="hljs-keyword">return</span> res;<br>&#125;;<br></code></pre></div></td></tr></table></figure><ol start="4"><li>hash contentHash chunkHash åŒºåˆ«</li></ol><p>hashï¼šå·¥ç¨‹çº§åˆ«ï¼Œä¿®æ”¹ä»»ä½•ä¸€ä¸ªæ–‡ä»¶éƒ½ä¼šå¯¼è‡´æ‰€æœ‰æ–‡ä»¶ hash æ”¹å˜</p><p>chunkHashï¼šæ¨¡å—çº§åˆ«çš„ï¼Œæ ¹æ®ä¸åŒçš„å…¥å£æ–‡ä»¶(Entry)è¿›è¡Œä¾èµ–æ–‡ä»¶è§£æã€æ„å»ºå¯¹åº”çš„ chunkï¼Œç”Ÿæˆå¯¹åº”çš„å“ˆå¸Œå€¼ã€‚</p><p>contentHashï¼šæ–‡ä»¶å†…å®¹çº§åˆ«çš„ï¼Œå†…å®¹ä¸åŒäº§ç”Ÿçš„ hash å°±ä¸åŒã€‚</p>]]></content>
    
    
    <categories>
      
      <category>é¢ç»</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‰ç«¯å¼€å‘</tag>
      
      <tag>é¢ç»</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Šè‡ªé¡¶å‘ä¸‹å­¦ React æºç ã€‹å­¦ä¹ ç¬”è®°</title>
    <link href="/article/3f8812bd/"/>
    <url>/article/3f8812bd/</url>
    
    <content type="html"><![CDATA[<h2 id="è®¾è®¡ç†å¿µ"><a href="#è®¾è®¡ç†å¿µ" class="headerlink" title="è®¾è®¡ç†å¿µ"></a>è®¾è®¡ç†å¿µ</h2><p><a href="https://zh-hans.reactjs.org/docs/thinking-in-react.html">React å“²å­¦</a>:React æ˜¯ç”¨ JavaScript æ„å»ºå¿«é€Ÿå“åº”çš„å¤§å‹ Web åº”ç”¨ç¨‹åºçš„é¦–é€‰æ–¹å¼</p><p>ç›®å‰ web ç«¯å¿«é€Ÿå“åº”çš„ä¸¤å¤§ç“¶é¢ˆï¼šè®¡ç®—èƒ½åŠ›å’Œç½‘ç»œå»¶è¿Ÿã€‚å¯¹åº”çš„ä¹Ÿå°±åˆ†åˆ«æ˜¯ CPU å’Œ IOã€‚</p><p>1000ms/60Hz = 16.6ms æµè§ˆå™¨åˆ·æ–°ä¸€æ¬¡ã€‚</p><p>åœ¨è¿™ 16.6ms ä¹‹é—´ï¼Œä¼šä¾æ¬¡ JS è„šæœ¬æ‰§è¡Œ-&gt;æ ·å¼å¸ƒå±€-&gt;æ ·å¼ç»˜åˆ¶</p><p>å¦‚æœ JS çš„è„šæœ¬æ‰§è¡Œæ—¶é—´è¶…è¿‡ 16.6msï¼Œå°±ä¼šæ‰å¸§ã€‚</p><p>ä»¥å‰çš„æ–¹æ¡ˆä¸»è¦æœ‰ï¼šé˜²æŠ–å’ŒèŠ‚æµã€‚ä½†æ˜¯æ²»æ ‡ä¸æ²»æœ¬ã€‚</p><p>é˜²æŠ–ï¼šæŒ‡å®šæ—¶é—´å†…ä¸ç»§ç»­æ“ä½œåæ‰§è¡Œã€‚</p><p>èŠ‚æµï¼šæŒ‡å®šæ—¶é—´å†…åªæ‰§è¡Œä¸€æ¬¡ã€‚</p><p>React çš„åšæ³•æ˜¯å®ç°ä¸€ç§å¼‚æ­¥å¯ä¸­æ–­çš„æ›´æ–°æœºåˆ¶ã€‚</p><p>æµè§ˆå™¨é¢„ç•™æ—¶é—´ç»™ Reactï¼ŒReact ç”¨è¿™éƒ¨åˆ†æ—¶é—´æ¥å¹²è‡ªå·±çš„äº‹ï¼Œå¦‚æœè¿™æ®µæ—¶é—´å†…æ²¡å¹²å®Œï¼Œé‚£ä¹ˆ React å°±å°†æ§åˆ¶æƒäº¤å›ç»™æµè§ˆå™¨ï¼Œç­‰ä¸‹ä¸€æ¬¡çš„é¢„ç•™æ—¶é—´ã€‚æ‰€ä»¥æµè§ˆå™¨å°±æœ‰å……è¶³çš„æ—¶é—´è¿›è¡Œæ ·å¼å¸ƒå±€+æ ·å¼ç»˜åˆ¶ã€‚</p><h2 id="æ¶æ„çš„æ¼”åŒ–"><a href="#æ¶æ„çš„æ¼”åŒ–" class="headerlink" title="æ¶æ„çš„æ¼”åŒ–"></a>æ¶æ„çš„æ¼”åŒ–</h2><h3 id="è€-React-çš„æ¶æ„ï¼ˆ15-åŠä»¥å‰ï¼‰"><a href="#è€-React-çš„æ¶æ„ï¼ˆ15-åŠä»¥å‰ï¼‰" class="headerlink" title="è€ React çš„æ¶æ„ï¼ˆ15 åŠä»¥å‰ï¼‰"></a>è€ React çš„æ¶æ„ï¼ˆ15 åŠä»¥å‰ï¼‰</h3><p>è€ React ä¸­å¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šå†³å®šæ¸²æŸ“ç»„ä»¶ï¼ˆåè°ƒå™¨ï¼‰-ã€‹å°†ç»„ä»¶æ¸²æŸ“åˆ°è§†å›¾ä¸­ï¼ˆæ¸²æŸ“å™¨ï¼‰ã€‚</p><p>åè°ƒå™¨ï¼ˆReconcilerï¼‰ä¸­ä¼šè¿›è¡Œ Diff ç®—æ³•ï¼Œç®—å‡ºå“ªäº›éœ€è¦æ›´æ–°ï¼Œç„¶åå°†è¦æ›´æ–°çš„å†…å®¹äº¤ç»™æ¸²æŸ“å™¨ï¼ˆRenderï¼‰ä¸­ã€‚</p><p>é—®é¢˜ï¼š</p><p>åè°ƒå™¨ä¸æ¸²æŸ“å™¨æ˜¯ä¾æ¬¡æ‰§è¡Œå·¥ä½œã€‚å¦‚æœåŒæ—¶æ›´æ–°å¤šä¸ªèŠ‚ç‚¹ï¼Œç¬¬ä¸€ä¸ª DOM ä¼šå…ˆå‘ç”Ÿå˜åŒ–ï¼Œä½†æ˜¯å› ä¸ºæ›´æ–°è¿‡ç¨‹æ˜¯åŒæ­¥çš„ï¼Œæ‰€ä»¥ä¼šåŒæ—¶æ¸²æŸ“å‡ºæ¥ã€‚å¦‚æœåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­å‘ç”Ÿä¸­æ–­ï¼Œåè°ƒå™¨å’Œæ¸²æŸ“å·¥ä½œè¿˜åœ¨ç»§ç»­ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªç»„ä»¶ä¼šå…ˆæ¸²æŸ“å®Œã€‚å°±ä¼šäº§ç”Ÿ bugã€‚</p><h3 id="æ–°-React-çš„æ¶æ„ï¼ˆ16-åŠä»¥åï¼‰"><a href="#æ–°-React-çš„æ¶æ„ï¼ˆ16-åŠä»¥åï¼‰" class="headerlink" title="æ–° React çš„æ¶æ„ï¼ˆ16 åŠä»¥åï¼‰"></a>æ–° React çš„æ¶æ„ï¼ˆ16 åŠä»¥åï¼‰</h3><p>æ–° React ä¸­åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šè°ƒåº¦æ›´æ–°ï¼ˆè°ƒåº¦å™¨ï¼‰-&gt;å†³å®šæ›´æ–°ä»€ä¹ˆï¼ˆåè°ƒå™¨ï¼‰-&gt;å°†ç»„ä»¶æ›´æ–°åˆ°è§†å›¾ä¸­ï¼ˆæ¸²æŸ“å™¨ï¼‰ã€‚</p><p>è°ƒåº¦å™¨ä¼šå¯¹æ›´æ–°é¡¹åˆ†é…ä¼˜å…ˆçº§ï¼Œå°†é«˜ä¼˜å…ˆçº§çš„å…ˆäº¤ç»™åè°ƒå™¨ï¼Œç„¶ååè°ƒå™¨è¿›è¡Œ Diff ç®—æ³•ï¼Œå†å°†æ›´æ–°çš„å†…å®¹äº¤ç»™æ¸²æŸ“å™¨ã€‚å¦‚æœåœ¨è¿›è¡Œ Diff çš„è¿‡ç¨‹ä¸­æ¥äº†æ–°çš„æ›´é«˜ä¼˜å…ˆçº§çš„æ›´æ–°é¡¹ï¼Œåˆ™å°†æ­£åœ¨ Diff çš„æ›´æ–°é¡¹ä¸­æ–­ï¼Œå…ˆè¿›è¡Œé«˜ä¼˜å…ˆçº§çš„ Diffã€‚å¾ªç¯ä»¥ä¸Šæ“ä½œã€‚å› ä¸ºè¿™äº›æ“ä½œéƒ½åœ¨å†…å­˜ä¸­æ“ä½œï¼Œç”¨æˆ·å¹¶ä¸ä¼šæ„ŸçŸ¥ã€‚ï¼ˆè·Ÿç¦»çº¿æ“ä½œ DOM ä¸€ä¸ªæ„æ€ï¼‰</p><h2 id="React-çš„æ–°æ¶æ„-â€”-Fiber"><a href="#React-çš„æ–°æ¶æ„-â€”-Fiber" class="headerlink" title="React çš„æ–°æ¶æ„ â€”- Fiber"></a>React çš„æ–°æ¶æ„ â€”- Fiber</h2><p>Fiber æ˜¯åç¨‹çš„ä¸€ç§å®ç°æ–¹å¼ï¼Œå¦ä¸€ç§åç¨‹çš„å®ç°æ–¹å¼ä¸º Generatorã€‚ä¸é‡‡ç”¨ Generator çš„åŸå› ï¼šGenerator å’Œ async ä¸€æ ·éƒ½å…·æœ‰ä¼ æŸ“æ€§ã€‚æ›´æ–°å¯ä»¥ä¸­æ–­å¹¶ç»§ç»­ï¼Œæ›´æ–°å…·æœ‰ä¼˜å…ˆçº§ï¼Œé«˜ä¼˜å…ˆçº§å¯ä»¥æ‰“æ–­ä½ä¼˜å…ˆçº§ã€‚</p><h3 id="Fiber-çš„å«ä¹‰"><a href="#Fiber-çš„å«ä¹‰" class="headerlink" title="Fiber çš„å«ä¹‰"></a>Fiber çš„å«ä¹‰</h3><h4 id="ä»æ¶æ„çš„è§’åº¦æ¥è¯´"><a href="#ä»æ¶æ„çš„è§’åº¦æ¥è¯´" class="headerlink" title="ä»æ¶æ„çš„è§’åº¦æ¥è¯´"></a>ä»æ¶æ„çš„è§’åº¦æ¥è¯´</h4><ul><li><p>è€ React çš„æ¶æ„ï¼šReconciler é‡‡ç”¨é€’å½’çš„æ–¹å¼æ‰§è¡Œï¼Œæ•°æ®ä¿å­˜åœ¨é€’å½’çš„è°ƒç”¨æ ˆä¸­ï¼Œæ‰€ä»¥è¢«ç§°ä¸º Stack Reconcilerã€‚</p></li><li><p>æ–° React çš„æ¶æ„ï¼šReconciler åŸºäº Fiber çš„èŠ‚ç‚¹å®ç°ï¼Œæ‰€ä»¥æˆä¸º Fiber Reconciler</p></li></ul><h4 id="ä»é™æ€æ•°æ®ç»“æ„æ¥è¯´"><a href="#ä»é™æ€æ•°æ®ç»“æ„æ¥è¯´" class="headerlink" title="ä»é™æ€æ•°æ®ç»“æ„æ¥è¯´"></a>ä»é™æ€æ•°æ®ç»“æ„æ¥è¯´</h4><p>æ¯ä¸ª Fiber èŠ‚ç‚¹å¯¹åº”ä¸€ä¸ª React elementï¼Œä¿å­˜äº†è¯¥ç»„ä»¶çš„ç±»å‹ï¼ˆå‡½æ•°ç»„ä»¶/ç±»ç»„ä»¶/åŸç”Ÿç»„ä»¶â€¦ï¼‰ã€å¯¹åº”çš„ DOM èŠ‚ç‚¹ç­‰ä¿¡æ¯ã€‚</p><p>ä¸€ä¸ª React åº”ç”¨ä¸­åªèƒ½æœ‰ä¸€ä¸ª FiberRootNodeï¼Œä¸€ä¸ª FiberRootNode æœ€å¤šæœ‰ä¸¤ä¸ª RootFiberã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/20210807/%E4%BD%9C%E4%B8%BA%E9%9D%99%E6%80%81%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.png" alt="é™æ€æ•°æ®ç»“æ„"></p><p>ä¸ºä»€ä¹ˆçˆ¶èŠ‚ç‚¹è¿æ¥å­èŠ‚ç‚¹ç”¨ childï¼Œå­èŠ‚ç‚¹ä½¿ç”¨ Return è¿æ¥çˆ¶èŠ‚ç‚¹ï¼Ÿå› ä¸º React 15 ä¸­ Stack Reconciler é‡‡ç”¨é€’å½’çš„æ–¹å¼ï¼Œå…ˆä»æ ¹é€’åˆ°å­èŠ‚ç‚¹ï¼Œåœ¨ä»å­èŠ‚ç‚¹å½’åˆ°æ ¹ï¼Œæ‰€ä»¥å½’é˜¶æ®µå‡½æ•°å¤„ç†å®Œä¼šç”¨ Returnã€‚åœ¨ Fiber Reconciler é‡‡ç”¨éå†çš„æ–¹å¼ï¼Œå®ç°å¯ä¸­æ–­çš„é€’å½’ï¼Œæ‰€ä»¥å¤ç”¨äº†è¿™ç§æ–¹å¼ã€‚</p><h4 id="ä½œä¸ºåŠ¨æ€å·¥ä½œå•å…ƒ"><a href="#ä½œä¸ºåŠ¨æ€å·¥ä½œå•å…ƒ" class="headerlink" title="ä½œä¸ºåŠ¨æ€å·¥ä½œå•å…ƒ"></a>ä½œä¸ºåŠ¨æ€å·¥ä½œå•å…ƒ</h4><p>æ¯ä¸ª Fiber èŠ‚ç‚¹ä¿å­˜äº†æœ¬æ¬¡æ›´æ–°ä¸­è¯¥ç»„ä»¶æ”¹å˜çš„çŠ¶æ€ã€è¦æ‰§è¡Œçš„å·¥ä½œï¼ˆéœ€è¦è¢«åˆ é™¤/è¢«æ’å…¥é¡µé¢ä¸­/è¢«æ›´æ–°â€¦ï¼‰ã€‚</p><h3 id="Fiber-çš„å·¥ä½œåŸç†"><a href="#Fiber-çš„å·¥ä½œåŸç†" class="headerlink" title="Fiber çš„å·¥ä½œåŸç†"></a>Fiber çš„å·¥ä½œåŸç†</h3><h4 id="åŒç¼“å­˜"><a href="#åŒç¼“å­˜" class="headerlink" title="åŒç¼“å­˜"></a>åŒç¼“å­˜</h4><p>æ­£å¸¸åŠ¨ç”»æ’­æ”¾ï¼šå…ˆåˆ é™¤å‰ä¸€å¸§ï¼Œç„¶åè®¡ç®—å½“å‰å¸§ï¼Œæ˜¾ç¤ºå½“å‰å¸§ã€‚å¦‚æœå½“å‰å¸§è®¡ç®—é‡ç‰¹åˆ«å¤§å°±ä¼šæœ‰ç‰¹åˆ«é•¿çš„ç™½å±æ—¶é—´ã€‚</p><p>åœ¨å†…å­˜ä¸­ç»˜åˆ¶å½“å‰å¸§ï¼Œç»˜åˆ¶å®Œåæ›¿æ¢å‰ä¸€å¸§ã€‚ï¼ˆè¿™ä¸è¿˜æ˜¯ç¦»çº¿æ“ä½œ DOM çš„æ“ä½œï¼‰</p><h4 id="Fiber-æ ‘åŒç¼“å­˜"><a href="#Fiber-æ ‘åŒç¼“å­˜" class="headerlink" title="Fiber æ ‘åŒç¼“å­˜"></a>Fiber æ ‘åŒç¼“å­˜</h4><p>é¦–æ¬¡è¿è¡Œæ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ª FiberRootNode å’Œ RootFiberï¼Œå› ä¸ºæ˜¯é¦–å±æ¸²æŸ“ï¼Œæ‰€ä»¥ RootFiber ä¸‹å¹¶æ²¡æœ‰ä»»ä½•å†…å®¹ã€‚</p><p>ç„¶åè¿›å…¥ Render é˜¶æ®µï¼Œé¦–å…ˆåˆ›å»º Fiber æ ‘çš„æ ¹èŠ‚ç‚¹ RootFiberï¼Œä½¿ç”¨ alternate è¿æ¥ä¹‹å‰çš„ RootFiberï¼Œæ–¹ä¾¿å±æ€§å…¬ç”¨ã€‚ç„¶åæ ¹æ®ç»„ä»¶è¿”å›çš„ JSX åœ¨å†…å­˜ä¸­åˆ›å»ºä¸€é¢— Fiber æ ‘ï¼ˆå…¶å®å°±æ˜¯è™šæ‹Ÿ DOMï¼Œå­˜æœ‰å„ä¸ªèŠ‚ç‚¹çš„çˆ¶å­å…³ç³»ï¼‰ï¼Œã€‚è¿™ä¸ª Fiber æ ‘å« WorkInProgress Fiber æ ‘ã€‚ä¹‹å‰çš„é‚£ä¸ªæ ‘å« Current Fiber æ ‘ã€‚</p><p>WorkInProgress Fiber æ ‘åœ¨å†…å­˜ä¸­æ„å»ºå®Œåï¼ŒFiberRootNode ä¼šå°† Current çš„æŒ‡å‘ä» Current Fiber æ ‘ç§»åˆ° WorkInProgress Fiber æ ‘ã€‚</p><p>åœ¨æ›´æ–°æ—¶ï¼Œè·Ÿä¹‹å‰ä¸€æ ·ï¼Œåªä¸è¿‡åœ¨æ„å»º Fiber æ ‘çš„æ—¶å€™ä¼šè¿›è¡Œ Current Fiber è¦è·Ÿè¿”å›çš„ JSX ç»“æ„è¿›è¡Œæ¯”å¯¹å³ Diff ç®—æ³•ï¼Œç„¶åç”Ÿäº§ WorkInProgress Fiber æ ‘ã€‚</p><h2 id="Render-é˜¶æ®µ"><a href="#Render-é˜¶æ®µ" class="headerlink" title="Render é˜¶æ®µ"></a>Render é˜¶æ®µ</h2><p>Render é˜¶æ®µæŒ‡ è°ƒå’Œå™¨å·¥ä½œçš„é˜¶æ®µï¼Œä¸»è¦æ˜¯æ‰“æ ‡è®°ï¼ˆeffectTagï¼‰æ˜¯ Update è¿˜æ˜¯ Replace ç­‰æ“ä½œï¼Œå¹¶éæŒ‡ Render è¿è¡Œçš„é˜¶æ®µã€‚Render æ–¹æ³•è¿è¡Œçš„é˜¶æ®µæˆä¸º Commit é˜¶æ®µã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/20210808/%E4%B8%89%E4%B8%AA%E9%98%B6%E6%AE%B5.png" alt="ä¸‰ä¸ªé˜¶æ®µ"></p><p>ç”¨<code>CRA</code>åˆ›å»ºä¸€ä¸ªæœ€åŸºç¡€çš„ React åº”ç”¨ï¼Œç”¨ devTool å½•åˆ¶ä¸€ä¸ªä» 0 åˆ° 1 çš„ç«ç‚¬å›¾ã€‚</p><p>åœ¨ Render é˜¶æ®µç»å†äº†å¦‚ä¸‹ï¼šï¼ˆå¯ä»¥åœ¨ beginWork å’Œ completeWork æ‰“ä¸ªæ–­ç‚¹çœ‹ä¸€ä¸‹ï¼Œçœ‹ç¬”è®°æƒ³ä¸èµ·æ¥è®°å¾—å†æ‰‹åŠ¨è°ƒè¯•ä¸€æ¬¡,è®°å¾—å¯¹ç€ CRA åˆ›å»ºçš„ DEMO ä»£ç çœ‹ï¼‰</p><p>åºŸè¯è¿ç¯‡:é¦–å…ˆè¿›å…¥ BeginWork çš„ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä¸º <code>current, workInProgress, renderLanes</code>ã€‚å› ä¸ºæ˜¯é¦–æ¬¡è¿è¡Œï¼Œæ‰€ä»¥ current çš„ Tag ä¸º<code>3</code>ï¼Œä»£è¡¨<code>HostRoot</code>ï¼Œç„¶åæ¢å¤è„šæœ¬æ‰§è¡Œã€‚åˆåˆ°äº† BeginWork çš„æ–­ç‚¹å¤„ï¼Œè¿™æ—¶<code>current</code>ä¸ºç©º,<code>workInProgress</code>çš„ ElementType ä¸º<code>f APP()</code>ã€‚å†æ”¾å¼€<code>workInProgress</code>åˆå˜æˆ<code>div</code>ã€‚å†æ”¾å¼€æ˜¯<code>header</code>,ç„¶åå†æ”¾å¼€æ˜¯<code>img</code>ï¼Œè¿™æ—¶å€™å› ä¸º img æ²¡æœ‰ä»»ä½•å­èŠ‚ç‚¹ï¼Œæ‰€ä»¥å†æ”¾å¼€ååˆ°äº† completeWorkï¼Œæ‰§è¡Œå®Œåï¼Œä¼šå†å¯»æ‰¾ img çš„å…„å¼ŸèŠ‚ç‚¹ï¼Œç„¶åæ‰¾åˆ°äº† P æ ‡ç­¾ï¼Œè¿›å…¥<code>beginWork</code>ï¼Œå†æ‰¾ P çš„å­èŠ‚ç‚¹ï¼Œå…ˆ<code>Edit </code>begin å† completedï¼Œæ¥ç€æ˜¯<code>Code</code>ï¼Œå› ä¸º Code å†…çš„å­èŠ‚ç‚¹æ˜¯çº¯æ–‡æœ¬ï¼Œæ‰€ä»¥ç›´æ¥é‡‡ç”¨ä¼˜åŒ–æ–¹æ¡ˆï¼Œä¸ä¼šæ‰¾å­èŠ‚ç‚¹ï¼Œç›´æ¥è¿›å…¥<code>completeWork</code>,ç„¶åå†æ˜¯æœ€åçš„æ–‡æœ¬<code>and save to reload.</code>ï¼Œæ‰§è¡Œå®Œåè¿›å…¥çˆ¶èŠ‚ç‚¹çš„<code>completeWork</code>ã€‚</p><p>æ€»ç»“ï¼šæ ¹ beginWork-&gt;å­èŠ‚ç‚¹ beginWork-å¦‚æœæœ‰å­èŠ‚ç‚¹-&gt;ä¸€ç›´ç›´è¡Œåˆ°æœ€åä¸€ä¸ªå­èŠ‚ç‚¹æ—¶ï¼Œæ‰§è¡Œçˆ¶èŠ‚ç‚¹çš„ completeWork; -å¦‚æœå­èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹-&gt;æ‰§è¡Œè‡ªå·±çš„ completeWork-&gt;ç„¶åæ‰¾åˆ°å…„å¼Ÿå…ƒç´ ã€‚</p><p>ä¸“ä¸šæ€»ç»“:é¦–å…ˆä»<code>rootFiber</code>å¼€å§‹å‘ä¸‹æ·±åº¦ä¼˜å…ˆéå†,ä¸ºéå†åˆ°çš„æ¯ä¸ª Fiber èŠ‚ç‚¹è°ƒç”¨<code>beginWork</code>æ–¹æ³•ã€‚å½“éå†åˆ°æ²¡æœ‰å­ç»„ä»¶çš„ç»„ä»¶æ—¶å°±ä¼šè¿›å…¥â€œå½’â€é˜¶æ®µã€‚åœ¨å½’é˜¶æ®µè°ƒç”¨<code>completeWork</code>,å½“æŸä¸ª Fiber èŠ‚ç‚¹æ‰§è¡Œå®Œ<code>completeWork</code>ï¼Œå¦‚æœå…¶å­˜åœ¨å…„å¼Ÿ Fiber èŠ‚ç‚¹ï¼ˆå³ fiber.sibling !== nullï¼‰ï¼Œä¼šè¿›å…¥å…¶å…„å¼Ÿ Fiber çš„â€œé€’â€é˜¶æ®µã€‚å¦‚æœä¸å­˜åœ¨å…„å¼Ÿ Fiberï¼Œä¼šè¿›å…¥çˆ¶çº§ Fiber çš„â€œå½’â€é˜¶æ®µã€‚â€œé€’â€å’Œâ€œå½’â€é˜¶æ®µä¼šäº¤é”™æ‰§è¡Œç›´åˆ°â€œå½’â€åˆ° rootFiberã€‚è‡³æ­¤ï¼Œrender é˜¶æ®µçš„å·¥ä½œå°±ç»“æŸäº†ã€‚</p><p><a href="https://react.iamkasong.com/process/reconciler.html#%E4%BE%8B%E5%AD%90">å¡é¢‚è€å¸ˆçš„ DEMO</a></p><p>ä¸ºä»€ä¹ˆ EffectTag æ˜¯ç”¨äºŒè¿›åˆ¶ï¼Ÿ å› ä¸ºå¦‚æœè¦æ’å…¥ä¸€ä¸ªå…ƒç´ åˆ°é¡µé¢ä¸­ï¼Œç„¶åè¿˜è¦æ›¿æ¢ä»–çš„å±æ€§ï¼Œé‚£å°±è¦æ ‡è®°æˆ Update å’Œ Placementã€‚ç”¨äºŒè¿›åˆ¶å¯ä»¥å¾ˆå¿«çš„è¿›è¡Œæ ‡è®°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> NoFlags = <span class="hljs-comment">/*                      */</span> <span class="hljs-number">0b00000000000000000000000</span>;<br><br><span class="hljs-keyword">const</span> Placement = <span class="hljs-comment">/*                    */</span> <span class="hljs-number">0b00000000000000000000010</span>;<br><br><span class="hljs-keyword">const</span> Update = <span class="hljs-comment">/*                       */</span> <span class="hljs-number">0b00000000000000000000100</span>;<br><br><span class="hljs-keyword">const</span> PlacementAndUpdate = <span class="hljs-comment">/*           */</span> Placement | Update;<br><br><span class="hljs-comment">// é¦–å…ˆæœ‰ä¸ªå…ƒç´ ,åˆå§‹çŠ¶æ€ä¸ºæ²¡å˜åŒ–</span><br><span class="hljs-keyword">let</span> effectTag = NoFlags;<br><br><span class="hljs-comment">// å…ˆæ’å…¥ï¼ŒæŒ‰ä½æˆ–</span><br>effectTag |= Placement; <span class="hljs-comment">//2 === 0b00000000000000000000010</span><br><span class="hljs-comment">// ç„¶åæ›´æ–°</span><br>effectTag |= Update; <span class="hljs-comment">// 6 === 0b00000000000000000000110</span><br><br>(effectTag &amp; PlacementAndUpdate) !== NoFlags; <span class="hljs-comment">//True</span><br></code></pre></div></td></tr></table></figure><h4 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h4><p>beginWorkï¼šå½“ä¸€ä¸ªèŠ‚ç‚¹è¿›å…¥ beginWork æ—¶ï¼Œç›®çš„æ˜¯ä¸ºäº†åˆ›å»ºå½“å‰ Fiber èŠ‚ç‚¹çš„ç¬¬ä¸€ä¸ªå­ Fiber èŠ‚ç‚¹ï¼Œåˆ¤æ–­å½“å‰ Fiber èŠ‚ç‚¹çš„ç±»å‹ï¼Œè¿›å…¥ä¸åŒçš„ Update é€»è¾‘ã€‚åœ¨è¿›å…¥ Update é€»è¾‘åï¼Œä¼šå…ˆåˆ¤æ–­ WorkInProgress Fiber ä¸­æ˜¯å¦æœ‰å¯¹åº”çš„ Current Fiberï¼Œæ¥å†³å®šæ˜¯å¦æ ‡è®° EffectTagï¼ˆåœ¨ 17.0.3 ä¸­æ›´åä¸º ReactFiberFlagsï¼‰ï¼Œæ¥ç€åˆ¤æ–­å½“å‰ Fiber èŠ‚ç‚¹çš„ child çš„ç±»å‹ï¼Œæ¥æ‰§è¡Œä¸åŒçš„åˆ›å»ºæ“ä½œï¼Œåˆ›å»ºä¸åŒçš„å­ Fiber èŠ‚ç‚¹ã€‚</p><p>completeWorkï¼šæ ¹æ® WorkInProgress çš„ tagï¼Œè¿›å…¥ä¸åŒæ“ä½œã€‚é¦–å…ˆä¸º Fiber èŠ‚ç‚¹åˆ›å»ºå¯¹åº”çš„ DOM èŠ‚ç‚¹ï¼Œ ç„¶åæŒ‚åˆ° Fiber èŠ‚ç‚¹çš„ StateNode ä¸Šã€‚ç„¶åå°† DOM èŠ‚ç‚¹æ’å…¥åˆ°ä¹‹å‰åˆ›å»ºå¥½çš„ DOM æ ‘ä¸­ï¼Œç„¶ååˆå§‹åŒ– DOM å¯¹è±¡çš„å±æ€§ã€‚</p><p><img src="https://react.iamkasong.com/img/beginWork.png" alt="beginWork"><br><img src="https://react.iamkasong.com/img/completeWork.png" alt="completeWork"></p><p>ä½œä¸º DOM æ“ä½œçš„ä¾æ®ï¼Œcommit é˜¶æ®µéœ€è¦æ‰¾åˆ°æ‰€æœ‰æœ‰ effectTag çš„ Fiber èŠ‚ç‚¹å¹¶ä¾æ¬¡æ‰§è¡Œ effectTag å¯¹åº”æ“ä½œï¼Ÿ</p><p>æ¯ä¸ªæ‰§è¡Œå®Œ completeWork ä¸”å­˜åœ¨ effectTag çš„ Fiber èŠ‚ç‚¹ä¼šè¢«ä¿å­˜åœ¨ä¸€æ¡è¢«ç§°ä¸º effectList çš„å•å‘é“¾è¡¨ä¸­ã€‚effectList ä¸­ç¬¬ä¸€ä¸ª Fiber èŠ‚ç‚¹ä¿å­˜åœ¨ fiber.firstEffectï¼Œæœ€åä¸€ä¸ªå…ƒç´ ä¿å­˜åœ¨ fiber.lastEffectã€‚ç±»ä¼¼ appendAllChildrenï¼Œåœ¨â€œå½’â€é˜¶æ®µï¼Œæ‰€æœ‰æœ‰ effectTag çš„ Fiber èŠ‚ç‚¹éƒ½ä¼šè¢«è¿½åŠ åœ¨ effectList ä¸­ï¼Œæœ€ç»ˆå½¢æˆä¸€æ¡ä»¥ rootFiber.firstEffect ä¸ºèµ·ç‚¹çš„å•å‘é“¾è¡¨ã€‚è¿™æ ·ï¼Œåœ¨ commit é˜¶æ®µåªéœ€è¦éå† effectList å°±èƒ½æ‰§è¡Œæ‰€æœ‰ effect äº†ã€‚</p><h2 id="Commit-é˜¶æ®µ"><a href="#Commit-é˜¶æ®µ" class="headerlink" title="Commit é˜¶æ®µ"></a>Commit é˜¶æ®µ</h2><p>ä¸»è¦å·¥ä½œåˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š</p><ul><li><p>before mutation é˜¶æ®µï¼ˆæ‰§è¡Œ DOM æ“ä½œå‰ï¼‰</p></li><li><p>mutation é˜¶æ®µï¼ˆæ‰§è¡Œ DOM æ“ä½œï¼‰</p></li><li><p>layout é˜¶æ®µï¼ˆæ‰§è¡Œ DOM æ“ä½œåï¼‰</p></li></ul><h3 id="beforeMutation-é˜¶æ®µ"><a href="#beforeMutation-é˜¶æ®µ" class="headerlink" title="beforeMutation é˜¶æ®µ"></a>beforeMutation é˜¶æ®µ</h3><ol><li><p>éå† effectList å¹¶è°ƒç”¨<code>commitBeforeMutationEffects</code>å‡½æ•°å¤„ç†</p></li><li><p>commitBeforeMutationEffects å¤„ç†æœ‰ä¸‰æ­¥</p><ol><li><p>å¤„ç† DOM èŠ‚ç‚¹æ¸²æŸ“/åˆ é™¤å focus å’Œ blur é€»è¾‘</p></li><li><p>è°ƒç”¨<code>getSnapshotBeforeUpdate</code>ç”Ÿå‘½å‘¨æœŸ</p></li><li><p>è°ƒåº¦<code>useEffect</code>ã€‚</p></li></ol></li></ol><p>ä¸ºä»€ä¹ˆéœ€è¦å¼‚æ­¥è°ƒç”¨<code>useEffect</code>ï¼Ÿ</p><blockquote><p>ä¸ componentDidMountã€componentDidUpdate ä¸åŒçš„æ˜¯ï¼Œåœ¨æµè§ˆå™¨å®Œæˆå¸ƒå±€ä¸ç»˜åˆ¶ä¹‹åï¼Œä¼ ç»™ useEffect çš„å‡½æ•°ä¼šå»¶è¿Ÿè°ƒç”¨ã€‚è¿™ä½¿å¾—å®ƒé€‚ç”¨äºè®¸å¤šå¸¸è§çš„å‰¯ä½œç”¨åœºæ™¯ï¼Œæ¯”å¦‚è®¾ç½®è®¢é˜…å’Œäº‹ä»¶å¤„ç†ç­‰æƒ…å†µï¼Œå› æ­¤ä¸åº”åœ¨å‡½æ•°ä¸­æ‰§è¡Œé˜»å¡æµè§ˆå™¨æ›´æ–°å±å¹•çš„æ“ä½œã€‚</p></blockquote><p>æ‰€ä»¥<code>useEffect</code>ä¸»è¦æ˜¯é˜²æ­¢åŒæ­¥æ‰§è¡Œæ—¶é˜»å¡æµè§ˆå™¨æ¸²æŸ“ã€‚</p><h3 id="mutation-é˜¶æ®µ"><a href="#mutation-é˜¶æ®µ" class="headerlink" title="mutation é˜¶æ®µ"></a>mutation é˜¶æ®µ</h3><ol><li><p>éå† effectListï¼Œå¹¶è°ƒç”¨<code>commitMutationEffects</code></p></li><li><p><code>commitMutationEffects</code>ä¼šéå† effectListï¼Œå¯¹æ¯ä¸ª Fiber èŠ‚ç‚¹æ‰§è¡Œå¦‚ä¸‹ä¸‰ä¸ªæ“ä½œï¼š</p><ol><li><p>æ ¹æ® ContentReset effectTag é‡ç½®æ–‡å­—èŠ‚ç‚¹</p></li><li><p>æ›´æ–° ref</p></li><li><p>æ ¹æ® effectTag åˆ†åˆ«å¤„ç†ï¼Œå…¶ä¸­ effectTag åŒ…æ‹¬ï¼ˆPlacement | Update | Deletion | Hydratingï¼‰</p></li></ol></li></ol><h4 id="Placement-effect"><a href="#Placement-effect" class="headerlink" title="Placement effect"></a>Placement effect</h4><p>å½“ Fiber èŠ‚ç‚¹å«æœ‰ Placement effectTagï¼Œæ„å‘³ç€è¯¥ Fiber èŠ‚ç‚¹å¯¹åº”çš„ DOM èŠ‚ç‚¹éœ€è¦æ’å…¥åˆ°é¡µé¢ä¸­ã€‚è°ƒç”¨ commitPlacement</p><ol><li><p>è·å–è¯¥ Fiber èŠ‚ç‚¹çš„çˆ¶çº§ DOMã€‚</p></li><li><p>è·å–è¯¥ Fiber èŠ‚ç‚¹çš„å…„å¼Ÿ DOMã€‚</p></li><li><p>æ ¹æ® DOM å…„å¼ŸèŠ‚ç‚¹å­˜åœ¨å†³å®šè°ƒç”¨<code>insertBefore</code> æˆ–<code>appendChild</code>æ‰§è¡Œ DOM æ’å…¥æ“ä½œ</p></li></ol><ul><li>getHostSiblingï¼ˆè·å–å…„å¼Ÿ DOM èŠ‚ç‚¹ï¼‰çš„æ‰§è¡Œå¾ˆè€—æ—¶ï¼Œå½“åœ¨åŒä¸€ä¸ªçˆ¶ Fiber èŠ‚ç‚¹ä¸‹ä¾æ¬¡æ‰§è¡Œå¤šä¸ªæ’å…¥æ“ä½œï¼ŒgetHostSibling ç®—æ³•çš„å¤æ‚åº¦ä¸ºæŒ‡æ•°çº§ã€‚</li></ul><p>è¿™æ˜¯ç”±äº Fiber èŠ‚ç‚¹ä¸åªåŒ…æ‹¬ HostComponentï¼Œæ‰€ä»¥ Fiber æ ‘å’Œæ¸²æŸ“çš„ DOM æ ‘èŠ‚ç‚¹å¹¶ä¸æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚è¦ä» Fiber èŠ‚ç‚¹æ‰¾åˆ° DOM èŠ‚ç‚¹å¾ˆå¯èƒ½è·¨å±‚çº§éå†</p><h4 id="Update-effect"><a href="#Update-effect" class="headerlink" title="Update effect"></a>Update effect</h4><p>å½“ Fiber èŠ‚ç‚¹å«æœ‰ Update effectTagï¼Œæ„å‘³ç€è¯¥ Fiber èŠ‚ç‚¹éœ€è¦æ›´æ–°ã€‚è°ƒç”¨çš„æ–¹æ³•ä¸º commitWorkï¼Œä»–ä¼šæ ¹æ® Fiber.tag åˆ†åˆ«å¤„ç†ã€‚</p><p>å½“ fiber.tag ä¸º FunctionComponentï¼Œä¼šè°ƒç”¨ commitHookEffectListUnMountã€‚è¯¥æ–¹æ³•ä¼šéå† effectListï¼Œæ‰§è¡Œæ‰€æœ‰ useLayoutEffect hook çš„é”€æ¯å‡½æ•°ã€‚</p><p>å½“ fiber.tag ä¸º HostComponentï¼Œä¼šè°ƒç”¨ commitUpdateã€‚æœ€ç»ˆä¼šåœ¨ updateDOMProperties ï¼ˆopens new windowï¼‰ä¸­å°† render é˜¶æ®µ completeWork ï¼ˆopens new windowï¼‰ä¸­ä¸º Fiber èŠ‚ç‚¹èµ‹å€¼çš„ updateQueue å¯¹åº”çš„å†…å®¹æ¸²æŸ“åœ¨é¡µé¢ä¸Šã€‚</p><h4 id="Deletion-effect"><a href="#Deletion-effect" class="headerlink" title="Deletion effect"></a>Deletion effect</h4><p>å½“ Fiber èŠ‚ç‚¹å«æœ‰ Deletion effectTagï¼Œæ„å‘³ç€è¯¥ Fiber èŠ‚ç‚¹å¯¹åº”çš„ DOM èŠ‚ç‚¹éœ€è¦ä»é¡µé¢ä¸­åˆ é™¤ã€‚è°ƒç”¨çš„æ–¹æ³•ä¸º commitDeletionã€‚</p><ol><li><p>é€’å½’è°ƒç”¨ Fiber èŠ‚ç‚¹åŠå…¶å­å­™ Fiber èŠ‚ç‚¹ä¸­ fiber.tag ä¸º ClassComponent çš„ componentWillUnmount (opens new window)ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œä»é¡µé¢ç§»é™¤ Fiber èŠ‚ç‚¹å¯¹åº” DOM èŠ‚ç‚¹</p></li><li><p>è§£ç»‘ ref</p></li><li><p>è°ƒåº¦ useEffect çš„é”€æ¯å‡½æ•°</p></li></ol><h3 id="Layout-é˜¶æ®µ"><a href="#Layout-é˜¶æ®µ" class="headerlink" title="Layout é˜¶æ®µ"></a>Layout é˜¶æ®µ</h3><p>Layout é˜¶æ®µä¹Ÿæ˜¯éå† effectListï¼Œæ‰§è¡Œ commitLayoutEffects æ–¹æ³•ã€‚</p><p>commitLayoutEffects ä¸»è¦åšä¸¤ä»¶äº‹ï¼šè°ƒç”¨ç”Ÿå‘½å‘¨æœŸé’©å­å’Œ hook ç›¸å…³æ“ä½œï¼›èµ‹å€¼ ref</p><h4 id="commitLayoutEffectOnFiberï¼ˆè°ƒç”¨ç”Ÿå‘½å‘¨æœŸé’©å­å’Œ-hook-ç›¸å…³æ“ä½œï¼‰"><a href="#commitLayoutEffectOnFiberï¼ˆè°ƒç”¨ç”Ÿå‘½å‘¨æœŸé’©å­å’Œ-hook-ç›¸å…³æ“ä½œï¼‰" class="headerlink" title="commitLayoutEffectOnFiberï¼ˆè°ƒç”¨ç”Ÿå‘½å‘¨æœŸé’©å­å’Œ hook ç›¸å…³æ“ä½œï¼‰"></a>commitLayoutEffectOnFiberï¼ˆè°ƒç”¨ç”Ÿå‘½å‘¨æœŸé’©å­å’Œ hook ç›¸å…³æ“ä½œï¼‰</h4><p>commitLayoutEffectOnFiber æ–¹æ³•ä¼šæ ¹æ® fiber.tag å¯¹ä¸åŒç±»å‹çš„èŠ‚ç‚¹åˆ†åˆ«å¤„ç†ã€‚</p><ul><li><p>å¯¹äº ClassComponentï¼Œä»–ä¼šé€šè¿‡ current === null?åŒºåˆ†æ˜¯ mount è¿˜æ˜¯ updateï¼Œè°ƒç”¨ componentDidMount ï¼ˆopens new windowï¼‰æˆ– componentDidUpdate</p><ul><li>è§¦å‘çŠ¶æ€æ›´æ–°çš„ this.setState å¦‚æœèµ‹å€¼äº†ç¬¬äºŒä¸ªå‚æ•°å›è°ƒå‡½æ•°ï¼Œä¹Ÿä¼šåœ¨æ­¤æ—¶è°ƒç”¨ã€‚</li></ul></li><li><p>å¯¹äº FunctionComponent åŠç›¸å…³ç±»å‹ï¼Œä»–ä¼šè°ƒç”¨ useLayoutEffect hook çš„å›è°ƒå‡½æ•°ï¼Œè°ƒåº¦ useEffect çš„é”€æ¯ä¸å›è°ƒå‡½æ•°</p></li></ul><p>useEffect å’Œ useLayoutEffect çš„åŒºåˆ«</p><ul><li><p>useEffect éœ€è¦å…ˆè¿›è¡Œè°ƒåº¦ï¼Œç„¶ååœ¨ Layout é˜¶æ®µå®Œæˆåå¼‚æ­¥æ‰§è¡Œ</p></li><li><p>useLayoutEffect æ˜¯åŒæ­¥æ‰§è¡Œçš„ã€‚mutation é˜¶æ®µæ‰§è¡Œ useLayoutEffect çš„é”€æ¯å‡½æ•°ï¼Œç„¶ååœ¨ Layout é˜¶æ®µæ‰§è¡Œå®ƒçš„å›è°ƒå‡½æ•°ã€‚</p></li></ul><h4 id="commitAttachRefï¼ˆèµ‹å€¼-Refï¼‰"><a href="#commitAttachRefï¼ˆèµ‹å€¼-Refï¼‰" class="headerlink" title="commitAttachRefï¼ˆèµ‹å€¼ Refï¼‰"></a>commitAttachRefï¼ˆèµ‹å€¼ Refï¼‰</h4><p>è·å– DOM å®ä¾‹ï¼Œèµ‹å€¼ Ref</p><h4 id="Fiber-æ ‘çš„åˆ‡æ¢"><a href="#Fiber-æ ‘çš„åˆ‡æ¢" class="headerlink" title="Fiber æ ‘çš„åˆ‡æ¢"></a>Fiber æ ‘çš„åˆ‡æ¢</h4><p>åˆ‡æ¢æ—¶æœºï¼šmutation é˜¶æ®µç»“æŸåï¼ŒLayout é˜¶æ®µå¼€å§‹å‰ã€‚</p><p>ä¸ºä»€ä¹ˆï¼Ÿ</p><p>componentWillUnmount ä¼šåœ¨ mutation é˜¶æ®µæ‰§è¡Œï¼Œæ­¤æ—¶ current Fiber æ ‘è¿˜æŒ‡å‘å‰ä¸€æ¬¡æ›´æ–°çš„ Fiber æ ‘ï¼Œåœ¨ç”Ÿå‘½å‘¨æœŸé’©å­å†…è·å–çš„ DOM è¿˜æ˜¯æ›´æ–°å‰çš„ã€‚</p><p>componentDidMount å’Œ componentDidUpdate ä¼šåœ¨ layout é˜¶æ®µæ‰§è¡Œã€‚æ­¤æ—¶ current Fiber æ ‘å·²ç»æŒ‡å‘æ›´æ–°åçš„ Fiber æ ‘ï¼Œåœ¨ç”Ÿå‘½å‘¨æœŸé’©å­å†…è·å–çš„ DOM å°±æ˜¯æ›´æ–°åçš„ã€‚</p><h2 id="Diff-ç®—æ³•"><a href="#Diff-ç®—æ³•" class="headerlink" title="Diff ç®—æ³•"></a>Diff ç®—æ³•</h2><p>ä¸ DOM èŠ‚ç‚¹æœ‰å…³çš„æ¦‚å¿µï¼š</p><ol><li><p>current Fiberã€‚å¦‚æœè¯¥ DOM èŠ‚ç‚¹å·²åœ¨é¡µé¢ä¸­ï¼Œcurrent Fiber ä»£è¡¨è¯¥ DOM èŠ‚ç‚¹å¯¹åº”çš„ Fiber èŠ‚ç‚¹</p></li><li><p>workInProgress Fiberã€‚å¦‚æœè¯¥ DOM èŠ‚ç‚¹å°†åœ¨æœ¬æ¬¡æ›´æ–°ä¸­æ¸²æŸ“åˆ°é¡µé¢ä¸­ï¼ŒworkInProgress Fiber ä»£è¡¨è¯¥ DOM èŠ‚ç‚¹å¯¹åº”çš„ Fiber èŠ‚ç‚¹ã€‚</p></li><li><p>DOM èŠ‚ç‚¹æœ¬èº«ã€‚</p></li><li><p>JSX å¯¹è±¡ã€‚å³ ClassComponent çš„ render æ–¹æ³•çš„è¿”å›ç»“æœï¼Œæˆ– FunctionComponent çš„è°ƒç”¨ç»“æœã€‚JSX å¯¹è±¡ä¸­åŒ…å«æè¿° DOM èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚</p></li></ol><p>diff çš„æœ¬è´¨å°±æ˜¯æ¯”è¾ƒ 1 å’Œ 4ï¼Œç„¶åç”Ÿäº§ 2ã€‚</p><p>ä¸ºäº†é™ä½æ—¶é—´å¤æ‚åº¦ï¼ŒReact çš„ diff ç®—æ³•æœ‰ä¸‰ä¸ªé™åˆ¶</p><ol><li><p>åªæ¯”è¾ƒåŒçº§çš„å…ƒç´ ã€‚å¦‚æœå‰åä¸¤æ¬¡ä¸­æŸèŠ‚ç‚¹è·¨çº§äº†ï¼Œé‚£ä¹ˆ React ä¸ä¼šå¤ç”¨ã€‚</p></li><li><p>åªæ¯”è¾ƒç›¸åŒç±»å‹çš„èŠ‚ç‚¹ã€‚å¦‚æœå…ƒç´ ç”± div å˜ä¸º pï¼ŒReact ä¼šé”€æ¯ div åŠå…¶å­å­™èŠ‚ç‚¹ï¼Œå¹¶æ–°å»º p åŠå…¶å­å­™èŠ‚ç‚¹ã€‚</p></li><li><p>å¼€å‘è€…é€šè¿‡ key æ¥ä¿æŒç¨³å®šã€‚</p></li></ol><h3 id="diff-å¦‚ä½•å®ç°ï¼Ÿ"><a href="#diff-å¦‚ä½•å®ç°ï¼Ÿ" class="headerlink" title="diff å¦‚ä½•å®ç°ï¼Ÿ"></a>diff å¦‚ä½•å®ç°ï¼Ÿ</h3><p><code>reconcileChildFibers</code>å‡½æ•°ä¼šæ ¹æ® newChildï¼ˆå³ JSX å¯¹è±¡ï¼‰ç±»å‹è°ƒç”¨ä¸åŒçš„å¤„ç†å‡½æ•°ã€‚</p><ol><li><p>å½“ newChild ç±»å‹ä¸º objectã€numberã€stringï¼Œä»£è¡¨åŒçº§åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹</p></li><li><p>å½“ newChild ç±»å‹ä¸º Arrayï¼ŒåŒçº§æœ‰å¤šä¸ªèŠ‚ç‚¹</p></li></ol><h4 id="å•èŠ‚ç‚¹æ—¶"><a href="#å•èŠ‚ç‚¹æ—¶" class="headerlink" title="å•èŠ‚ç‚¹æ—¶"></a>å•èŠ‚ç‚¹æ—¶</h4><p>ä¸Šæ¬¡æ›´æ–°æ—¶çš„ fiber èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨ç›¸åº”çš„ DOM èŠ‚ç‚¹ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™æ–°ç”Ÿæˆä¸€ä¸ª Fiber èŠ‚ç‚¹ï¼Œå¦‚æœå­˜åœ¨åˆ™åˆ¤æ–­è¯¥èŠ‚ç‚¹æ˜¯å¦å¯ä»¥å¤ç”¨ï¼Œå¦‚æœä¸èƒ½å¤ç”¨åˆ™æ ‡è®° DOM éœ€è¦è¢«åˆ é™¤ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªæ–° Fiber èŠ‚ç‚¹ã€‚å¦‚æœå¯ä»¥å¤ç”¨ï¼Œåˆ™å°†ä¸Šæ¬¡æ›´æ–°çš„ Fiber èŠ‚ç‚¹çš„å‰¯æœ¬ä½œä¸ºæœ¬æ¬¡æ–°ç”Ÿæˆçš„ Fiber èŠ‚ç‚¹å¹¶è¿”å›ã€‚</p><ul><li>å¦‚ä½•åˆ¤æ–­ DOM èŠ‚ç‚¹æ˜¯å¦å¯ä»¥å¤ç”¨ï¼Ÿ</li></ul><p>React é€šè¿‡å…ˆåˆ¤æ–­ key æ˜¯å¦ç›¸åŒï¼Œå¦‚æœ key ç›¸åŒåˆ™åˆ¤æ–­ type æ˜¯å¦ç›¸åŒï¼Œåªæœ‰éƒ½ç›¸åŒæ—¶ä¸€ä¸ª DOM èŠ‚ç‚¹æ‰èƒ½å¤ç”¨ã€‚key ç›¸åŒä¸” type ä¸åŒæ—¶æ‰§è¡Œ deleteRemainingChildren å°† child åŠå…¶å…„å¼Ÿ fiber éƒ½æ ‡è®°åˆ é™¤ã€‚key ä¸åŒæ—¶ä»…å°† child æ ‡è®°åˆ é™¤ã€‚</p><h4 id="å¤šèŠ‚ç‚¹æ—¶"><a href="#å¤šèŠ‚ç‚¹æ—¶" class="headerlink" title="å¤šèŠ‚ç‚¹æ—¶"></a>å¤šèŠ‚ç‚¹æ—¶</h4><p>ä¼šè¿›è¡Œä¸¤è½®éå†ã€‚ç¬¬ä¸€è½®éå†å¤„ç†æ›´æ–°çš„å…ƒç´ ã€‚ç¬¬äºŒè½®éå†å¤„ç†ä¸å±äºæ›´æ–°çš„èŠ‚ç‚¹ã€‚</p><ul><li>ä¸ºä»€ä¹ˆä¸ç”¨åŒæŒ‡é’ˆä¼˜åŒ–ï¼Ÿ</li></ul><p>å› ä¸ºåŒçº§çš„ Fiber èŠ‚ç‚¹é—´æ˜¯ç”¨ sibling æŒ‡é’ˆè¿æ¥å½¢æˆçš„å•é“¾è¡¨ã€‚</p><p>ç¬¬ä¸€è½®éå†çš„è¿‡ç¨‹ï¼š</p><ol><li><p><code>let i = 0</code>ï¼Œéå†<code>newChildren</code>ï¼Œå°†<code>newChildren[i]</code>ä¸<code>oldFiber</code>æ¯”è¾ƒï¼Œåˆ¤æ–­ DOM èŠ‚ç‚¹æ˜¯å¦å¯å¤ç”¨ã€‚</p></li><li><p>å¦‚æœå¯å¤ç”¨ï¼Œi++ï¼Œç»§ç»­æ¯”è¾ƒ<code>newChildren[i]</code>ä¸<code>oldFiber.sibling</code>ï¼Œå¯ä»¥å¤ç”¨åˆ™ç»§ç»­éå†ã€‚</p></li><li><p>å¦‚æœä¸å¯å¤ç”¨ï¼Œåˆ†ä¸¤ç§æƒ…å†µï¼š</p><ul><li><p>key ä¸åŒå¯¼è‡´ä¸å¯å¤ç”¨ï¼Œç«‹å³è·³å‡ºæ•´ä¸ªéå†ï¼Œç¬¬ä¸€è½®éå†ç»“æŸã€‚</p></li><li><p>key ç›¸åŒ type ä¸åŒå¯¼è‡´ä¸å¯å¤ç”¨ï¼Œä¼šå°† oldFiber æ ‡è®°ä¸º DELETIONï¼Œå¹¶ç»§ç»­éå†</p></li></ul></li><li><p>å¦‚æœ<code>newChildren</code>éå†å®Œï¼ˆå³<code>i === newChildren.length - 1</code>ï¼‰æˆ–è€…<code>oldFiber</code>éå†å®Œï¼ˆå³<code>oldFiber.sibling === null</code>ï¼‰ï¼Œè·³å‡ºéå†ï¼Œç¬¬ä¸€è½®éå†ç»“æŸã€‚</p></li></ol><p>ç¬¬ä¸€è½®éå†ç»“æŸæœ‰ä¸¤ç§ç»“æœï¼š</p><p>ç¬¬ä¸€ç§ä» 3 è·³å‡ºæ¥çš„ï¼š<code>newChildren</code>æ²¡éå†å®Œ<code>oldFiber</code>æ²¡éå†å®Œ</p><p>ç¬¬äºŒç§ä» 4 è·³å‡ºæ¥çš„ï¼š<code>newChildren</code>æ²¡éå†å®Œ<code>oldFiber</code>éå†å®Œï¼ˆç›¸å½“äºæœ‰æ–°å¢ï¼‰ï¼Œ<code>oldFiber</code>æ²¡éå†å®Œ<code>newChildren</code>éå†å®Œï¼ˆç›¸å½“äºæœ‰åˆ å‡ï¼‰ï¼Œ<code>newChildren</code>å’Œ<code>oldFiber</code>éƒ½éå†å®Œï¼ˆç›¸å½“äºæ²¡å¢æ²¡å‡ï¼‰</p><p>å¸¦ç€ä¸Šé¢çš„ç»“æœè¿›è¡Œç¬¬äºŒè½®éå†</p><p>å¦‚æœ<code>newChildren</code>å’Œ<code>oldFiber</code>éƒ½éå†å®Œï¼Œæœ€ç†æƒ³æƒ…å†µï¼Œåªåœ¨ç¬¬ä¸€è½®éå†è¿›è¡Œæ›´æ–°ã€‚Diff ç»“æŸã€‚</p><p>å¦‚æœ<code>newChildren</code>æ²¡éå†å®Œ<code>oldFiber</code>éå†å®Œï¼Œæœ‰æ–°èŠ‚ç‚¹æ’å…¥ï¼Œéå†å‰©ä¸‹çš„<code>newChildren</code>ä¸ºç”Ÿæˆçš„<code>workInProgress fiber</code>ä¾æ¬¡æ ‡è®°<code>Placement</code>ã€‚</p><p>å¦‚æœ<code>oldFiber</code>æ²¡éå†å®Œ<code>newChildren</code>éå†å®Œï¼Œæœ‰èŠ‚ç‚¹è¢«åˆ äº†ï¼Œéå†å‰©ä¸‹çš„<code>oldFiber</code>ï¼Œä¸€æ¬¡æ ‡è®°<code>Deletion</code></p><p>å¦‚æœ<code>newChildren</code>æ²¡éå†å®Œ<code>oldFiber</code>æ²¡éå†å®Œï¼Œæœ‰èŠ‚ç‚¹å˜æ¢äº†ä½ç½®ã€‚å°†æ‰€æœ‰æ²¡å¤„ç†çš„<code>oldFiber</code>å­˜å…¥ä»¥<code>key</code>ä¸º keyï¼Œ<code>oldFiber</code>ä¸º value çš„ map ä¸­ã€‚ç„¶åéå†å‰©ä½™çš„<code>newChildren</code>ï¼Œé€šè¿‡<code>newChildren[i].key</code>å°±èƒ½åœ¨<code>existingChildren</code>ä¸­æ‰¾åˆ° key ç›¸åŒçš„ oldFiberã€‚å…ˆæ ‡è®°æœ€åä¸€ä¸ªå¯å¤ç”¨èŠ‚ç‚¹çš„ä½ç½®ï¼Œç„¶åä¿å­˜è€èŠ‚ç‚¹çš„ä½ç½®ã€‚ä¸¤ä¸ªä½ç½®ä¿¡æ¯æ¯”è¾ƒã€‚å¦‚æœè€ä½ç½®&lt;æœ€åä¸€ä¸ªå¯å¤ç”¨èŠ‚ç‚¹çš„ä½ç½®ï¼Œåˆ™ è¯¥èŠ‚ç‚¹ å‘å³ç§»åŠ¨ã€‚å¦‚æœè€ä½ç½®&gt;=æœ€åä¸€ä¸ªå¯å¤ç”¨èŠ‚ç‚¹çš„ä½ç½®ï¼Œåˆ™è¯¥èŠ‚ç‚¹ä¸åŠ¨ï¼Œç„¶åå¯å¤ç”¨èŠ‚ç‚¹çš„ä½ç½®å˜æ›´ä¸ºè¯¥è€ä½ç½®ã€‚</p><p>ä¾‹å­</p><figure class="highlight nix"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nix">abcd-&gt;adbcï¼ˆkeyå’Œvalueéƒ½ä¸ºè¡¨ç¤ºçš„è¿™ä¸ªï¼‰<br><br>åœ¨ç¬¬ä¸€è½®éå†çš„æ—¶å€™ä¿å­˜å¾—åˆ°ï¼Œaæ˜¯æœ€åå¯å¤ç”¨èŠ‚ç‚¹,ç”¨lastChangeIndexä¿å­˜æ”¹ä½ç½®:<span class="hljs-number">0</span>ã€‚å‰©ä½™çš„<span class="hljs-attr">newChildren</span> = dbc , å‰©ä½™çš„<span class="hljs-attr">oldFiber=</span> bcdã€‚<br>éå†å‰©ä½™çš„newChildrenï¼Œç¬¬ä¸€ä¸ªä¸ºdï¼Œkeyä¹Ÿæ˜¯dã€‚åœ¨oldFiberä¸­çš„ä½ç½®ä¸º<span class="hljs-attr">oldIndex</span> = <span class="hljs-number">3</span>ã€‚ å› ä¸ºoldIndex(<span class="hljs-number">3</span>)&gt;=lastChangeIndex(<span class="hljs-number">0</span>)ï¼Œåˆ™è¯¥ç‚¹ä¸åŠ¨ï¼Œå°†<span class="hljs-attr">lasChangeIndex</span> = <span class="hljs-number">3</span>ã€‚<br>å‰©ä½™çš„<span class="hljs-attr">newChildren</span> = bc , å‰©ä½™çš„<span class="hljs-attr">oldFiber=</span> bcã€‚ç¬¬äºŒä¸ªä¸ºbï¼Œåœ¨oldFiberä¸­çš„ä½ç½®ä¸º<span class="hljs-attr">oldIndex</span> = <span class="hljs-number">1</span>ã€‚å› ä¸ºoldIndex(<span class="hljs-number">1</span>)&lt;lastChangeIndex(<span class="hljs-number">3</span>)ï¼Œæ‰€ä»¥å°†è¯¥ç‚¹å³ç§»ã€‚<br>å‰©ä½™çš„<span class="hljs-attr">newChildren</span> = c , å‰©ä½™çš„<span class="hljs-attr">oldFiber=</span> cã€‚æœ€åä¸€ä¸ªä¸ºcï¼Œåœ¨oldFiberä¸­çš„ä½ç½®ä¸º<span class="hljs-attr">oldIndex</span> = <span class="hljs-number">2</span>ã€‚oldIndex(<span class="hljs-number">2</span>)&lt;lastChangeIndex(<span class="hljs-number">3</span>)ï¼Œæ‰€ä»¥å°†è¯¥ç‚¹å³ç§»ã€‚<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æºç å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>React</tag>
      
      <tag>æºç </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åœ¨Reactä¸­å› æµ…æ‹·è´å¼•å‘çš„BUG</title>
    <link href="/article/db2c0d0e/"/>
    <url>/article/db2c0d0e/</url>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©åœ¨å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°ä¸€ä¸ª BUGï¼šuseEffect æ²¡æœ‰æŒ‰ç…§æƒ³è±¡ä¸­çš„æ‰§è¡Œã€‚æ‰€ä»¥æœ‰äº†æœ¬ç¯‡æ–‡ç« ã€‚</p><p>éœ€æ±‚å¦‚ä¸‹ï¼šæœ‰ä¸ªåˆ—è¡¨ï¼Œåˆ—è¡¨é¡¹ä¸­çš„<code>content</code>å­—æ®µå¦‚æœå†…å®¹å¤§äº 3 è¡Œï¼Œåˆ™ä»…æ˜¾ç¤ºä¸‰è¡Œï¼Œå¹¶æœ‰ä¸ªå±•å¼€çš„æŒ‰é’®ã€‚</p><p>ç°è±¡ï¼šé€šè¿‡æ¥å£æ‹‰å›æ¥çš„æ•°æ®ï¼Œå¦‚æœæœ¬æ¥å°±å¤§äºä¸‰è¡Œï¼Œä¼šæ˜¾ç¤ºå±•å¼€çš„æŒ‰é’®ã€‚å½“ç‚¹å‡»åˆ—è¡¨å†…çš„é¡¹æ—¶ï¼Œå‘¼å‡ºåŸç”Ÿ APP çš„ä¿®æ”¹é¡µé¢ï¼Œä¿®æ”¹å†…å®¹åï¼Œè°ƒç”¨æˆ‘å‡†å¤‡å¥½çš„æ–¹æ³•ï¼Œæ¥è¿›è¡Œæ•°æ®æ›´æ–°ã€‚å¦‚æœåŸæ¥çš„å†…å®¹å°äºä¸‰è¡Œï¼Œä¿®æ”¹åˆ°ä¸‰è¡Œä»¥ä¸Šçš„æ—¶å€™ä¸ä¼šè¢«æ”¶èµ·ï¼Œä¹Ÿä¸ä¼šæœ‰å±•å¼€æŒ‰é’®ã€‚</p><p>åˆ†æï¼šæ¨¡æ‹Ÿè¿™ç§è¡Œä¸ºçš„<a href="https://codesandbox.io/s/admiring-bose-28noo">ä»£ç </a></p><p>å½“æˆ‘ä»¬ç‚¹å‡»çš„æ—¶å€™å‘ç°ï¼Œä»…æœ‰åˆæ¬¡æ¸²æŸ“æ—¶ useEffect çš„è¾“å‡ºï¼Œå¹¶æ²¡æœ‰æˆ‘ç‚¹å‡»æ›´æ”¹åçš„è¾“å‡ºï¼Œä½†æ˜¯ä»–çš„å†…å®¹å´å˜äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/20210721/firstAfterClick.png" alt="ç¬¬ä¸€æ¬¡ç‚¹å‡»"></p><p>å¼€å§‹æˆ‘èƒ¸æœ‰æˆç«¹çš„è®¤ä¸ºå› ä¸ºåœ¨æ›´æ–°çš„æ—¶å€™è¿›è¡Œçš„æ˜¯æµ…æ¯”è¾ƒï¼Œæ‰€ä»¥æ²¡è§¦å‘æ›´æ–°æµç¨‹ã€‚ï¼ˆç°åœ¨å†·é™ä¸‹æ¥æƒ³ä¸‹ï¼Œæ²¡è§¦å‘æ›´æ–°æµç¨‹æ•°æ®æ€ä¹ˆä¼šæ›´æ–°å‘¢ 23333333ï¼‰</p><p>ç„¶åæˆ‘å°±éå¸¸æ½‡æ´’çš„åœ¨<code>Card</code>è¿™å±‚åŒ…è£¹äº†<code>React.memo</code>,å¦‚ä»£ç ä¸­æ³¨é‡Šçš„é‚£æ ·ï¼Œè®©ä»–è¿›è¡Œä¸ªè‡ªå®šä¹‰æ¯”è¾ƒå»ï¼Œç„¶åè§¦å‘æ›´æ–°æµç¨‹ã€‚</p><p>å†æ¬¡ç‚¹å‡»æŒ‰é’®åï¼Œå‘ç°è§†å›¾å±…ç„¶æ²¡æ›´æ–°ï¼ï¼ï¼ï¼Œå¹¶ä¸”ç¥å¥‡çš„æ˜¯<code>prevProps</code>å’Œ<code>nextProps</code>ç«Ÿç„¶éƒ½æ˜¯æœ€æ–°çš„ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/20210721/secondClick.png" alt="ç¬¬äºŒæ¬¡ç‚¹å‡»">ã€‚</p><p>ç™¾æ€ä¸å¾—å…¶è§£ï¼Œä¸ºä»€ä¹ˆä¼šè¿™æ ·ã€‚</p><p>åœ¨ç»è¿‡æœç´¢åå‘ç°<a href="https://github.com/facebook/react/issues/16643">github</a>è¿™æ¡ issuesã€‚</p><p>ç„¶åå°†åœ¨è¿›è¡Œæ“ä½œçš„åœ°æ–¹å¯¹æ•°æ®è¿›è¡Œäº†æ·±æ‹·è´ï¼Œå°±èƒ½é¡ºåˆ©è§¦å‘ useEffect äº†ã€‚</p><p>é—®é¢˜è§£å†³äº†ã€‚ä½†æ˜¯è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿä¸ºä»€ä¹ˆæ·±æ‹·è´å†æ“ä½œå°±èƒ½è§£å†³é—®é¢˜å‘¢ï¼Ÿ</p><p>çœ‹å›¾ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/20210721/wrongProps.png" alt="æœ‰é—®é¢˜çš„æƒ…å†µ"></p><p>å› ä¸ºåœ¨ newList é‡Œå­˜çš„è¿˜æ˜¯è€åœ°å€ã€‚å½“å¯¹è€åœ°å€çš„æ•°æ®è¿›è¡Œä¿®æ”¹çš„æ—¶å€™ï¼Œ<code>prevProps</code>å–åˆ°çš„ä¹Ÿå°±æ˜¯æœ€æ–°çš„å€¼äº†ã€‚</p><p>æ‰€ä»¥åœ¨å¯¹ newList å†…çš„æ•°ç»„é¡¹è¿›è¡Œå¤åˆ¶çš„æ—¶å€™è¦è¿›è¡Œæ·±æ‹·è´ï¼Œè®©ä»–ä»¬ä¸å†æŒ‡å‘è€åœ°å€ï¼Œè¿™æ ·å°±ä¸ä¼šäº’ç›¸å½±å“äº†ã€‚</p><p>è§£å†³æ–¹æ¡ˆï¼š</p><p>ä¸€ï¼šæ·±æ‹·è´</p><p>äºŒï¼šæ•°æ®ç»“æ„ä¼˜åŒ–ï¼Œä½¿ç”¨æ‰å¹³åŒ–å¤„ç†ã€‚å……åˆ†åˆ©ç”¨ React ä¸­é»˜è®¤çš„æµ…æ¯”è¾ƒã€‚å¯ä»¥é‡‡ç”¨ Immutable ç­‰åº“è¿›è¡Œæ•°æ®å¤„ç†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>React</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ·±æ‹·è´/æµ…æ‹·è´</tag>
      
      <tag>æ•°æ®ç»“æ„</tag>
      
      <tag>React.Memo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>(éšæ‰‹è®°å½•)-GITè§£å†³åˆå¹¶é”™åˆ†æ”¯</title>
    <link href="/article/afdedcbf/"/>
    <url>/article/afdedcbf/</url>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©åœ¨è¿›è¡Œå¤§ç‰ˆæœ¬å‡çº§å®Œï¼Œå°†ç‰ˆæœ¬åˆ†æ”¯å½’æ¡£åˆ° main åˆ†æ”¯çš„æ—¶å€™ï¼Œå‘ç° commits ç‰¹åˆ«å¤šï¼Œä¸€å…±æœ‰ 2000 å¤šæ¡ã€‚</p><p>æ„Ÿè§‰ä¸å¤ªå¯¹åŠ²ï¼Œç¬¬ä¸€ååº”å°±æ˜¯æœ‰äººæŠŠ dev åˆ†æ”¯åˆå¹¶è¿›äº†æŸä¸ªåŠŸèƒ½åˆ†æ”¯ï¼Œç„¶ååœ¨ä»åŠŸèƒ½åˆ†æ”¯åˆå¹¶åˆ°ç‰ˆæœ¬åˆ†æ”¯çš„æ—¶å€™æ²¡æœ‰ä»”ç»†çœ‹ã€‚ï¼ˆå› ä¸ºåœ¨ä¸Šä¸€å®¶å…¬å¸å°±é‡åˆ°è¿‡ä¸€æ¬¡ã€‚ã€‚ã€‚ï¼‰</p><p>ç„¶åæŠ“ç´§æ‰“å¼€ Graphï¼ˆVSCode ä¹Ÿæœ‰æ’ä»¶ï¼‰çœ‹ä¸€ä¸‹è·¯å¾„ã€‚</p><p>å‘ç°æœç„¶å¦‚æˆ‘æ‰€æ–™ã€‚</p><p>é‚£å…¶å®æ˜¯éœ€è¦ä»…ä»…å°†è¿™ä¸ª merge çš„è¯·æ±‚å›æ»šçš„ã€‚æ–¹æ³•å¾ˆå¤šã€‚</p><ol><li><p>æœ€ç®€å•ç²—æš´çš„ï¼šå…ˆä½¿ç”¨ <code>git reflog</code>çœ‹ä¸€ä¸‹æ“ä½œï¼Œæ‰¾åˆ° merge æ—¶çš„ Headï¼Œç›´æ¥æŠŠå¤´é‡æ–°å®šåˆ° merge å‰ä¸€ä¸ªå°±å¯ä»¥ã€‚</p></li><li><p>è¿˜å¯ä»¥ä½¿ç”¨ rebase git rebase -i merge æ“ä½œå‰çš„ commitID.ç„¶ååœ¨ä¿¡æ¯é‡Œé¢æŠŠ merge è¿›æ¥çš„ä¿¡æ¯å‰ç¼€ä» pick æ”¹ä¸º drop</p></li><li><p>revert åä½œ</p></li></ol><p>åœ¨åˆå¹¶é”™çš„åˆ†æ”¯æˆ‘ä»¬æœ¬æ„æ˜¯æ²¡æœ‰ dev åˆ†æ”¯é‡Œçš„å†…å®¹çš„ã€‚ä¹Ÿå°±æ˜¯æ²¡æœ‰ dev è¿™ä¸ªæ–‡ä»¶,å¹¶ä¸” main æ–‡ä»¶å†…åŒæ—¶ä¿ç•™åˆå¹¶åçš„ä¿®æ”¹å†…å®¹ã€‚</p><p>ç›´æ¥<code>git revert mergeçš„commitId -m 1/2</code> ã€‚</p><p>è¿™ä¸ª 1 å’Œ 2 ä»£è¡¨ä¸»åˆ†æ”¯æ˜¯è°ã€‚</p><p>å¯ä»¥é€šè¿‡<code>git show mergeçš„commitIdæŸ¥çœ‹parent</code>ã€‚</p><p>å¦‚æœè¦ä»¥ parent çš„ç¬¬ä¸€ä¸ªä¸ºåŸºå‡†å°±è¾“å…¥ <code>-m 1</code> å¦‚æœæ˜¯ç¬¬äºŒä¸ªå°±æ˜¯<code>-m 2</code></p><p>ç„¶åå¤„ç†ä¸€ä¸‹å†²çªå°±å¯ä»¥äº†ã€‚</p><p>ä¸€å¥è¯æ€»ç»“ï¼š revert å°±æ˜¯å°†å¯¹åº” commitId çš„æ“ä½œåå‘æ“ä½œä¸€éã€‚</p><p>æ›´è¯¦ç»†çš„å¯ä»¥æŸ¥çœ‹<a href="https://www.cnblogs.com/bescheiden/articles/10563651.html">Git ä¹‹ revert</a> å’Œ <a href="https://www.dazhuanlan.com/2019/11/15/5dcdd42820309/">Git æ’¤é”€æŸæ¬¡ merge çš„æ­£ç¡®å®ç°æ–¹æ³•</a></p>]]></content>
    
    
    <categories>
      
      <category>éšæ‰‹è®°å½•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GIT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>(éšæ‰‹è®°å½•)-ä¸€äº›å…³äºBOMçš„é›¶æ•£çŸ¥è¯†</title>
    <link href="/article/668e3aae/"/>
    <url>/article/668e3aae/</url>
    
    <content type="html"><![CDATA[<h2 id="ç”¨-setTimeout-å®ç°ä¸€ä¸ª-setInterval"><a href="#ç”¨-setTimeout-å®ç°ä¸€ä¸ª-setInterval" class="headerlink" title="ç”¨ setTimeout å®ç°ä¸€ä¸ª setInterval"></a>ç”¨ setTimeout å®ç°ä¸€ä¸ª setInterval</h2><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> run = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-comment">// DoSomethings</span><br>  run();<br>&#125;, <span class="hljs-number">3000</span>);<br></code></pre></div></td></tr></table></figure><p>è¿™ç§å®ç°çš„æ–¹å¼ä¸ setInterval çš„åŒºåˆ«ï¼šsetInterval ä¸å…³å¿ƒæ–¹æ³•æ˜¯å¦è¿˜åœ¨è¿è¡Œï¼›setTimeout å®ç°çš„ä¸€å®šæ˜¯åœ¨æœ‰äº†ç»“æœä¹‹åæ‰ç»§ç»­æ‰§è¡Œç¬¬äºŒæ¬¡çš„ã€‚</p><h2 id="å°è£…ä¸ªæ”¯æŒè¶…æ—¶çš„-fetch-æ–¹æ³•"><a href="#å°è£…ä¸ªæ”¯æŒè¶…æ—¶çš„-fetch-æ–¹æ³•" class="headerlink" title="å°è£…ä¸ªæ”¯æŒè¶…æ—¶çš„ fetch æ–¹æ³•"></a>å°è£…ä¸ªæ”¯æŒè¶…æ—¶çš„ fetch æ–¹æ³•</h2><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> fetchWithTimeout = <span class="hljs-function">(<span class="hljs-params">url, init, timeout = <span class="hljs-number">3000</span></span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>    fetch(url, init).then(resolve).catch(reject);<br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>      reject(<span class="hljs-string">&quot;è¶…æ—¶äº†&quot;</span>);<br>    &#125;, timeout);<br>  &#125;);<br>&#125;;<br></code></pre></div></td></tr></table></figure><p>åˆ©ç”¨ Promise çš„ç‰¹æ€§ï¼šåªèƒ½ä» Pending åˆ° Fulfilled æˆ–åªèƒ½ä» Pending åˆ° Rejectedã€‚</p><p>åŒç†å¯ä»¥å°è£…ä¸ªé€šç”¨çš„å¼‚æ­¥å‡½æ•°è¶…æ—¶é€»è¾‘;</p><h2 id="fetch-çš„ä¸­æ–­"><a href="#fetch-çš„ä¸­æ–­" class="headerlink" title="fetch çš„ä¸­æ–­"></a>fetch çš„ä¸­æ–­</h2><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> controller =  <span class="hljs-keyword">new</span> AbortController();<br><br><br>fetch(url,&#123;<br>  <span class="hljs-attr">signal</span>:controller.signal;<br>&#125;)<br><br><br>controller.abort();<br></code></pre></div></td></tr></table></figure><h2 id="ä¸ºä»€ä¹ˆ-cdn-åŸŸåä¸ä¸šåŠ¡åŸŸåä¸ç›¸åŒï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆ-cdn-åŸŸåä¸ä¸šåŠ¡åŸŸåä¸ç›¸åŒï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆ cdn åŸŸåä¸ä¸šåŠ¡åŸŸåä¸ç›¸åŒï¼Ÿ"></a>ä¸ºä»€ä¹ˆ cdn åŸŸåä¸ä¸šåŠ¡åŸŸåä¸ç›¸åŒï¼Ÿ</h2><ol><li><p>å®‰å…¨é—®é¢˜ï¼šcookie ä¸­å­˜ç€çš„å¤šä¸ºç”¨æˆ·èº«ä»½ä¿¡æ¯ï¼Œå¦‚æœæ˜¯åŒåŸŸåçš„è¯ä¼šæºå¸¦ç€ cookie ä¸€èµ·å»è¯·æ±‚èµ„æºï¼Œä¼šé€ æˆä¿¡æ¯æ³„æ¼ã€‚</p></li><li><p>èŠ‚çœå¸¦å®½ï¼šä¸ä¼šå¸¦ cookie</p></li><li><p>å¹¶å‘è¯·æ±‚æ•°ï¼šHTTP/1.1 ä¼šé™åˆ¶åŒåŸŸè¯·æ±‚åªèƒ½æœ‰ 6 ä¸ªï¼Œä¼šé˜»å¡ä¸šåŠ¡çš„è¯·æ±‚ã€‚</p></li></ol><h2 id="å¼ºç¼“å­˜ä¸åå•†ç¼“å­˜"><a href="#å¼ºç¼“å­˜ä¸åå•†ç¼“å­˜" class="headerlink" title="å¼ºç¼“å­˜ä¸åå•†ç¼“å­˜"></a>å¼ºç¼“å­˜ä¸åå•†ç¼“å­˜</h2><h3 id="å¼ºç¼“å­˜"><a href="#å¼ºç¼“å­˜" class="headerlink" title="å¼ºç¼“å­˜"></a>å¼ºç¼“å­˜</h3><ul><li><p>Expiresï¼šè®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œå¼Šç«¯ï¼šå¯èƒ½å­˜åœ¨å®¢æˆ·ç«¯æ—¶é—´è·ŸæœåŠ¡ç«¯æ—¶é—´ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</p></li><li><p>max-age</p></li></ul><h3 id="åå•†ç¼“å­˜"><a href="#åå•†ç¼“å­˜" class="headerlink" title="åå•†ç¼“å­˜"></a>åå•†ç¼“å­˜</h3><ul><li><p>Last-Modified + If-Modified-Since ï¼šå¼Šç«¯åŒ Expires</p></li><li><p>ETag + If-None-Matchï¼šå¼Šç«¯ï¼šå› ä¸ºéœ€è¦é’ˆå¯¹æ–‡ä»¶ç”Ÿæˆå”¯ä¸€æ ‡è¯†ï¼Œä¼šå½±å“æ€§èƒ½ã€‚</p></li></ul><h4 id="å¦‚æœæ˜¯-SPA-é¡µé¢çš„-HTML-ç”¨ä»€ä¹ˆç¼“å­˜ï¼Ÿ"><a href="#å¦‚æœæ˜¯-SPA-é¡µé¢çš„-HTML-ç”¨ä»€ä¹ˆç¼“å­˜ï¼Ÿ" class="headerlink" title="å¦‚æœæ˜¯ SPA é¡µé¢çš„ HTML ç”¨ä»€ä¹ˆç¼“å­˜ï¼Ÿ"></a>å¦‚æœæ˜¯ SPA é¡µé¢çš„ HTML ç”¨ä»€ä¹ˆç¼“å­˜ï¼Ÿ</h4><ul><li><p>æœ€å¥½ä¸ç¼“å­˜ã€‚å› ä¸ºå†…å®¹ä¸­å¼•ç”¨çš„ js å’Œ css éƒ½å¸¦ hashï¼Œhtml å†…å®¹ä¼šé¢‘ç¹å˜æ›´ï¼Œå¦‚æœç”¨å¼ºç¼“å­˜ä¼šå¯¼è‡´æ›´æ–°ä¸åŠæ—¶ã€‚</p></li><li><p>å¯ä»¥é‡‡ç”¨åå•†ç¼“å­˜ï¼Œæ¯æ¬¡æ‰“åŒ…å‡ºæ¥çš„ html å†…å®¹éƒ½ä¼šå˜æ›´ã€‚</p></li></ul><h2 id="äº‹ä»¶ç›‘å¬"><a href="#äº‹ä»¶ç›‘å¬" class="headerlink" title="äº‹ä»¶ç›‘å¬"></a>äº‹ä»¶ç›‘å¬</h2><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// ç¬¬ä¸‰ä¸ªå‚æ•°ä»£è¡¨ç›‘å¬é˜¶æ®µï¼Œtrueä¸ºæ•è·é˜¶æ®µï¼Œfalse/é»˜è®¤ä¸ºå†’æ³¡é˜¶æ®µã€‚IEåªæœ‰å†’æ³¡ã€‚</span><br>element.addEventListener(type, callBack, option);<br></code></pre></div></td></tr></table></figure><h2 id="äº‹ä»¶å§”æ‰˜"><a href="#äº‹ä»¶å§”æ‰˜" class="headerlink" title="äº‹ä»¶å§”æ‰˜"></a>äº‹ä»¶å§”æ‰˜</h2><p>ä¼˜ç‚¹ï¼šèŠ‚çœå†…å­˜ï¼Œå‡å°‘æ³¨å†Œäº‹ä»¶ã€‚<br>åŸç†ï¼šåˆ©ç”¨äº‹ä»¶å†’æ³¡.</p><p>å®Œæ•´ä»£ç è§:<a href="https://github.com/AruSeito/daily-practice/blob/main/others/BomEvent/%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98/index.html">äº‹ä»¶å§”æ‰˜</a></p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// HTMLç»“æ„å¦‚ä¸‹ ul&gt;li*7</span><br><br><span class="hljs-keyword">const</span> ul = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&quot;ul&quot;</span>);<br><br>ul.addEventListener(<span class="hljs-string">&quot;click&quot;</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> target = e.target;<br>  <span class="hljs-keyword">const</span> liNodeList = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">&quot;li&quot;</span>);<br>  <span class="hljs-keyword">if</span> (target.tagName.toLowerCase() === <span class="hljs-string">&quot;li&quot;</span>) &#123;<br>    <span class="hljs-keyword">const</span> liList = <span class="hljs-built_in">Array</span>.from(liNodeList);<br>    <span class="hljs-keyword">const</span> index = liList.indexOf(target);<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`index=<span class="hljs-subst">$&#123;index&#125;</span>`</span>);<br>  &#125;<br>&#125;);<br></code></pre></div></td></tr></table></figure><h2 id="é˜»æ­¢äº‹ä»¶ä¼ æ’­"><a href="#é˜»æ­¢äº‹ä»¶ä¼ æ’­" class="headerlink" title="é˜»æ­¢äº‹ä»¶ä¼ æ’­"></a>é˜»æ­¢äº‹ä»¶ä¼ æ’­</h2><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">e.stopPropagation();<br></code></pre></div></td></tr></table></figure><h3 id="åœºæ™¯è®¾è®¡"><a href="#åœºæ™¯è®¾è®¡" class="headerlink" title="åœºæ™¯è®¾è®¡"></a>åœºæ™¯è®¾è®¡</h3><p>ä¸€ä¸ªé¡µé¢æœ‰å¾ˆå¤šçš„å…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æœ‰å±äºè‡ªå·±çš„ click äº‹ä»¶ã€‚å¦‚æœä¸€ä¸ªç”¨æˆ·è¿›å…¥é¡µé¢ï¼Œä¼šæœ‰ä¸€ä¸ª banned çš„å±æ€§ã€‚å¦‚æœä¸º true åˆ™ç”¨æˆ·æ— è®ºç‚¹å‡»é¡µé¢çš„å“ªé‡Œéƒ½ä¸ä¼šè§¦å‘ä¹‹å‰çš„ç‚¹å‡»äº‹ä»¶ï¼Œåªèƒ½è§¦å‘å¼¹çª—æé†’è¢«å°ç¦äº†.å¦‚æœä¸º falseï¼Œåˆ™æŒ‰ç…§ä¹‹å‰çš„æ‰§è¡Œå°±å¯ä»¥ã€‚</p><h4 id="æ–¹æ¡ˆä¸€ï¼šå»ºä¸€ä¸ªæœ€é«˜å±‚çš„é€æ˜é®ç½©å±‚ã€‚ç‚¹å‡»å°±å¼¹ã€‚"><a href="#æ–¹æ¡ˆä¸€ï¼šå»ºä¸€ä¸ªæœ€é«˜å±‚çš„é€æ˜é®ç½©å±‚ã€‚ç‚¹å‡»å°±å¼¹ã€‚" class="headerlink" title="æ–¹æ¡ˆä¸€ï¼šå»ºä¸€ä¸ªæœ€é«˜å±‚çš„é€æ˜é®ç½©å±‚ã€‚ç‚¹å‡»å°±å¼¹ã€‚"></a>æ–¹æ¡ˆä¸€ï¼šå»ºä¸€ä¸ªæœ€é«˜å±‚çš„é€æ˜é®ç½©å±‚ã€‚ç‚¹å‡»å°±å¼¹ã€‚</h4><h4 id="æ–¹æ¡ˆäºŒï¼šè¿ç”¨stopPropagation"><a href="#æ–¹æ¡ˆäºŒï¼šè¿ç”¨stopPropagation" class="headerlink" title="æ–¹æ¡ˆäºŒï¼šè¿ç”¨stopPropagation()"></a>æ–¹æ¡ˆäºŒï¼šè¿ç”¨<code>stopPropagation()</code></h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">&quot;click&quot;</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">if</span> (banned) &#123;<br>    e.stopPropagation();<br>    alert(<span class="hljs-string">&quot;ä½ è¢«å°ç¦äº†&quot;</span>);<br>    <span class="hljs-keyword">return</span>;<br>  &#125;<br>  <span class="hljs-comment">// OriganThings</span><br>&#125;);<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>éšæ‰‹è®°å½•</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æ‰‹å†™ä¸€ä¸ªPromise/A+</title>
    <link href="/article/ba852590/"/>
    <url>/article/ba852590/</url>
    
    <content type="html"><![CDATA[<div class="note note-success">            <p>2021/07/04 æ›´æ–°æ—¥å¿—ï¼š æ‰‹å†™ä¸€ä¸ªç¬¦åˆ Promise/A+è§„èŒƒçš„ Promise<br>2021/07/05 æ›´æ–°æ—¥å¿—ï¼š å®Œæˆ Promise.resolve(),Promise.reject(),Promise.race();</p>          </div><p>Promise åœ¨æ—¥å¸¸å¼€å‘ä¸­ç»å¸¸ç”¨åˆ°ï¼Œä½¿ç”¨é¢‘ç‡ç›¸å½“çš„é«˜äº†ã€‚ä¸ºäº†èƒ½å¤Ÿæ›´å¥½çš„åº”ç”¨ Promise éœ€è¦å¯¹ Promise è¿›è¡Œä¸€äº›æ›´æ·±çš„ç†è§£ï¼Œæ‰€ä»¥å°è¯•ç€æŒ‰ç…§ Promise/A+è§„èŒƒè¿›è¡Œäº†ä¸€æ¬¡æ‰‹æ’•ä»£ç ã€‚</p><p>Promise/A+çš„å†…å®¹å°±ä¸ç»†è‡´å±•å¼€æè¿°ä¸€è¾¹äº†ï¼Œç›´æ¥å¼€å§‹æ‰‹æ’•ä»£ç ï¼Œå°†è§„èŒƒçš„å†…å®¹åˆ†è§£å¼€å§‹è¿›è¡Œå®è·µã€‚(å…·ä½“åŸç‰ˆæè¿°è¯·çœ‹ Promise/A+)</p><h2 id="æ‰‹æ’•ä¸€ä¸ª-Promise"><a href="#æ‰‹æ’•ä¸€ä¸ª-Promise" class="headerlink" title="æ‰‹æ’•ä¸€ä¸ª Promise"></a>æ‰‹æ’•ä¸€ä¸ª Promise</h2><p>Promise æœ‰ä¸‰ä¸ªçŠ¶æ€ï¼Œä¸¤ä¸ªè¿‡ç¨‹ï¼ŒFULFILLED æœ‰ä¸€ä¸ª valueï¼ŒREJECTED æœ‰ä¸€ä¸ª reason</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-comment">// ä¸‰ä¸ªçŠ¶æ€</span><br><span class="hljs-keyword">const</span> PENDING = <span class="hljs-string">&quot;pending&quot;</span>;<br><span class="hljs-keyword">const</span> FULFILLED = <span class="hljs-string">&quot;fulfilled&quot;</span>;<br><span class="hljs-keyword">const</span> REJECTED = <span class="hljs-string">&quot;rejected&quot;</span>;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyPromise</span></span>&#123;<br>  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-built_in">this</span>.status = PENDING;<br>    <span class="hljs-built_in">this</span>.value = <span class="hljs-literal">null</span>;<br>    <span class="hljs-built_in">this</span>.reason = <span class="hljs-literal">null</span>;<br>  &#125;<br><br>  <span class="hljs-comment">// ä¸¤ä¸ªè¿‡ç¨‹æ¥æ”¹å˜çŠ¶æ€ã€‚å¹¶ä¸”çŠ¶æ€åªèƒ½ä»PENDINGå¼€å§‹åˆ°FULFILLED/REJECTEDç»“æŸã€‚</span><br>  <span class="hljs-function"><span class="hljs-title">resolve</span>(<span class="hljs-params">value</span>)</span> &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.status === PENDING) &#123;<br>      <span class="hljs-built_in">this</span>.status = FULFILLED;<br>      <span class="hljs-built_in">this</span>.value = value;<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-function"><span class="hljs-title">reject</span>(<span class="hljs-params">reason</span>)</span> &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.status === PENDING) &#123;<br>      <span class="hljs-built_in">this</span>.status = REJECTED;<br>      <span class="hljs-built_in">this</span>.reason = reason;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>åœ¨æˆ‘ä»¬ä½¿ç”¨ Promise çš„æ—¶ï¼Œå¯ä»¥è¿™æ ·ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br>  <span class="hljs-comment">// doSomethings</span><br>&#125;)<br></code></pre></div></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦åœ¨æ„é€ å‡½æ•°ä¸­ä¼ å…¥ä¸€ä¸ªå‡½æ•°,å¹¶ä¸”åœ¨åˆå§‹åŒ–çš„æ—¶å€™ä¼ å…¥çš„å‡½æ•°å°±å·²ç»æ‰§è¡Œäº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyPromise</span></span>&#123;<br>  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">fn</span>)</span> &#123;<br>    <span class="hljs-built_in">this</span>.status = PENDING;<br>    <span class="hljs-built_in">this</span>.value = <span class="hljs-literal">null</span>;<br>    <span class="hljs-built_in">this</span>.reason = <span class="hljs-literal">null</span>;<br><br>    <span class="hljs-comment">// åœ¨åˆå§‹åŒ–çš„æ—¶å€™æ‰§è¡Œä¼ å…¥çš„å‡½æ•°</span><br>    <span class="hljs-keyword">try</span>&#123;<br>      fn(<span class="hljs-built_in">this</span>.resolve.bind(<span class="hljs-built_in">this</span>),<span class="hljs-built_in">this</span>.reject.bind(<span class="hljs-built_in">this</span>))<br>    &#125;<span class="hljs-keyword">catch</span>(e)&#123;<br>      <span class="hljs-built_in">this</span>.reject(e);<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">// çœç•¥</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p>æŒ‰ç…§è§„èŒƒæ‰€è¯´ï¼Œthen æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•° onFulfilled,onRejected.å¹¶ä¸”è¿”å›çš„æ˜¯ä¸€ä¸ªä¹Ÿæ˜¯ä¸€ä¸ª Promiseã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyPromise</span></span>&#123;<br>  <span class="hljs-comment">// çœç•¥</span><br><br>  <span class="hljs-function"><span class="hljs-title">then</span>(<span class="hljs-params">onFulfilled,onRejected</span>)</span>&#123;<br>    <span class="hljs-keyword">const</span> promise2 = <span class="hljs-keyword">new</span> MyPromise();<br>    <span class="hljs-keyword">return</span> promise2;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>onFulfilled/onRejected å¿…é¡»æ˜¯ä¸ªå‡½æ•°ï¼Œå¦‚æœä¸æ˜¯ä¸€ä¸ªå‡½æ•°åˆ™è¦å¿½ç•¥å®ƒï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å¯ä»¥</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br>  <span class="hljs-comment">// doSomethings</span><br>&#125;).then(<span class="hljs-number">11111</span>)<br></code></pre></div></td></tr></table></figure><p>è¿™æ˜¯å› ä¸ºä¼ å…¥éå‡½æ•°æ—¶ï¼Œå‚æ•°ä¼šè¢«å¤„ç†æˆå‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyPromise</span></span>&#123;<br>  <span class="hljs-comment">// çœç•¥</span><br><br>  <span class="hljs-function"><span class="hljs-title">isFunction</span>(<span class="hljs-params">param</span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> param === <span class="hljs-string">&quot;function&quot;</span><br>  &#125;<br><br>  <span class="hljs-function"><span class="hljs-title">then</span>(<span class="hljs-params">onFulfilled,onRejected</span>)</span>&#123;<br>    <span class="hljs-keyword">const</span> realOnFulfilled = <span class="hljs-built_in">this</span>.isFunction(onFulfilled) ?onFulfilled:<span class="hljs-function">(<span class="hljs-params">value</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">return</span> value;<br>    &#125;<br><br>    <span class="hljs-keyword">const</span> realOnRejected = <span class="hljs-built_in">this</span>.isFunction(onRejected) ? onRejected:<span class="hljs-function">(<span class="hljs-params">reason</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">throw</span> reason;<br>    &#125;<br>    <span class="hljs-keyword">const</span> promise2 = <span class="hljs-keyword">new</span> MyPromise();<br>    <span class="hljs-keyword">return</span> promise2;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç„¶åæ ¹æ®å½“å‰çŠ¶æ€è°ƒç”¨ä¸åŒçš„å‡½æ•°</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyPromise</span></span>&#123;<br>  <span class="hljs-comment">// çœç•¥</span><br><br>  <span class="hljs-function"><span class="hljs-title">isFunction</span>(<span class="hljs-params">param</span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> param === <span class="hljs-string">&quot;function&quot;</span><br>  &#125;<br><br>  <span class="hljs-function"><span class="hljs-title">then</span>(<span class="hljs-params">onFulfilled,onRejected</span>)</span>&#123;<br>    <span class="hljs-keyword">const</span> realOnFulfilled = <span class="hljs-built_in">this</span>.isFunction(onFulfilled) ? onFulfilled:<span class="hljs-function">(<span class="hljs-params">value</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">return</span> value;<br>    &#125;<br><br>    <span class="hljs-keyword">const</span> realOnRejected = <span class="hljs-built_in">this</span>.isFunction(onRejected) ? onRejected:<span class="hljs-function">(<span class="hljs-params">reason</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">throw</span> reason;<br>    &#125;<br>    <span class="hljs-keyword">const</span> promise2 = <span class="hljs-keyword">new</span> MyPromise(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">switch</span>(<span class="hljs-built_in">this</span>.status)&#123;<br>        <span class="hljs-keyword">case</span> FULFILLED:<br>          realOnFulfilled();<br>          <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> REJECTED:<br>          realOnRejected();<br>          <span class="hljs-keyword">break</span>;<br>      &#125;<br>    &#125;);<br>    <span class="hljs-keyword">return</span> promise2;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¿™æ—¶å¯èƒ½ status è¿˜æ²¡å˜æˆç»ˆæ€ï¼Œå› æ­¤éœ€è¦æä¸ªç›‘å¬ï¼Œå½“ status å˜æˆç»ˆæ€æ—¶åœ¨è°ƒç”¨å¯¹åº”çš„å›è°ƒã€‚æ‰€ä»¥ï¼Œå¦‚æœè¿™æ—¶æ˜¯ pending çš„æ—¶å€™ï¼Œå…ˆå°†æˆåŠŸå’Œå¤±è´¥çš„å›æ‰åˆ†åˆ«å­˜å‚¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyPromise</span></span>&#123;<br>  FULFILLED_CALLBACK_LIST = [];<br>  REJECTED_CALLBACK_LIST = [];<br>  <span class="hljs-comment">// çœç•¥</span><br><br>  <span class="hljs-function"><span class="hljs-title">isFunction</span>(<span class="hljs-params">param</span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> param === <span class="hljs-string">&quot;function&quot;</span><br>  &#125;<br><br>  <span class="hljs-function"><span class="hljs-title">then</span>(<span class="hljs-params">onFulfilled,onRejected</span>)</span>&#123;<br>    <span class="hljs-keyword">const</span> realOnFulfilled = <span class="hljs-built_in">this</span>.isFunction(onFulfilled) ? onFulfilled:<span class="hljs-function">(<span class="hljs-params">value</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">return</span> value;<br>    &#125;<br><br>    <span class="hljs-keyword">const</span> realOnRejected = <span class="hljs-built_in">this</span>.isFunction(onRejected) ? onRejected:<span class="hljs-function">(<span class="hljs-params">reason</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">throw</span> reason;<br>    &#125;<br>    <span class="hljs-keyword">const</span> promise2 = <span class="hljs-keyword">new</span> MyPromise(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">switch</span>(<span class="hljs-built_in">this</span>.status)&#123;<br>        <span class="hljs-keyword">case</span> FULFILLED:<br>          realOnFulfilled();<br>          <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> REJECTED:<br>          realOnRejected();<br>          <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> PENDING:<br>          <span class="hljs-built_in">this</span>.FULFILLED_CALLBACK_LIST.push(realOnFulfilled);<br>          <span class="hljs-built_in">this</span>.REJECTED_CALLBACK_LIST.push(realOnRejected);<br>      &#125;<br>    &#125;);<br>    <span class="hljs-keyword">return</span> promise2;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ¥ä¸‹æ¥åœ¨ status å˜åŒ–çš„æ—¶å€™æ‰§è¡Œæ‰€æœ‰çš„å›æ‰ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyPromise</span></span>&#123;<br>  FULFILLED_CALLBACK_LIST = [];<br>  REJECTED_CALLBACK_LIST = [];<br>  _status=PENDING;<br><br>  <span class="hljs-keyword">get</span> <span class="hljs-title">status</span>()&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>._status;<br>  &#125;<br><br>  <span class="hljs-keyword">set</span> <span class="hljs-title">status</span>(<span class="hljs-params">newStatus</span>)&#123;<br>    <span class="hljs-built_in">this</span>._status = newStatus;<br>    <span class="hljs-keyword">switch</span>(newStatus)&#123;<br>      <span class="hljs-keyword">case</span> FULFILLED:<br>        <span class="hljs-built_in">this</span>.FULFILLED_CALLBACK_LIST.forEach(<span class="hljs-function"><span class="hljs-params">callback</span>=&gt;</span>&#123;<br>          callback(<span class="hljs-built_in">this</span>.value);<br>        &#125;)<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> REJECTED:<br>        <span class="hljs-built_in">this</span>.REJECTED_CALLBACK_LIST.forEach(<span class="hljs-function"><span class="hljs-params">callback</span>=&gt;</span>&#123;<br>          callback(<span class="hljs-built_in">this</span>.reason);<br>        &#125;)<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>  &#125;<br><br><br>  <span class="hljs-comment">// çœç•¥</span><br><br>  <span class="hljs-function"><span class="hljs-title">isFunction</span>(<span class="hljs-params">param</span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> param === <span class="hljs-string">&quot;function&quot;</span><br>  &#125;<br><br>  <span class="hljs-function"><span class="hljs-title">then</span>(<span class="hljs-params">onFulfilled,onRejected</span>)</span>&#123;<br>    <span class="hljs-keyword">const</span> realOnFulfilled = <span class="hljs-built_in">this</span>.isFunction(onFulfilled) ? onFulfilled:<span class="hljs-function">(<span class="hljs-params">value</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">return</span> value;<br>    &#125;<br><br>    <span class="hljs-keyword">const</span> realOnRejected = <span class="hljs-built_in">this</span>.isFunction(onRejected) ? onRejected:<span class="hljs-function">(<span class="hljs-params">reason</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">throw</span> reason;<br>    &#125;<br>    <span class="hljs-keyword">const</span> promise2 = <span class="hljs-keyword">new</span> MyPromise(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">switch</span>(<span class="hljs-built_in">this</span>.status)&#123;<br>        <span class="hljs-keyword">case</span> FULFILLED:<br>          realOnFulfilled();<br>          <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> REJECTED:<br>          realOnRejected();<br>          <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> PENDING:<br>          <span class="hljs-built_in">this</span>.FULFILLED_CALLBACK_LIST.push(realOnFulfilled);<br>          <span class="hljs-built_in">this</span>.REJECTED_CALLBACK_LIST.push(realOnRejected);<br>      &#125;<br>    &#125;);<br>    <span class="hljs-keyword">return</span> promise2;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å¦‚æœ then ä¸­çš„ onFulfilled/onRejected æŠ›å‡ºå¼‚å¸¸äº†ï¼Œåˆ™ promise2 ä¸èƒ½è¢«æ‰§è¡Œå¹¶ä¸”è¿”å› e</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyPromise</span></span>&#123;<br>  <span class="hljs-comment">// çœç•¥</span><br><br>  <span class="hljs-function"><span class="hljs-title">isFunction</span>(<span class="hljs-params">param</span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> param === <span class="hljs-string">&quot;function&quot;</span><br>  &#125;<br><br>  <span class="hljs-function"><span class="hljs-title">then</span>(<span class="hljs-params">onFulfilled,onRejected</span>)</span>&#123;<br>    <span class="hljs-keyword">const</span> realOnFulfilled = <span class="hljs-built_in">this</span>.isFunction(onFulfilled) ? onFulfilled:<span class="hljs-function">(<span class="hljs-params">value</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">return</span> value;<br>    &#125;<br><br>    <span class="hljs-keyword">const</span> realOnRejected = <span class="hljs-built_in">this</span>.isFunction(onRejected) ? onRejected:<span class="hljs-function">(<span class="hljs-params">reason</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">throw</span> reason;<br>    &#125;<br>    <span class="hljs-keyword">const</span> promise2 = <span class="hljs-keyword">new</span> MyPromise(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">const</span> fulfilledMicrotask = <span class="hljs-function">()=&gt;</span>&#123;<br>        <span class="hljs-keyword">try</span>&#123;<br>          realOnFulfilled(<span class="hljs-built_in">this</span>.value);<br>        &#125;<span class="hljs-keyword">catch</span>(e)&#123;<br>          reject(e)<br>        &#125;<br>      &#125;<br><br>      <span class="hljs-keyword">const</span> rejectedMicrotask = <span class="hljs-function">()=&gt;</span>&#123;<br>        <span class="hljs-keyword">try</span>&#123;<br>          realOnRejected(<span class="hljs-built_in">this</span>.reason);<br>        &#125;<span class="hljs-keyword">catch</span>(e)&#123;<br>          reject(e);<br>        &#125;<br>      &#125;<br>      <span class="hljs-keyword">switch</span>(<span class="hljs-built_in">this</span>.status)&#123;<br>        <span class="hljs-keyword">case</span> FULFILLED:<br>          fulfilledMicrotask();<br>          <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> REJECTED:<br>          rejectedMicrotask();<br>          <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> PENDING:<br>          <span class="hljs-built_in">this</span>.FULFILLED_CALLBACK_LIST.push(fulfilledMicrotask);<br>          <span class="hljs-built_in">this</span>.REJECTED_CALLBACK_LIST.push(rejectedMicrotask);<br>          <span class="hljs-keyword">break</span>;<br>      &#125;<br>    &#125;);<br>    <span class="hljs-keyword">return</span> promise2;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å¦‚æœ onFulfilled/onRejected è¿”å›å€¼æ˜¯ Xï¼Œé‚£ä¹ˆè¿è¡Œ resolvePromise</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyPromise</span></span>&#123;<br>  <span class="hljs-comment">// çœç•¥</span><br><br>  <span class="hljs-function"><span class="hljs-title">isFunction</span>(<span class="hljs-params">param</span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> param === <span class="hljs-string">&quot;function&quot;</span><br>  &#125;<br><br>  <span class="hljs-function"><span class="hljs-title">then</span>(<span class="hljs-params">onFulfilled,onRejected</span>)</span>&#123;<br>    <span class="hljs-keyword">const</span> realOnFulfilled = <span class="hljs-built_in">this</span>.isFunction(onFulfilled) ? onFulfilled:<span class="hljs-function">(<span class="hljs-params">value</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">return</span> value;<br>    &#125;<br><br>    <span class="hljs-keyword">const</span> realOnRejected = <span class="hljs-built_in">this</span>.isFunction(onRejected) ? onRejected:<span class="hljs-function">(<span class="hljs-params">reason</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">throw</span> reason;<br>    &#125;<br>    <span class="hljs-keyword">const</span> promise2 = <span class="hljs-keyword">new</span> MyPromise(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">const</span> fulfilledMicrotask = <span class="hljs-function">()=&gt;</span>&#123;<br>        <span class="hljs-keyword">try</span>&#123;<br>          <span class="hljs-keyword">const</span> x = realOnFulfilled(<span class="hljs-built_in">this</span>.value);<br>          <span class="hljs-built_in">this</span>.resolvePromise(promise2,x,resolve,reject)<br>        &#125;<span class="hljs-keyword">catch</span>(e)&#123;<br>          reject(e)<br>        &#125;<br>      &#125;<br><br>      <span class="hljs-keyword">const</span> rejectedMicrotask = <span class="hljs-function">()=&gt;</span>&#123;<br>        <span class="hljs-keyword">try</span>&#123;<br>          <span class="hljs-keyword">const</span> x = realOnRejected(<span class="hljs-built_in">this</span>.reason);<br>          <span class="hljs-built_in">this</span>.resolvePromise(promise2,x,resolve,reject)<br>        &#125;<span class="hljs-keyword">catch</span>(e)&#123;<br>          reject(e);<br>        &#125;<br>      &#125;<br>      <span class="hljs-keyword">switch</span>(<span class="hljs-built_in">this</span>.status)&#123;<br>        <span class="hljs-keyword">case</span> FULFILLED:<br>          fulfilledMicrotask();<br>          <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> REJECTED:<br>          rejectedMicrotask();<br>          <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> PENDING:<br>          <span class="hljs-built_in">this</span>.FULFILLED_CALLBACK_LIST.push(fulfilledMicrotask);<br>          <span class="hljs-built_in">this</span>.REJECTED_CALLBACK_LIST.push(rejectedMicrotask);<br>          <span class="hljs-keyword">break</span>;<br>      &#125;<br>    &#125;);<br>    <span class="hljs-keyword">return</span> promise2;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ¥ä¸‹æ¥å®Œæˆ resolvePromise æ–¹æ³•ã€‚</p><p>æ ¹æ®è§„èŒƒï¼Œå¦‚æœ resolvePromise ä¸­ promise2 å’Œ x æ˜¯å…¨ç­‰ï¼Œåˆ™ç”¨ TypeError ä½œä¸º reject çš„å‚æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyPromise</span></span>&#123;<br>  <span class="hljs-comment">//çœç•¥</span><br><br>  <span class="hljs-function"><span class="hljs-title">resolvePromise</span>(<span class="hljs-params">promise2,x,resolve,reject</span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(promise2 === x)&#123;<br>      <span class="hljs-keyword">return</span> reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&quot;promise2å’Œxä¸èƒ½ç›¸åŒ&quot;</span>))<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å¦‚æœ x æ˜¯ä¸€ä¸ª promiseï¼Œåˆ™é‡‡ç”¨å®ƒçš„çŠ¶æ€ã€‚<br>å¦‚æœ x æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–è€…å‡½æ•°ï¼Œè®© then=x.thenï¼Œå¦‚æœæ­¤æ—¶æŠ›å‡ºå¼‚å¸¸ eï¼Œåˆ™ä½¿ç”¨ e ä½œä¸º reject å‚æ•°ã€‚<br>å¦‚æœ then æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨ x è°ƒç”¨(call)å®ƒï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ resolvePromiseï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ rejectPromiseã€‚å¦‚æœåŒæ—¶è°ƒç”¨ resolvePromise å’Œ rejectPromiseï¼Œæˆ–è€…å¤šæ¬¡è°ƒç”¨åŒä¸€ä¸ªå‚æ•°ï¼Œä¿è¯ç¬¬ä¸€ä¸ªè¢«è°ƒç”¨çš„æœ‰æ•ˆï¼Œåç»­çš„è°ƒç”¨å°†è¢«å¿½ç•¥ã€‚å¦‚æœ then ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåˆ™ç”¨ resolve(x)ã€‚<br>å¦‚æœ x ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–å‡½æ•°ï¼Œåˆ™ç”¨ resolve(x)ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyPromise</span></span>&#123;<br>  <span class="hljs-comment">//çœç•¥</span><br><br>  <span class="hljs-function"><span class="hljs-title">resolvePromise</span>(<span class="hljs-params">promise2,x,resolve,reject</span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(promise2 === x)&#123;<br>      <span class="hljs-keyword">return</span> reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&quot;promise2å’Œxä¸èƒ½ç›¸åŒ&quot;</span>))<br>    &#125;<br><br>    <span class="hljs-comment">// å¦‚æœ x æ˜¯ä¸€ä¸ª promiseï¼Œåˆ™é‡‡ç”¨å®ƒçš„çŠ¶æ€ã€‚</span><br>    <span class="hljs-keyword">if</span>(x <span class="hljs-keyword">instanceof</span> MyPromise)&#123;<br>      queueMicrotask(<span class="hljs-function">()=&gt;</span>&#123;<br>        x.then(<span class="hljs-function">(<span class="hljs-params">y</span>)=&gt;</span>&#123;<br>        <span class="hljs-built_in">this</span>.resolvePromise(promise2,y,resolve,reject);<br>        &#125;,reject)<br>      &#125;)<br>    &#125;<br>    <span class="hljs-comment">// å¦‚æœ x æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–å‡½æ•°</span><br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.isObject(x) || <span class="hljs-built_in">this</span>.isFunction(x))&#123;<br>      <span class="hljs-comment">// typeof nullä¼šè®¤ä¸ºnullä¸ºobject,åˆ™ä½¿ç”¨xç›´æ¥resolve</span><br>      <span class="hljs-keyword">if</span>(x === <span class="hljs-literal">null</span>)&#123;<br>        <span class="hljs-keyword">return</span> resolve(x);<br>      &#125;<br><br>      <span class="hljs-comment">// å¦‚æœ x æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–è€…å‡½æ•°ï¼Œè®© then=x.thenï¼Œå¦‚æœæ­¤æ—¶æŠ›å‡ºå¼‚å¸¸ eï¼Œåˆ™ä½¿ç”¨ e ä½œä¸º reject å‚æ•°ã€‚</span><br>      <span class="hljs-keyword">let</span> then = <span class="hljs-literal">null</span>;<br>      <span class="hljs-keyword">try</span>&#123;<br>        then = x.then<br>      &#125;<span class="hljs-keyword">catch</span>(e)&#123;<br>        <span class="hljs-keyword">return</span> reject(e);<br>      &#125;<br><br>      <span class="hljs-comment">// å¦‚æœ then æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨ x è°ƒç”¨å®ƒï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ resolvePromiseï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ rejectPromiseã€‚</span><br>      <span class="hljs-keyword">if</span>(isFunction(then))&#123;<br>        <span class="hljs-comment">// ä½¿ç”¨calledæ ‡è®°ï¼Œç¡®ä¿åªè°ƒç”¨ä¸€æ¬¡ã€‚</span><br>        <span class="hljs-keyword">let</span> called = <span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">try</span>&#123;<br>          then.call(x,<span class="hljs-function">(<span class="hljs-params">value</span>)=&gt;</span>&#123;<br>            <span class="hljs-keyword">if</span>(called) <span class="hljs-keyword">return</span>;<br>            called = <span class="hljs-literal">true</span>;<br>            <span class="hljs-built_in">this</span>.resolvePromise(promise2,value,resolve,reject);<br>          &#125;,<span class="hljs-function">(<span class="hljs-params">reason</span>)=&gt;</span>&#123;<br>            <span class="hljs-keyword">if</span>(called) <span class="hljs-keyword">return</span>;<br>            called = <span class="hljs-literal">true</span>;<br>            reject(reason)<br>          &#125;)<br>        &#125;<span class="hljs-keyword">catch</span>(e)&#123;<br>          <span class="hljs-keyword">if</span>(called) <span class="hljs-keyword">return</span>;<br>          <span class="hljs-keyword">return</span> reject(e)<br>        &#125;<br>      &#125;<br>      <span class="hljs-comment">// å¦‚æœ then ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåˆ™ç”¨resolve(x)</span><br>      <span class="hljs-keyword">else</span>&#123;<br>        resolve(x);<br>      &#125;<br><br>    &#125;<br>    <span class="hljs-comment">// å¦‚æœ x ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–å‡½æ•°ï¼Œåˆ™ç”¨resolve(x)ã€‚</span><br>    <span class="hljs-keyword">else</span>&#123;<br>      resolve(x);<br>    &#125;<br><br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¿™ä¸ªæ—¶å€™å…¶å®å·²ç»å¤§æ¦‚å†™å®Œäº†ã€‚</p><p>ä½†æ˜¯å‘¢ï¼ŒonFulfilled å’Œ onRejected éƒ½æ˜¯å¾®ä»»åŠ¡ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»™ä»–ä»¬å†åŒ…è£…ä¸€å±‚</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyPromise</span></span>&#123;<br>  <span class="hljs-comment">//çœç•¥</span><br><br>  <span class="hljs-function"><span class="hljs-title">then</span>(<span class="hljs-params">onFulfilled,onRejected</span>)</span>&#123;<br>    <span class="hljs-keyword">const</span> realOnFulfilled = <span class="hljs-built_in">this</span>.isFunction(onFulfilled) ? onFulfilled:<span class="hljs-function">(<span class="hljs-params">value</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">return</span> value;<br>    &#125;<br><br>    <span class="hljs-keyword">const</span> realOnRejected = <span class="hljs-built_in">this</span>.isFunction(onRejected) ? onRejected:<span class="hljs-function">(<span class="hljs-params">reason</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">throw</span> reason;<br>    &#125;<br><br>    <span class="hljs-keyword">const</span> promise2 = <span class="hljs-keyword">new</span> MyPromise(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">const</span> fulfilledMicrotask = <span class="hljs-function">()=&gt;</span>&#123;<br>        queueMicrotask(<span class="hljs-function">()=&gt;</span>&#123;<br>          <span class="hljs-keyword">try</span>&#123;<br>            <span class="hljs-keyword">const</span> x = realOnFulfilled(<span class="hljs-built_in">this</span>.value);<br>            <span class="hljs-built_in">this</span>.resolvePromise(promise2,x,resolve,reject);<br>          &#125;<span class="hljs-keyword">catch</span>(e)&#123;<br>            reject(e)<br>          &#125;<br>        &#125;)<br>      &#125;<br><br>      <span class="hljs-keyword">const</span> rejectedMicrotask = <span class="hljs-function">()=&gt;</span>&#123;<br>        queueMicrotask(<span class="hljs-function">()=&gt;</span>&#123;<br>          <span class="hljs-keyword">try</span>&#123;<br>            <span class="hljs-keyword">const</span> x = realOnRejected(<span class="hljs-built_in">this</span>,reason);<br>            <span class="hljs-built_in">this</span>.resolvePromise(promise2,x,resolve,reject);<br>          &#125;<span class="hljs-keyword">catch</span>(e)&#123;<br>            reject(e);<br>          &#125;<br>        &#125;)<br>      &#125;<br><br>      <span class="hljs-comment">// çœç•¥</span><br>    &#125;)<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å¥½äº† è¿™å°±å·²ç»å†™å®Œäº†ã€‚å®Œæ•´ä»£ç å¯è§<a href="https://github.com/AruSeito/daily-practice/blob/main/others/Promise/promise.js">github</a></p><p>ä½¿ç”¨ promises-aplus-tests è·‘äº†ä¸€ä¸‹æµ‹è¯•ï¼Œå…¨éƒ¨é€šè¿‡ã€‚</p><p>åœ¨æ¥æ›´æ–°äº›æ‰‹å†™çš„å…¶ä»– API</p><p>æˆ‘ä»¬åœ¨ä½¿ç”¨ Promise çš„æ—¶å€™ç»å¸¸ä¼šç”¨åˆ° Promise.resolve()/Promise.reject()è¿™ç§ç”¨æ³•ï¼Œä½†æ˜¯ä»¥ä¸Šå†™æ³•å¹¶ä¸æ”¯æŒç›´æ¥ä½¿ç”¨ MyPromise.resolve/rejectã€‚è¿™ç§æ— éœ€å®ä¾‹å³å¯è°ƒç”¨çš„æ–¹æ³•æˆ‘ä»¬ç§°ä¹‹ä¸ºé™æ€æ–¹æ³•ã€‚</p><p>Promise.resolve()æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª Promise ä¸”çŠ¶æ€ä¸º fulfilledã€‚Promise.reject()è¿”å›ä¸€ä¸ª Promise ä¸”çŠ¶æ€ä¸º rejectedã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyPromise</span></span>&#123;<br>  <span class="hljs-comment">// çœç•¥</span><br><br>  <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-title">resolve</span>(<span class="hljs-params">value</span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(value <span class="hljs-keyword">instanceof</span> MyPromise)&#123;<br>      <span class="hljs-keyword">return</span> value;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> MyPromise(<span class="hljs-function">(<span class="hljs-params">resolve</span>)=&gt;</span>&#123;<br>      resolve(value);<br>    &#125;)<br>  &#125;<br><br>  <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-title">reject</span>(<span class="hljs-params">reason</span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> MyPromise(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br>      reject(reason);<br>    &#125;)<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>race æ–¹æ³•ï¼šå°†å¤šä¸ª Promise å®ä¾‹ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ã€‚åªè¦ p1ã€p2ã€p3 ä¹‹ä¸­æœ‰ä¸€ä¸ªå®ä¾‹ç‡å…ˆæ”¹å˜çŠ¶æ€ï¼Œp çš„çŠ¶æ€å°±è·Ÿç€æ”¹å˜ã€‚é‚£ä¸ªç‡å…ˆæ”¹å˜çš„ Promise å®ä¾‹çš„è¿”å›å€¼ï¼Œå°±ä¼ é€’ç»™ p çš„å›è°ƒå‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyPromise</span></span>&#123;<br><br>  <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-title">race</span>(<span class="hljs-params">promiseList</span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> MyPromise(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">const</span> length = promiseList.length;<br><br>      <span class="hljs-keyword">if</span>(length === <span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-keyword">return</span> resolve();<br>      &#125;<br><br>      promiseList.forEach(<span class="hljs-function">(<span class="hljs-params">promise</span>)=&gt;</span>&#123;<br>        MyPromise.resolve(promise).then(<span class="hljs-function">(<span class="hljs-params">value</span>)=&gt;</span>&#123;<br>          <span class="hljs-keyword">return</span> resolve(value)<br>        &#125;,<span class="hljs-function">(<span class="hljs-params">reason</span>)=&gt;</span>&#123;<br>          <span class="hljs-keyword">return</span> reject(reason)<br>        &#125;)<br>      &#125;)<br>    &#125;)<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
      <category>æ‰‹æ’•æºç </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Promise</tag>
      
      <tag>æ‰‹æ’•ä»£ç </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>(éšæ‰‹è®°å½•)mockæ–¹æ¡ˆ-jsonServer</title>
    <link href="/article/5adf6b08/"/>
    <url>/article/5adf6b08/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åˆè¿‡äº†å¥½ä¹…æ²¡æ›´æ–°åšå®¢äº†ï¼Œå‰æ®µæ—¶é—´å› ä¸ºå·¥ä½œå¤ªå¿™å†åŠ ä¸Šå­¦ä¹ åˆ°çš„éƒ½æ˜¯é›¶æ•£çš„çŸ¥è¯†ç‚¹ï¼Œæ²¡æœ‰æ›´æ–°åšå®¢çš„æƒ³æ³•ã€‚ä»”ç»†æƒ³æƒ³ï¼Œå­¦ä¹ çš„è¿‡ç¨‹ä¸å°±æ˜¯æ— æ•°ä¸ªå°çš„çŸ¥è¯†ç‚¹å †å èµ·æ¥çš„å—ã€‚</p><p>æ‰€ä»¥åˆé‡æ‹¾åšå®¢ï¼Œå°†æ¯å¤©å­¦åˆ°çš„ä¸€ç‚¹ç‚¹å°ä¸œè¥¿éƒ½è®°å½•ä¸‹æ¥ã€‚</p><h2 id="JSON-SERVER"><a href="#JSON-SERVER" class="headerlink" title="JSON-SERVER"></a>JSON-SERVER</h2><p>ä¹‹å‰åœ¨ä¸Šä¸€å®¶å…¬å¸å·¥ä½œçš„æ—¶å€™ï¼Œmock æ–¹æ¡ˆé‡‡ç”¨çš„æ˜¯ Easy-mock è¿™ç§ API æ‰˜ç®¡å¹³å°ï¼Œåç«¯ç”Ÿæˆ swagger,ç„¶åå‰ç«¯å¼€å‘å†å°† swagger åŒæ­¥åˆ°æ‰˜ç®¡å¹³å°ä¸Šã€‚æœ¬åœ°ä½¿ç”¨ express çš„ http-proxy ä¸­é—´ä»¶è¿›è¡ŒæŒ‡å®š API çš„æ‹¦æˆªè½¬å‘ã€‚</p><p>ä½†æ˜¯åœ¨è¿™å®¶å…¬å¸å¹¶æ²¡æœ‰å…³äº MOCK çš„æ–¹æ¡ˆï¼Œåªèƒ½è¿›è¡Œå‰ç«¯å†™æ­»æ•°æ®ç„¶åè¿›è¡Œæ¨¡æ‹Ÿï¼Œæ¯æ¬¡è¦æµ‹è¯•æ—¶éƒ½éœ€è¦å†å»æ‰‹åŠ¨æ¸…é™¤æ•°æ®ï¼Œéš”äº†å¥½ä¹…çš„å¯èƒ½è¿˜ä¼šæœ‰æ¼æ‰çš„åœ°æ–¹ã€‚</p><p>æ‰€ä»¥å­¦ä¹ äº†ä¸€ä¸‹ mock çš„æ–¹æ¡ˆã€‚</p><p>æœ¬æ‰“ç®—å®ç°ä¸€ä¸ªè·Ÿä¸Šä¸€å®¶å…¬å¸çš„æ–¹æ¡ˆï¼Œåœ¨ä»”ç»†æŸ¥çœ‹äº†ç°å…¬å¸çš„ä»£ç ç»“æ„ï¼Œå‘ç°å¹¶ä¸é€‚åˆæ¥å…¥è¯¥ç§æ–¹æ¡ˆï¼š</p><p>ç°å…¬å¸æ²¡æœ‰ node å±‚ï¼Œéƒ½æ˜¯å‰ç«¯é™æ€é¡µé¢ç›´æ¥è¯·æ±‚åç«¯ï¼Œè·¨åŸŸç”±åç«¯æ¥è¿›è¡Œå¤„ç†ï¼Œå¦‚æœå•å•ä¸ºäº†ä¸€ä¸ªæ¥å£è½¬å‘æ¥å…¥ node å±‚ï¼Œæœ‰ç‚¹æ— æ„ä¹‰ï¼Œæ‰€ä»¥æ”¾å¼ƒäº†è¯¥ç§æ–¹æ¡ˆã€‚</p><p>é‡‡ç”¨äº† JSON-SERVER çš„æ–¹æ¡ˆã€‚</p><p>ä½†æ˜¯ JSON-SERVER æ›´å¤šçš„æ˜¯é€‚åˆå¤„ç†ç¬¦åˆ REST API çš„ï¼Œæ€»æ˜¯èƒ½é‡åˆ°ä¸€äº›ä¸ç¬¦åˆ REST API çš„ã€‚</p><p>è¿™ä¸ªæ—¶å€™éœ€è¦å†™ä¸­é—´ä»¶ã€‚çœ‹ Demoï¼Œå¾ˆç®€å•ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs Javascript"><span class="hljs-comment">// middleWare Demo</span><br><span class="hljs-built_in">module</span>.exports = <span class="hljs-function">(<span class="hljs-params">req,res,next</span>)=&gt;</span>&#123;<br>  <span class="hljs-keyword">if</span>(req.method === <span class="hljs-string">&quot;POST&quot;</span> &amp;&amp; req.path === <span class="hljs-string">&quot;/login&quot;</span>)&#123;<br>    <span class="hljs-keyword">if</span>(req.body.username===<span class="hljs-string">&quot;aruseito&quot;</span> &amp;&amp; req.body.password === <span class="hljs-string">&quot;123456&quot;</span>)&#123;<br>      <span class="hljs-keyword">return</span> res.status(<span class="hljs-number">200</span>).json(&#123;<br>        <span class="hljs-attr">user</span>:&#123;<br>          <span class="hljs-attr">token</span>:<span class="hljs-string">&quot;123456&quot;</span><br>        &#125;<br>      &#125;)<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>      <span class="hljs-keyword">return</span> res.status(<span class="hljs-number">500</span>).json(&#123;<br>        <span class="hljs-attr">message</span>:<span class="hljs-string">&quot;è´¦å·æˆ–è€…å¯†ç é”™è¯¯&quot;</span><br>      &#125;)<br>    &#125;<br>  &#125;<br>  next();<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç„¶ååªéœ€è¦åœ¨å¯åŠ¨ json-server çš„æ—¶å€™åŠ ä¸Š<code>--middlewraes middleware.js</code>å³å¯ã€‚å¦‚ï¼š<code>json-server __json_server_mock__/db.json --watch --port 3001 --middlewares __json_server_mock__/middleware.js</code>ã€‚</p><p>ä½†æ˜¯è¿™ç§æ–¹æ¡ˆè¿˜æ˜¯é¿å…ä¸äº†åœ¨ä¸Šçº¿å‰è¦ä¿®æ”¹æ¥å£åœ°å€çš„é—®é¢˜ã€‚æ‰€ä»¥å¾ˆå¿«å°±è¢«æˆ‘æ”¾å¼ƒäº†ã€‚</p><h2 id="æœ€ç»ˆæ–¹æ¡ˆ"><a href="#æœ€ç»ˆæ–¹æ¡ˆ" class="headerlink" title="æœ€ç»ˆæ–¹æ¡ˆ"></a>æœ€ç»ˆæ–¹æ¡ˆ</h2><p>è€ƒè™‘åˆ°ä»¥ä¸Šå› ç´ ï¼Œæœ€ç»ˆé€‰æ‹©åœ¨æœ¬åœ°è‡ªå·±å¯ä¸€ä¸ª nodeï¼Œè¯»å–é…ç½®æ–‡ä»¶ï¼Œç”¨ http-proxy å°†æ¥å£æŒ‰éœ€è½¬å‘è¿‡å»ã€‚è·Ÿä¸Šä¸€å®¶å…¬å¸çš„æ–¹æ¡ˆä¸€æ ·ï¼Œåªæ˜¯æ²¡æœ‰å°†è¿™ä¸ªä¸€èµ·è€¦åˆåˆ°é¡¹ç›®ä¸­å»ã€‚</p><p>åˆè€ƒè™‘åˆ°æˆ‘å¸æœ‰å¤šç§å®¢æˆ·ç«¯ï¼Œå„ç«¯éƒ½ä¸ä¸€å®šæœ‰åˆé€‚çš„ MOCK å·¥å…·ï¼Œæ‰€ä»¥æ‰“ç®—å°†è¿™å±‚ node ä½¿ç”¨ Electron åŒ…è£…èµ·æ¥ï¼Œæä¸ªå›¾å½¢åŒ–ç•Œé¢ï¼Œè®©å„ç«¯éƒ½æ–¹ä¾¿ä½¿ç”¨ã€‚</p><p>ç›®å‰è¿˜åœ¨ç ”ç©¶ Electron æ€ä¹ˆæã€‚ã€‚ã€‚åªæ˜¯åˆšæœ‰åˆæ­¥æƒ³æ³•ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯å·¥ç¨‹åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å·¥ç¨‹åŒ–</tag>
      
      <tag>mock</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¼€ç€é£æœºä¿®å¼•æ“---çƒ­æ›´æ–°</title>
    <link href="/article/57ff1b88/"/>
    <url>/article/57ff1b88/</url>
    
    <content type="html"><![CDATA[<p>åœ¨è‡ªå·±åˆšå¼€å§‹å­¦ä¹ å‰ç«¯çš„æ—¶å€™ï¼Œæ¯æ¬¡ä¿®æ”¹ä¸ªæ–°æ ·å¼éƒ½è¦æ‰‹åŠ¨åˆ·æ–°ä¸€ä¸‹é¡µé¢ã€‚éšç€è‡ªå·±å¯¹å‰ç«¯çš„äº†è§£ï¼Œå¼€å§‹ä½¿ç”¨äº† live reload æ’ä»¶è¿›è¡Œä»£æ›¿ï¼Œæ¯æ¬¡æ›´æ”¹æ–‡ä»¶åï¼Œæµè§ˆå™¨éƒ½ä¼šä»£æ›¿äººå·¥æ¥åˆ·æ–°é¡µé¢ã€‚éšç€åé¢çš„å­¦ä¹  Reactï¼Œå‘ç°ä½¿ç”¨ CRA åˆ›å»ºçš„ä¸œè¥¿å¯ä»¥åœ¨å¼€ç€æœåŠ¡çš„æ—¶å€™è¿›è¡Œä¸åˆ·æ–°å°±æ›¿æ¢å†…å®¹ã€‚</p><h2 id="live-reload"><a href="#live-reload" class="headerlink" title="live reload"></a>live reload</h2><p>ä½¿ç”¨ webpack çš„ dev-server æ¨¡æ‹Ÿå½“å¹´çš„ nginx+live-reload æ’ä»¶<br>webpack é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> HtmlWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-attr">entry</span>: <span class="hljs-string">&quot;./src/index.js&quot;</span>,<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&quot;development&quot;</span>,<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> HtmlWebpackPlugin(&#123;<br>      <span class="hljs-attr">title</span>: <span class="hljs-string">&quot;Development&quot;</span>,<br>    &#125;),<br>  ],<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;[name].bundle.js&quot;</span>,<br>    <span class="hljs-attr">path</span>: path.resolve(__dirname, <span class="hljs-string">&quot;dist&quot;</span>),<br>    <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  <span class="hljs-attr">devServer</span>: &#123;<br>    <span class="hljs-attr">contentBase</span>: <span class="hljs-string">&quot;./dist&quot;</span>,<br>    <span class="hljs-attr">open</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>&#125;;<br></code></pre></div></td></tr></table></figure><p>æ‰“å¼€é¡µé¢åï¼Œæ‰“å¼€æ§åˆ¶å°çš„ network æ ‡ç­¾å¯ä»¥çœ‹åˆ°å…¶ä¸­æœ‰ä¸€æ¡æ˜¯ websocket çš„è¿æ¥ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/websocket.png" alt="websocket"></p><p>æŸ¥çœ‹è¿™æ¡è®°å½•ï¼Œå‘ç°å†…éƒ¨å†™äº†è¦è¿›è¡Œçš„æ“ä½œï¼Œä»¥åŠæ›´æ–°çš„æ–‡ä»¶ hash å€¼ï¼ˆå¯ä»¥ä¸ä¸Šå›¾ä¸­æ–‡ä»¶çš„ hash å¯¹æ¯”ä¸€ä¸‹ï¼Œæ˜¯å®Œå…¨ä¸€è‡´çš„ï¼‰ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/websocket-content.png" alt="websocketå†…å®¹"></p><p>é€šè¿‡è¿™ä¸ª websocket é“¾æ¥ï¼Œå°±å¯ä»¥ä½¿æ‰“å¼€çš„ç½‘é¡µå’Œæœ¬åœ°æœåŠ¡é—´å»ºç«‹æŒä¹…åŒ–çš„é€šä¿¡ã€‚å½“æºä»£ç å‘ç”Ÿå˜æ›´æ—¶ï¼Œå°±é€šè¿‡ Socket é€šçŸ¥åˆ°æµè§ˆå™¨ï¼Œæµè§ˆå™¨åœ¨æ¥åˆ°é€šçŸ¥åä¼šè‡ªåŠ¨è§¦å‘é¡µé¢åˆ·æ–°ã€‚</p><p>è™½ç„¶è¿™æ ·ä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ã€‚é¡µé¢çš„åˆ·æ–°ä¼šå¯¼è‡´çŠ¶æ€ä¸¢å¤±ï¼šæ¯”å¦‚æˆ‘åœ¨æ ‡ä¸­å¡«å……å¥½çš„ä¸œè¥¿éœ€è¦å†é‡æ–°å¡«ã€‚</p><h2 id="Hot-Module-Replacement"><a href="#Hot-Module-Replacement" class="headerlink" title="Hot Module Replacement"></a>Hot Module Replacement</h2><p>å¼€å¯ webpack çš„çƒ­æ›´æ–°æ¨¡å—åŠŸèƒ½ï¼Œé…ç½®å¦‚ä¸‹</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-built_in">module</span>.exports = &#123;<br>  ...<br>  <span class="hljs-attr">devServer</span>: &#123;<br>    <span class="hljs-attr">contentBase</span>: <span class="hljs-string">&quot;./dist&quot;</span>,<br>    <span class="hljs-attr">hot</span>: <span class="hljs-literal">true</span><br>  &#125;,<br>  ...<br>&#125;;<br><br></code></pre></div></td></tr></table></figure><p>å¼€å¯æœåŠ¡åï¼Œä¿®æ”¹ä¸€ä¸ª CSS æ–‡ä»¶çœ‹çœ‹ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œwebsocket è¿™æ¡è®°å½•ä¸­å…ˆé€šçŸ¥äº†æµè§ˆå™¨æœ‰æ–‡ä»¶æ›´æ–°äº†ï¼Œé€šè¿‡æœåŠ¡ç«¯å¯ä»¥çœ‹å‡ºæ¥ï¼Œæ›´æ–°çš„ hash å¯ä»¥å¯¹ä¸Šã€‚</p><p>ä½†æ˜¯ä¸ºä»€ä¹ˆæ›´æ–°äº†<code>css</code>æ–‡ä»¶ï¼Œä»–è¿™é¢å´æ›´æ–°çš„æ˜¯ JS å‘¢ï¼Ÿå› ä¸ºåœ¨ä½¿ç”¨ webpack çš„è¿‡ç¨‹ä¸­ï¼Œwebpack å°† css çš„å†…å®¹åˆå¹¶åˆ°äº† js ä¸­ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/change-style.png" alt="ä¿®æ”¹styleæ–‡ä»¶å¼•èµ·çš„networkå˜åŒ–"></p><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/websocket-hot.png" alt="websocketå†…å®¹è¯¦ç»†"></p><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/server-log.png" alt="webpack-serverå†…å®¹"></p><p>éšåä»–è¯·æ±‚äº†åŸæ–‡ä»¶ï¼ˆå…¥å£æ–‡ä»¶ï¼Ÿï¼‰çš„ hash.hot.update.json è·å–è¦æ›´æ–°çš„æ¨¡å—ï¼Œç„¶åå†æ ¹æ® json å†…è¿”å›çš„æ¨¡å—å†…å®¹å»è¯·æ±‚æ›´æ–°åçš„æ¨¡å—ã€‚</p><p>è¿™ä¹Ÿå¯ä»¥è§£é‡Šä¸ºä»€ä¹ˆæ›´æ–° CSS æ˜¯åŠ è½½æ¨¡å—ï¼Œä½†æ˜¯æ›´æ–° JS æ–‡ä»¶å´æ˜¯ reloadã€‚å› ä¸ºåŸæ–‡ä»¶ï¼ˆå…¥å£æ–‡ä»¶ï¼Ÿï¼‰çš„ hash å€¼å˜äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/hot-updateJs-content.png" alt="hot-updatejså†…å®¹"></p><p>è‡³æ­¤å¤§è‡´æµç¨‹å·²ç»æ˜ç™½äº†ï¼Œç”»ä¸ªç®€å•çš„æµç¨‹å›¾çœ‹çœ‹å§</p><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/HMR-flow-chart.png" alt="çƒ­æ›´æ–°æµç¨‹å›¾"></p>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯å·¥ç¨‹åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>webpack</tag>
      
      <tag>çƒ­æ›´æ–°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Reduxçš„æœ€ä½³å®è·µ</title>
    <link href="/article/9fd9559e/"/>
    <url>/article/9fd9559e/</url>
    
    <content type="html"><![CDATA[<p>æœ¬ç‰ˆæœ¬ä¸ºä¸ªäººæœºå™¨ç¿»è¯‘+æ¸£æ¸£ç¿»è¯‘+ä¸ªäººç†è§£å†™æˆ<br>åŸç‰ˆè§<a href="https://redux.js.org/style-guide/style-guide#priority-a-rules-essential">Reduxçš„æœ€ä½³å®è·µå®˜æ–¹æ–‡æ¡£</a></p><h2 id="å¿…é¡»éµå®ˆçš„"><a href="#å¿…é¡»éµå®ˆçš„" class="headerlink" title="å¿…é¡»éµå®ˆçš„"></a>å¿…é¡»éµå®ˆçš„</h2><h3 id="ä¸è¦å˜å¼‚Stateã€‚"><a href="#ä¸è¦å˜å¼‚Stateã€‚" class="headerlink" title="ä¸è¦å˜å¼‚Stateã€‚"></a>ä¸è¦å˜å¼‚Stateã€‚</h3><p>ä¸æ”¹å˜ç°æœ‰stateï¼Œè€Œæ˜¯å»ä¿®æ”¹stateçš„å‰¯æœ¬ã€‚</p><p>å› ä¸ºstateå¯å˜æ˜¯å¯¼è‡´Reduxå‡ºç°BUGçš„æœ€å¸¸è§åŸå› ï¼Œè€Œä¸”è¿˜ä¼šç ´åRedux DevToolsä¸­çš„<code>time-travel debugging </code>åŠŸèƒ½</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-comment">// é”™è¯¯å®è·µ</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">todos</span>(<span class="hljs-params">state = [], action</span>) </span>&#123;<br>  <span class="hljs-keyword">switch</span> (action.type) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;ADD_TODO&#x27;</span>:<br>      <span class="hljs-comment">//stateçªå˜</span><br>      state.push(&#123;<br>        <span class="hljs-attr">text</span>: action.text,<br>        <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span><br>      &#125;)<br>      <span class="hljs-keyword">return</span> state<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;COMPLETE_TODO&#x27;</span>:<br>      <span class="hljs-comment">// state[action.index]çªå˜</span><br>      state[action.index].completed = <span class="hljs-literal">true</span><br>      <span class="hljs-keyword">return</span> state<br>    <span class="hljs-attr">default</span>:<br>      <span class="hljs-keyword">return</span> state<br>  &#125;<br>&#125;<br><span class="hljs-comment">// æœ€ä½³å®è·µ</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">todos</span>(<span class="hljs-params">state = [], action</span>) </span>&#123;<br>  <span class="hljs-keyword">switch</span> (action.type) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;ADD_TODO&#x27;</span>:<br>      <span class="hljs-comment">//è¿”å›ä¸€ä¸ªæ–°çš„å‰¯æœ¬</span><br>      <span class="hljs-keyword">return</span> [<br>        ...state,<br>        &#123;<br>          <span class="hljs-attr">text</span>: action.text,<br>          <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span><br>        &#125;<br>      ]<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;COMPLETE_TODO&#x27;</span>:<br>      <span class="hljs-keyword">return</span> state.map(<span class="hljs-function">(<span class="hljs-params">todo, index</span>) =&gt;</span> &#123;<br>        <span class="hljs-keyword">if</span> (index === action.index) &#123;<br>          <span class="hljs-comment">//è¿”å›ä¸€ä¸ªæ–°çš„å‰¯æœ¬</span><br>          <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.assign(&#123;&#125;, todo, &#123;<br>            <span class="hljs-attr">completed</span>: <span class="hljs-literal">true</span><br>          &#125;)<br>        &#125;<br>        <span class="hljs-keyword">return</span> todo<br>      &#125;)<br>    <span class="hljs-attr">default</span>:<br>      <span class="hljs-keyword">return</span> state<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="Reducerå†…ä¸èƒ½æœ‰å‰¯ä½œç”¨"><a href="#Reducerå†…ä¸èƒ½æœ‰å‰¯ä½œç”¨" class="headerlink" title="Reducerå†…ä¸èƒ½æœ‰å‰¯ä½œç”¨"></a>Reducerå†…ä¸èƒ½æœ‰å‰¯ä½œç”¨</h3><p>Reducer å‡½æ•°åº”è¯¥åªä¾èµ–äºå®ƒä»¬çš„çŠ¶æ€å’Œæ“ä½œå‚æ•°ï¼Œå¹¶ä¸”åº”è¯¥åªè®¡ç®—å’Œè¿”å›åŸºäºè¿™äº›å‚æ•°çš„æ–°çŠ¶æ€å€¼</p><p>è¿™ä¸ªè§„åˆ™çš„ç›®çš„æ˜¯ä¿è¯reduceråœ¨è¢«è°ƒç”¨æ—¶ä¼šè¡¨ç°å‡ºå¯é¢„æµ‹çš„è¡Œä¸ºã€‚ï¼ˆåˆå‡ºç°äº†å‡½æ•°å¼ç¼–ç¨‹å®ç°ï¼‰</p><h3 id="ä¸è¦åœ¨Stateå’ŒActionå†…æ”¾ä¸å¯åºåˆ—åŒ–ï¼ˆNon-Serializableï¼‰çš„å€¼"><a href="#ä¸è¦åœ¨Stateå’ŒActionå†…æ”¾ä¸å¯åºåˆ—åŒ–ï¼ˆNon-Serializableï¼‰çš„å€¼" class="headerlink" title="ä¸è¦åœ¨Stateå’ŒActionå†…æ”¾ä¸å¯åºåˆ—åŒ–ï¼ˆNon-Serializableï¼‰çš„å€¼"></a>ä¸è¦åœ¨Stateå’ŒActionå†…æ”¾ä¸å¯åºåˆ—åŒ–ï¼ˆNon-Serializableï¼‰çš„å€¼</h3><p>é¿å…å°†ä¸å¯<a href="https://zh.wikipedia.org/wiki/%E5%BA%8F%E5%88%97%E5%8C%96">åºåˆ—åŒ–</a>çš„å€¼(å¦‚ Promisesã€ Symbolsã€ Maps/setã€å‡½æ•°æˆ–ç±»å®ä¾‹)æ”¾å…¥åˆ° Redux store stateæˆ–dispatched actionsä¸­ã€‚è¿™ç¡®ä¿é€šè¿‡ Redux DevTools è¿›è¡Œè°ƒè¯•çš„åŠŸèƒ½èƒ½å¤ŸæŒ‰é¢„æœŸçš„æ–¹å¼å·¥ä½œã€‚å®ƒè¿˜å¯ä»¥ç¡®ä¿ç”¨æˆ·ç•Œé¢æŒ‰é¢„æœŸæ›´æ–°ã€‚</p><p>æˆ‘è§‰å¾—è¿™ä¸ªä¸»è¦æ˜¯ä¸ºäº†ä¿è¯ç¨‹åºçš„å¯é¢„è§æ€§ï¼Œåˆ‡åˆå‡½æ•°å¼ç¼–ç¨‹çš„æ€æƒ³ã€‚å¦‚æœä¸å¯åºåˆ—åŒ–çš„ä¸œè¥¿æ”¾è¿›å»ï¼Œè¿›è¡Œä¸€ç³»åˆ—æ“ä½œåï¼Œå¯èƒ½ä¼šå‡ºç°æ•°æ®ä¸¢å¤±ã€‚</p><h3 id="æ¯ä¸ªåº”ç”¨ç¨‹åºåªæœ‰ä¸€ä¸ª-Redux-Store"><a href="#æ¯ä¸ªåº”ç”¨ç¨‹åºåªæœ‰ä¸€ä¸ª-Redux-Store" class="headerlink" title="æ¯ä¸ªåº”ç”¨ç¨‹åºåªæœ‰ä¸€ä¸ª Redux Store"></a>æ¯ä¸ªåº”ç”¨ç¨‹åºåªæœ‰ä¸€ä¸ª Redux Store</h3><p>ä¸»è¦ä¸ºäº†çŠ¶æ€ç®¡ç†ã€è¿½è¸ªæ–¹ä¾¿ã€‚</p><h2 id="å¼ºçƒˆå»ºè®®"><a href="#å¼ºçƒˆå»ºè®®" class="headerlink" title="å¼ºçƒˆå»ºè®®"></a>å¼ºçƒˆå»ºè®®</h2><h3 id="ä½¿ç”¨-Redux-Toolkit-ç¼–å†™-Redux-é€»è¾‘"><a href="#ä½¿ç”¨-Redux-Toolkit-ç¼–å†™-Redux-é€»è¾‘" class="headerlink" title="ä½¿ç”¨ Redux Toolkit ç¼–å†™ Redux é€»è¾‘"></a>ä½¿ç”¨ Redux Toolkit ç¼–å†™ Redux é€»è¾‘</h3><p>å®ƒçš„åŠŸèƒ½å»ºç«‹åœ¨Reduxå»ºè®®çš„æœ€ä½³å®è·µä¸­ï¼ŒåŒ…æ‹¬å»ºç«‹å­˜å‚¨æ¥æ•æ‰å˜å¼‚å¹¶å¯ç”¨ Redux DevTools æ‰©å±•ï¼Œç”¨ Immer ç®€åŒ–ä¸å¯å˜æ›´æ–°é€»è¾‘ç­‰ã€‚ä½¿ç”¨ RTK å¯ä»¥ç®€åŒ–é€»è¾‘ï¼Œå¹¶ç¡®ä¿ä½ çš„åº”ç”¨ç¨‹åºè®¾ç½®ä¸ºè‰¯å¥½çš„é»˜è®¤è®¾ç½®ã€‚</p><h3 id="ä½¿ç”¨-Immer-ç¼–å†™ä¸å¯å˜æ›´æ–°"><a href="#ä½¿ç”¨-Immer-ç¼–å†™ä¸å¯å˜æ›´æ–°" class="headerlink" title="ä½¿ç”¨ Immer ç¼–å†™ä¸å¯å˜æ›´æ–°"></a>ä½¿ç”¨ Immer ç¼–å†™ä¸å¯å˜æ›´æ–°</h3><p>æ‰‹å·¥ç¼–å†™ä¸å¯å˜æ›´æ–°é€»è¾‘é€šå¸¸å¾ˆå›°éš¾ï¼Œå¹¶ä¸”å®¹æ˜“å‡ºé”™ã€‚Immer å…è®¸ä½¿ç”¨â€œå˜åŒ–â€é€»è¾‘ç¼–å†™æ›´ç®€å•çš„ä¸å¯å˜æ›´æ–°ï¼Œç”šè‡³å¯ä»¥å†»ç»“å¼€å‘ä¸­çš„çŠ¶æ€ï¼Œä»¥æ•æ‰åº”ç”¨ç¨‹åºä¸­å…¶ä»–åœ°æ–¹çš„å˜åŒ–ã€‚</p><p>é¢è¯•ä¸­é—®çš„ä¹Ÿåªæ˜¯å›ç­”å‡ºäº†è¯¥ç‚¹ï¼Œè¯¥ç‚¹ä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿ç»„ä»¶åœ¨åˆ¤æ–­æ˜¯å¦æ›´æ–°æ—¶ï¼Œè¿›è¡Œæµ…æ¯”è¾ƒã€‚</p><h3 id="å°†æœ‰ç›¸åŒç‰¹æ€§çš„æ–‡ä»¶æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹"><a href="#å°†æœ‰ç›¸åŒç‰¹æ€§çš„æ–‡ä»¶æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹" class="headerlink" title="å°†æœ‰ç›¸åŒç‰¹æ€§çš„æ–‡ä»¶æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹"></a>å°†æœ‰ç›¸åŒç‰¹æ€§çš„æ–‡ä»¶æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹</h3><p>ä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿ç»´æŠ¤ã€‚</p><h3 id="æŠŠå°½å¯èƒ½å¤šçš„é€»è¾‘æ”¾åœ¨Reducerä¸­"><a href="#æŠŠå°½å¯èƒ½å¤šçš„é€»è¾‘æ”¾åœ¨Reducerä¸­" class="headerlink" title="æŠŠå°½å¯èƒ½å¤šçš„é€»è¾‘æ”¾åœ¨Reducerä¸­"></a>æŠŠå°½å¯èƒ½å¤šçš„é€»è¾‘æ”¾åœ¨Reducerä¸­</h3><p>é‡å°†è®¡ç®—æ–°çŠ¶æ€çš„é€»è¾‘æ”¾åˆ°é€‚å½“çš„ reducer ä¸­ï¼Œè€Œä¸æ˜¯æ”¾åœ¨å‡†å¤‡å’Œåˆ†æ´¾æ“ä½œçš„ä»£ç ä¸­(å¦‚ click handler)ã€‚è¿™æœ‰åŠ©äºç¡®ä¿æ›´å¤šå®é™…çš„åº”ç”¨ç¨‹åºé€»è¾‘æ˜“äºæµ‹è¯•ï¼Œèƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°ä½¿ç”¨time-travelè°ƒè¯•ï¼Œå¹¶å¸®åŠ©é¿å…å¯èƒ½å¯¼è‡´å˜å¼‚å’Œé”™è¯¯çš„å¸¸è§é”™è¯¯ã€‚</p><p>åœ¨ä¸€äº›æœ‰æ•ˆçš„æƒ…å†µä¸‹ï¼Œåº”è¯¥é¦–å…ˆè®¡ç®—éƒ¨åˆ†æˆ–å…¨éƒ¨æ–°state(ä¾‹å¦‚ç”Ÿæˆå”¯ä¸€ ID) ï¼Œä½†æ˜¯åº”è¯¥å°†å…¶ä¿æŒåœ¨æœ€ä½é™åº¦ã€‚</p><h3 id="Reducer-åº”è¯¥æ‹¥æœ‰Stateç»“æ„"><a href="#Reducer-åº”è¯¥æ‹¥æœ‰Stateç»“æ„" class="headerlink" title="Reducer åº”è¯¥æ‹¥æœ‰Stateç»“æ„"></a>Reducer åº”è¯¥æ‹¥æœ‰Stateç»“æ„</h3><p>Redux æ ¹stateç”±å•æ ¹ reducer å‡½æ•°æ‹¥æœ‰å’Œè®¡ç®—ã€‚ä¸ºäº†å¯ç»´æŠ¤æ€§ï¼Œè¿™ä¸ª reducer è¢«æŒ‰ç…§é”®/å€¼åˆ†å‰²æˆâ€slicesâ€ï¼Œæ¯ä¸ªâ€œslice reducerâ€è´Ÿè´£æä¾›ä¸€ä¸ªåˆå§‹å€¼å¹¶è®¡ç®—å¯¹è¯¥çŠ¶æ€ç‰‡çš„æ›´æ–°ã€‚</p><p>æ­¤å¤–ï¼Œâ€œslice reducerâ€åº”è¯¥å¯¹ä½œä¸ºè®¡ç®—çŠ¶æ€çš„ä¸€éƒ¨åˆ†è¿”å›çš„å…¶ä»–å€¼è¿›è¡Œæ§åˆ¶ã€‚å°½é‡å‡å°‘ä½¿ç”¨â€œä¹±åˆ†é…/è¿”å›â€ï¼Œæ¯”å¦‚ return action. payload æˆ– return { â€¦stateï¼Œâ€¦action.payload } ï¼Œå› ä¸ºå®ƒä»¬ä¾èµ–äºactionæ˜¯æ­£ç¡®æ ¼å¼åŒ–çš„å†…å®¹ï¼Œè€Œ reducer å®é™…ä¸Šæ”¾å¼ƒäº†å¯¹è¯¥çŠ¶æ€çš„æ‰€æœ‰æƒã€‚å¦‚æœæ“ä½œå†…å®¹ä¸æ­£ç¡®ï¼Œå°±ä¼šå¯¼è‡´é”™è¯¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-keyword">const</span> initialState = &#123;<br>    <span class="hljs-attr">firstName</span> : <span class="hljs-literal">null</span> ,<br>    <span class="hljs-attr">lastName</span> : <span class="hljs-literal">null</span> ,<br>    <span class="hljs-attr">age</span> : <span class="hljs-literal">null</span> ,<br>&#125;;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> usersReducer = (state = initialState, action ) &#123;<br>    <span class="hljs-keyword">switch</span> ( action.type ) &#123;<br>      <span class="hljs-comment">// å®Œå…¨å‡å®š action.payload å°†æ˜¯ä¸€ä¸ªæ­£ç¡®æ ¼å¼åŒ–çš„å¯¹è±¡ã€‚</span><br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;users/userLoggedIn&quot;</span> : &#123;<br>           <span class="hljs-keyword">return</span> action.payload;<br>        &#125;<br>        <span class="hljs-attr">default</span> : <span class="hljs-keyword">return</span> state ;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//å¦‚æœä»£ç çš„æŸä¸ªéƒ¨åˆ†åœ¨æ“ä½œä¸­åˆ†æ´¾ä¸€ä¸ªâ€œ todoâ€å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªâ€œ userâ€å¯¹è±¡:</span><br><span class="hljs-comment">//è¿™ä¸ª reducer ä¼šç›²ç›®åœ°è¿”å› todoï¼Œç°åœ¨å½“å®ƒè¯•å›¾ä»å•†åº—ä¸­è¯»å–ç”¨æˆ·ä¿¡æ¯æ—¶ï¼Œåº”ç”¨ç¨‹åºçš„å…¶ä½™éƒ¨åˆ†å¯èƒ½ä¼šå´©æºƒã€‚</span><br>dispatch (&#123;<br>  <span class="hljs-attr">type</span> : <span class="hljs-string">&#x27;users/userLoggedIn&#x27;</span>,<br>  <span class="hljs-attr">payload</span> : &#123;<br>    <span class="hljs-attr">id</span> : <span class="hljs-number">42</span>,<br>    <span class="hljs-attr">text</span> : <span class="hljs-string">&#x27;Buy milk&#x27;</span><br>  &#125;<br>&#125;)<br></code></pre></div></td></tr></table></figure><p>å¦‚æœ reducer è¿›è¡Œäº†ä¸€äº›éªŒè¯æ£€æŸ¥ä»¥ç¡®ä¿ action.payload å®é™…ä¸Šå…·æœ‰æ­£ç¡®çš„å­—æ®µï¼Œæˆ–è€…å°è¯•æŒ‰åç§°è¯»å‡ºæ­£ç¡®çš„å­—æ®µï¼Œé‚£ä¹ˆè‡³å°‘å¯ä»¥éƒ¨åˆ†ä¿®å¤è¿™ä¸ªé—®é¢˜ã€‚ä¸è¿‡ï¼Œè¿™çš„ç¡®å¢åŠ äº†æ›´å¤šçš„ä»£ç ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªä¸ºäº†å®‰å…¨è€Œç‰ºç‰²æ›´å¤šä»£ç çš„é—®é¢˜ã€‚</p><p>ä½¿ç”¨é™æ€ç±»å‹ç¡®å®ä½¿è¿™ç§ä»£ç æ›´å®‰å…¨ï¼Œä¹Ÿæ›´å®¹æ˜“è¢«æ¥å—ã€‚å¦‚æœ<code>reducer</code> çŸ¥é“<code>action</code> æ˜¯<code> PayloadAction&lt;user&gt;</code> ï¼Œé‚£ä¹ˆæ‰§è¡Œ<code>return action.payload</code>æ˜¯å®‰å…¨çš„ã€‚</p><h3 id="æ ¹æ®å­˜å‚¨çš„æ•°æ®ç»“æ„å‘½åâ€œState-Slicesâ€"><a href="#æ ¹æ®å­˜å‚¨çš„æ•°æ®ç»“æ„å‘½åâ€œState-Slicesâ€" class="headerlink" title="æ ¹æ®å­˜å‚¨çš„æ•°æ®ç»“æ„å‘½åâ€œState Slicesâ€"></a>æ ¹æ®å­˜å‚¨çš„æ•°æ®ç»“æ„å‘½åâ€œState Slicesâ€</h3><p><code>combineReducers</code>æ˜¯å°†è¿™äº›<code>slice reducer</code>è¿æ¥æˆä¸€ä¸ªæ›´å¤§çš„<code>reducer</code>çš„æ ‡å‡†å‡½æ•°ã€‚</p><p>ä¼ é€’ç»™<code>combineReducers</code>çš„å¯¹è±¡ä¸­çš„é”®åå°†å®šä¹‰ç»“æœ<code>state</code>å¯¹è±¡ä¸­é”®çš„åç§°ã€‚ç¡®ä¿æŒ‰ç…§ä¿å­˜åœ¨æ•°æ®ä¸­çš„é”®åè¿›è¡Œå‘½åï¼Œå¹¶é¿å…åœ¨é”®åä¸­ä½¿ç”¨â€œreducerâ€ï¼Œä¾‹å¦‚ï¼š<code>&#123; users: &#123;&#125; ï¼Œposts: &#123;&#125;</code> ï¼Œè€Œä¸æ˜¯<code>&#123; usersReducer: &#123;&#125; ï¼ŒpostsReducer: &#123;&#125;</code></p><h3 id="å°†â€œReducersâ€è§†ä¸ºâ€œStateâ€æœºå™¨"><a href="#å°†â€œReducersâ€è§†ä¸ºâ€œStateâ€æœºå™¨" class="headerlink" title="å°†â€œReducersâ€è§†ä¸ºâ€œStateâ€æœºå™¨"></a>å°†â€œReducersâ€è§†ä¸ºâ€œStateâ€æœºå™¨</h3><p>è®¸å¤šRedux reduceréƒ½æ˜¯â€œæ— æ¡ä»¶â€ï¼ˆunconditionallyï¼‰çš„ã€‚å®ƒä»¬åªæŸ¥çœ‹å·²è°ƒåº¦çš„actionå¹¶è®¡ç®—æ–°çš„stateï¼Œè€Œä¸å°†ä»»ä½•é€»è¾‘å»ºç«‹åœ¨å½“å‰stateçš„åŸºç¡€ä¸Šã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯ï¼Œå› ä¸ºæ ¹æ®åº”ç”¨ç¨‹åºé€»è¾‘çš„å…¶ä½™éƒ¨åˆ†ï¼ŒæŸäº›æ“ä½œåœ¨æŸäº›æ—¶å€™å¯èƒ½åœ¨æ¦‚å¿µä¸Šä¸â€œæœ‰æ•ˆâ€ã€‚ä¾‹å¦‚ï¼Œâ€œrequest succeededâ€ï¼ˆè¯·æ±‚æˆåŠŸï¼‰actionåªåº”åœ¨stateä¸ºâ€œloadingâ€ï¼ˆå·²åŠ è½½ï¼‰æ—¶è®¡ç®—æ–°å€¼ï¼Œæˆ–è€…ä»…å½“æœ‰æ ‡è®°ä¸ºâ€œbeing Editingâ€ï¼ˆæ­£åœ¨ç¼–è¾‘ï¼‰çš„é¡¹æ—¶æ‰åº”è°ƒåº¦â€œupdate this itemâ€ actionã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°†â€œReducersâ€è§†ä¸ºâ€œstateæœºâ€ï¼Œå…¶ä¸­å½“å‰stateå’Œåˆ†æ´¾actionçš„ç»„åˆå†³å®šæ˜¯å¦å®é™…è®¡ç®—ä¸€ä¸ªæ–°çš„çŠ¶æ€å€¼ï¼Œè€Œä¸ä»…ä»…æ˜¯æ— æ¡ä»¶åœ°è®¡ç®—æ“ä½œæœ¬èº«ã€‚</p><h3 id="è§„èŒƒå¤æ‚çš„åµŒå¥—-å…³ç³»state"><a href="#è§„èŒƒå¤æ‚çš„åµŒå¥—-å…³ç³»state" class="headerlink" title="è§„èŒƒå¤æ‚çš„åµŒå¥—/å…³ç³»state"></a>è§„èŒƒå¤æ‚çš„åµŒå¥—/å…³ç³»<code>state</code></h3><p>å…¶å®å°±æ˜¯å°†stateçš„ç»“æ„æ‰å¹³åŒ–ã€‚</p><h3 id="æŠŠactionå½“ä½œäº‹ä»¶ï¼Œè€Œä¸æ˜¯è®¾ç½®è€…"><a href="#æŠŠactionå½“ä½œäº‹ä»¶ï¼Œè€Œä¸æ˜¯è®¾ç½®è€…" class="headerlink" title="æŠŠactionå½“ä½œäº‹ä»¶ï¼Œè€Œä¸æ˜¯è®¾ç½®è€…"></a>æŠŠactionå½“ä½œäº‹ä»¶ï¼Œè€Œä¸æ˜¯è®¾ç½®è€…</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-comment">//æœ€ä½³å®è·µï¼ŒæŠŠactionå½“ä½œäº‹ä»¶</span><br>&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;food/orderAdded&quot;</span>,  <span class="hljs-attr">payload</span>: &#123;<span class="hljs-attr">pizza</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">coke</span> : <span class="hljs-number">1</span>&#125; &#125;<br><span class="hljs-comment">//å·®ï¼ŒæŠŠactionä½œä¸ºè®¾ç½®è€…ï¼ˆsetterï¼‰</span><br>&#123;<br>    <span class="hljs-attr">type</span> : <span class="hljs-string">&quot;orders/setPizzasOrdered&quot;</span>,<br>    <span class="hljs-attr">payload</span> : &#123;<br>        <span class="hljs-attr">amount</span> : getState().orders.pizza + <span class="hljs-number">1</span>,<br>    &#125;<br>&#125;<br>&#123;<br>    <span class="hljs-attr">type</span> : <span class="hljs-string">&quot;orders/setCokesOrdered&quot;</span>,<br>    <span class="hljs-attr">payload</span> : &#123;<br>        <span class="hljs-attr">amount</span> : getState().orders.coke + <span class="hljs-number">1</span>,<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="actionçš„åå­—æœ‰æ„ä¹‰"><a href="#actionçš„åå­—æœ‰æ„ä¹‰" class="headerlink" title="actionçš„åå­—æœ‰æ„ä¹‰"></a>actionçš„åå­—æœ‰æ„ä¹‰</h3><p>Type å­—æ®µä¸»è¦ç”¨äºä¸¤ä¸ªç›®çš„ï¼š</p><ul><li>Reduceræ£€æŸ¥action.typeï¼Œä»¥ç¡®å®šæ˜¯å¦åº”è¯¥å¤„ç†æ­¤æ“ä½œæ¥è®¡ç®—æ–°state</li><li>action.typeæ˜¾ç¤ºåœ¨ reduxDevTools å†å²æ—¥å¿—ä¸­ï¼Œæ–¹ä¾¿è°ƒè¯•</li></ul><h3 id="å…è®¸å¤šä¸ªreducerå¯¹å“åº”ä¸€ä¸ªaction"><a href="#å…è®¸å¤šä¸ªreducerå¯¹å“åº”ä¸€ä¸ªaction" class="headerlink" title="å…è®¸å¤šä¸ªreducerå¯¹å“åº”ä¸€ä¸ªaction"></a>å…è®¸å¤šä¸ªreducerå¯¹å“åº”ä¸€ä¸ªaction</h3><p>å°†actionä½œä¸ºâ€œäº‹ä»¶â€å¹¶å…è®¸å¤šä¸ªreducerå“åº”è¿™äº›actioné€šå¸¸ä¼šå…è®¸ç¨‹åºçš„ä»£ç æ›´å¥½åœ°ä¼¸ç¼©ï¼Œå¹¶æœ€å°åŒ–ä¸ºå®Œæˆä¸€ä¸ªæœ‰æ„ä¹‰çš„æ›´æ–°è€Œåˆ†æ´¾å¤šä¸ªæ“ä½œæ‰€éœ€çš„æ¬¡æ•°ã€‚</p><h3 id="é¿å…è¿ç»­åˆ†æ´¾å¤šä¸ªaction"><a href="#é¿å…è¿ç»­åˆ†æ´¾å¤šä¸ªaction" class="headerlink" title="é¿å…è¿ç»­åˆ†æ´¾å¤šä¸ªaction"></a>é¿å…è¿ç»­åˆ†æ´¾å¤šä¸ªaction</h3><p>é€šå¸¸ä¼šå¯¼è‡´å¤šä¸ªç›¸å¯¹æ˜‚è´µçš„ UI æ›´æ–°ï¼Œé€ æˆæ–°èƒ½æŸè€—ï¼Œå¹¶ä¸”ä¸€äº›ä¸­é—´Stateå¯èƒ½ä¼šè¢«åº”ç”¨ç¨‹åºé€»è¾‘çš„å…¶ä»–éƒ¨åˆ†æ— æ•ˆã€‚</p><p>æœ€å¥½åˆ†æ´¾ä¸€ä¸ªå•ç‹¬çš„â€œäº‹ä»¶â€ç±»å‹çš„actionï¼Œè¿™æ ·å¯ä»¥åŒæ—¶äº§ç”Ÿæ‰€æœ‰é€‚å½“çš„Stateæ›´æ–°ï¼Œæˆ–è€…è€ƒè™‘ä½¿ç”¨actionæ‰¹å¤„ç†æ’ä»¶æ¥åˆ†æ´¾å¤šä¸ªåŠ¨ä½œï¼Œæœ€ååªæœ‰ä¸€ä¸ª UI æ›´æ–°ã€‚</p><h3 id="è¯„ä¼°æ¯ä¸ªstateåº”è¯¥å­˜åœ¨å“ªé‡Œ"><a href="#è¯„ä¼°æ¯ä¸ªstateåº”è¯¥å­˜åœ¨å“ªé‡Œ" class="headerlink" title="è¯„ä¼°æ¯ä¸ªstateåº”è¯¥å­˜åœ¨å“ªé‡Œ"></a>è¯„ä¼°æ¯ä¸ªstateåº”è¯¥å­˜åœ¨å“ªé‡Œ</h3><p>æœ‰çš„stateå­˜åœ¨storeé‡Œä¸åˆé€‚ï¼Œæ›´é€‚åˆå­˜æ”¾åœ¨ç»„ä»¶å†…éƒ¨ã€‚</p><h3 id="ä½¿ç”¨-redux-Hooks-API"><a href="#ä½¿ç”¨-redux-Hooks-API" class="headerlink" title="ä½¿ç”¨ redux Hooks API"></a>ä½¿ç”¨ redux Hooks API</h3><p>hooks æ›´å®¹æ˜“ä»¥å¤šç§æ–¹å¼ä½¿ç”¨ã€‚hookså…·æœ‰æ›´å°‘çš„é—´æ¥æ€§ï¼Œæ›´å°‘çš„ä»£ç ç¼–å†™ï¼Œå¹¶ä¸”æ¯” connect æ›´å®¹æ˜“ä¸Typescriptä¸€èµ·ä½¿ç”¨ã€‚<br>ä¸»è¦æ˜¯ä½¿ç”¨æ–¹ä¾¿ï¼Œä¾¿äºç»´æŠ¤ã€‚</p><h3 id="è¿æ¥æ›´å¤šç»„ä»¶ä»¥ä»storeè¯»å–æ•°æ®"><a href="#è¿æ¥æ›´å¤šç»„ä»¶ä»¥ä»storeè¯»å–æ•°æ®" class="headerlink" title="è¿æ¥æ›´å¤šç»„ä»¶ä»¥ä»storeè¯»å–æ•°æ®"></a>è¿æ¥æ›´å¤šç»„ä»¶ä»¥ä»storeè¯»å–æ•°æ®</h3><p>æœ‰æ›´å¤šçš„ UI ç»„ä»¶è®¢é˜…åˆ° Redux Storeï¼Œå¹¶ä»¥æ›´ç»†ç²’åº¦çš„çº§åˆ«è¯»å–æ•°æ®ã€‚è¿™é€šå¸¸ä¼šå¸¦æ¥æ›´å¥½çš„ UI æ€§èƒ½ï¼Œå› ä¸ºåœ¨ç»™å®šçš„stateæ›´æ”¹æ—¶ï¼Œéœ€è¦å‘ˆç°çš„ç»„ä»¶æ›´å°‘ã€‚</p><p>ä¸å…¶ä»…ä»…è¿æ¥ä¸€ä¸ª <code>&lt;userlist&gt;</code> ç»„ä»¶å¹¶è¯»å–æ•´ä¸ªç”¨æˆ·æ•°ç»„ï¼Œä¸å¦‚è®© <code>&lt;userlist&gt;</code> æ£€ç´¢æ‰€æœ‰ç”¨æˆ·idçš„åˆ—è¡¨ï¼Œå°†åˆ—è¡¨é¡¹ä½œä¸º <code>&lt;UserListItem userId=&#123;userId&#125;&gt;</code>å‘ˆç°ï¼Œå¹¶å°† <code>&lt;UserListItem&gt;</code> è¿æ¥èµ·æ¥å¹¶ä»storeä¸­æå–å®ƒè‡ªå·±çš„ç”¨æˆ·æ¡ç›®ã€‚</p><h3 id="å°†mapDispatchçš„å¯¹è±¡é€Ÿè®°å½¢å¼ä¸connectä¸€èµ·ä½¿ç”¨"><a href="#å°†mapDispatchçš„å¯¹è±¡é€Ÿè®°å½¢å¼ä¸connectä¸€èµ·ä½¿ç”¨" class="headerlink" title="å°†mapDispatchçš„å¯¹è±¡é€Ÿè®°å½¢å¼ä¸connectä¸€èµ·ä½¿ç”¨"></a>å°†mapDispatchçš„å¯¹è±¡é€Ÿè®°å½¢å¼ä¸connectä¸€èµ·ä½¿ç”¨</h3><p>è¦è¿æ¥çš„ mapDispatch å‚æ•°å¯ä»¥å®šä¹‰ä¸ºä½œä¸ºå‚æ•°æ¥æ”¶åˆ†æ´¾çš„å‡½æ•°ï¼Œä¹Ÿå¯ä»¥å®šä¹‰ä¸ºåŒ…å«åŠ¨ä½œåˆ›å»ºè€…çš„å¯¹è±¡ã€‚å»ºè®®ä½¿ç”¨ mapDispatch çš„â€œ object é€Ÿè®°â€å½¢å¼ï¼Œå› ä¸ºå®ƒå¯ä»¥å¤§å¤§ç®€åŒ–ä»£ç ã€‚å‡ ä¹ä»æ¥æ²¡æœ‰çœŸæ­£éœ€è¦å°† mapDispatch ç¼–å†™ä¸ºä¸€ä¸ªå‡½æ•°ã€‚</p><h3 id="åœ¨å‡½æ•°ç»„ä»¶ä¸­å¤šæ¬¡è°ƒç”¨useSelector"><a href="#åœ¨å‡½æ•°ç»„ä»¶ä¸­å¤šæ¬¡è°ƒç”¨useSelector" class="headerlink" title="åœ¨å‡½æ•°ç»„ä»¶ä¸­å¤šæ¬¡è°ƒç”¨useSelector"></a>åœ¨å‡½æ•°ç»„ä»¶ä¸­å¤šæ¬¡è°ƒç”¨useSelector</h3><p>å½“ä½¿ç”¨ useSelector é’©å­æ£€ç´¢æ•°æ®æ—¶ï¼Œæœ€å¥½å¤šæ¬¡è°ƒç”¨ useSelector å¹¶æ£€ç´¢è¾ƒå°æ•°é‡çš„æ•°æ®ï¼Œè€Œä¸æ˜¯ä½¿ç”¨å•ä¸ªè¾ƒå¤§çš„ useSelector è°ƒç”¨è¿”å›ä¸€ä¸ªå¯¹è±¡ä¸­çš„å¤šä¸ªç»“æœã€‚ä¸ mapState ä¸åŒï¼ŒuseSelector ä¸éœ€è¦è¿”å›å¯¹è±¡ï¼Œè€Œä¸”Selectorè¯»å–è¾ƒå°çš„å€¼æ„å‘³ç€ç»™å®šçš„Stateæ›´æ”¹ä¸å¤ªå¯èƒ½å¯¼è‡´è¯¥ç»„ä»¶å‘ˆç°</p><h3 id="ä½¿ç”¨é™æ€ç±»å‹"><a href="#ä½¿ç”¨é™æ€ç±»å‹" class="headerlink" title="ä½¿ç”¨é™æ€ç±»å‹"></a>ä½¿ç”¨é™æ€ç±»å‹</h3><p>ç±»å‹ç³»ç»Ÿå°†æ•è·è®¸å¤šå¸¸è§é”™è¯¯ï¼Œæ”¹è¿›æ–‡æ¡£ï¼Œå¹¶å…·æœ‰æ›´å¥½çš„é•¿æœŸå¯ç»´æŠ¤æ€§ã€‚</p><h3 id="ä½¿ç”¨-Redux-DevTools-æ‰©å±•è¿›è¡Œè°ƒè¯•"><a href="#ä½¿ç”¨-Redux-DevTools-æ‰©å±•è¿›è¡Œè°ƒè¯•" class="headerlink" title="ä½¿ç”¨ Redux DevTools æ‰©å±•è¿›è¡Œè°ƒè¯•"></a>ä½¿ç”¨ Redux DevTools æ‰©å±•è¿›è¡Œè°ƒè¯•</h3><p>å¯ä»¥æŸ¥çœ‹åˆ°ï¼š</p><ul><li>å‘é€Actionçš„å†å²è®°å½•</li><li>æ¯ä¸ªactionçš„å†…å®¹</li><li>actionå‘å‡ºåçš„æœ€åstate</li><li>actionå‘å‡ºå‰åstateä¸­çš„å·®å¼‚</li><li>å‡½æ•°å †æ ˆè·Ÿè¸ªæ˜¾ç¤ºå®é™…è°ƒåº¦æ“ä½œçš„ä»£ç </li></ul><h3 id="å¯¹Statseè€Œè¨€ä½¿ç”¨çº¯JSå¯¹è±¡"><a href="#å¯¹Statseè€Œè¨€ä½¿ç”¨çº¯JSå¯¹è±¡" class="headerlink" title="å¯¹Statseè€Œè¨€ä½¿ç”¨çº¯JSå¯¹è±¡"></a>å¯¹Statseè€Œè¨€ä½¿ç”¨çº¯JSå¯¹è±¡</h3><p>åœ¨çŠ¶æ€æ ‘ä¸­ä½¿ç”¨çº¯ JavaScript å¯¹è±¡å’Œæ•°ç»„ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç±»ä¼¼ Immutable.js è¿™æ ·çš„ä¸“é—¨åº“ã€‚è™½ç„¶ä½¿ç”¨ Immutable.js æœ‰ä¸€äº›æ½œåœ¨çš„å¥½å¤„ï¼Œä½†æ˜¯å¤§å¤šæ•°å¸¸è§çš„ç›®æ ‡ï¼Œæ¯”å¦‚ç®€å•çš„å¼•ç”¨æ¯”è¾ƒï¼Œé€šå¸¸æ˜¯ä¸å¯å˜æ›´æ–°çš„å±æ€§ï¼Œä¸éœ€è¦ç‰¹å®šçš„åº“ã€‚è¿™è¿˜å¯ä»¥ä½¿ bundle å¤§å°æ›´å°ï¼Œå¹¶é™ä½æ•°æ®ç±»å‹è½¬æ¢çš„å¤æ‚æ€§ã€‚ç‰¹åˆ«æ¨èä½¿ç”¨ Immer</p><h2 id="å»ºè®®"><a href="#å»ºè®®" class="headerlink" title="å»ºè®®"></a>å»ºè®®</h2><h3 id="å°†action-typeå†™æˆdomain-eventName"><a href="#å°†action-typeå†™æˆdomain-eventName" class="headerlink" title="å°†action.typeå†™æˆdomain/eventName"></a>å°†action.typeå†™æˆdomain/eventName</h3><p>ä¾‹å¦‚ï¼š<code>todos/addTodo</code></p><h3 id="æŒ‰ç…§â€œFlux-Standard-Actionsâ€çº¦å®šå†™action"><a href="#æŒ‰ç…§â€œFlux-Standard-Actionsâ€çº¦å®šå†™action" class="headerlink" title="æŒ‰ç…§â€œFlux Standard Actionsâ€çº¦å®šå†™action"></a>æŒ‰ç…§â€œFlux Standard Actionsâ€çº¦å®šå†™action</h3><ul><li><p>æ€»æ˜¯æŠŠä»–ä»¬çš„æ•°æ®æ”¾å…¥ä¸€ä¸ªpayload field å­—æ®µ</p></li><li><p>å¯èƒ½æœ‰ä¸€ä¸ª<code>meta</code>å­—æ®µæ¥è·å–æ›´å¤šä¿¡æ¯</p></li><li><p>å¯èƒ½æœ‰ä¸€ä¸ª<code>error</code>å­—æ®µæ¥è¡¨ç¤ºæŸç§å¤±è´¥</p></li></ul><h3 id="ä½¿ç”¨Action-Creators"><a href="#ä½¿ç”¨Action-Creators" class="headerlink" title="ä½¿ç”¨Action Creators"></a>ä½¿ç”¨Action Creators</h3><p>ä½¿ç”¨Action Creatorså¯ä»¥æä¾›ä¸€è‡´æ€§ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦æŸç§å‡†å¤‡æˆ–é¢å¤–é€»è¾‘æ¥å¡«å……actionå†…å®¹çš„æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚ç”Ÿæˆå”¯ä¸€çš„ IDï¼‰ã€‚</p><p>æœ€å¥½ä½¿ç”¨Action Creatorsæ¥åˆ†æ´¾ä»»ä½•åŠ¨ä½œã€‚ä½†æ˜¯å»ºè®®ä½¿ç”¨ Redux Toolkit ä¸­çš„ createSlice å‡½æ•°ï¼Œè€Œä¸æ˜¯æ‰‹åŠ¨ç¼–å†™Action Creatorsï¼Œå®ƒå°†è‡ªåŠ¨ç”ŸæˆAction Creatorså’ŒAction.typeã€‚</p><h3 id="ä½¿ç”¨Redux-thunkè¿›è¡Œå¼‚æ­¥"><a href="#ä½¿ç”¨Redux-thunkè¿›è¡Œå¼‚æ­¥" class="headerlink" title="ä½¿ç”¨Redux-thunkè¿›è¡Œå¼‚æ­¥"></a>ä½¿ç”¨<a href="https://github.com/reduxjs/redux-thunk">Redux-thunk</a>è¿›è¡Œå¼‚æ­¥</h3><p>å»ºè®®é»˜è®¤ä½¿ç”¨ Redux Thunk ä¸­é—´ä»¶ï¼Œå› ä¸ºå®ƒå¯¹äºå¤§å¤šæ•°å…¸å‹ç”¨ä¾‹(ä¾‹å¦‚åŸºæœ¬çš„ AJAX æ•°æ®è·å–)å·²ç»è¶³å¤Ÿäº†ã€‚æ­¤å¤–ï¼Œåœ¨ thunks ä¸­ä½¿ç”¨ async/await è¯­æ³•ä½¿å®ƒä»¬æ›´æ˜“äºé˜…è¯»ã€‚</p><p>å¦‚æœæœ‰çœŸæ­£å¤æ‚çš„å¼‚æ­¥å·¥ä½œæµï¼ŒåŒ…æ‹¬å–æ¶ˆã€æ¸…é™¤ã€åœ¨ç»™å®šæ“ä½œå‘å‡ºåè¿è¡Œé€»è¾‘æˆ–è€…â€œåå°çº¿ç¨‹â€ç±»å‹çš„è¡Œä¸ºï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘æ·»åŠ æ›´å¼ºå¤§çš„å¼‚æ­¥ä¸­é—´ä»¶ï¼Œå¦‚ Redux-Saga æˆ–è€… Redux-Observableã€‚</p><h3 id="å°†å¤æ‚é€»è¾‘ç§»å‡ºç»„ä»¶"><a href="#å°†å¤æ‚é€»è¾‘ç§»å‡ºç»„ä»¶" class="headerlink" title="å°†å¤æ‚é€»è¾‘ç§»å‡ºç»„ä»¶"></a>å°†å¤æ‚é€»è¾‘ç§»å‡ºç»„ä»¶</h3><p>å°†å¤æ‚çš„åŒæ­¥æˆ–å¼‚æ­¥éƒ¨ä»¶ç§»åˆ°ç»„ä»¶ä¹‹å¤–ï¼Œä½¿ç”¨â€œå®¹å™¨/å±•ç¤ºâ€ç»„ä»¶åˆ†ç¦»ã€‚å±•ç¤ºç»„ä»¶æ˜¯å¤–è§‚ï¼Œå®¹å™¨ç»„ä»¶å†…æ”¾ä¸šåŠ¡é€»è¾‘ï¼Œç»™å±•ç¤ºç»„ä»¶æä¾›æ•°æ®</p><h3 id="ä½¿ç”¨-Selectorå‡½æ•°ä»Storeè¯»å–"><a href="#ä½¿ç”¨-Selectorå‡½æ•°ä»Storeè¯»å–" class="headerlink" title="ä½¿ç”¨ Selectorå‡½æ•°ä»Storeè¯»å–"></a>ä½¿ç”¨ Selectorå‡½æ•°ä»Storeè¯»å–</h3><h3 id="Selectorå‡½æ•°çš„åå­—åº”è¯¥ä¸ºselectThingæ ¼å¼"><a href="#Selectorå‡½æ•°çš„åå­—åº”è¯¥ä¸ºselectThingæ ¼å¼" class="headerlink" title="Selectorå‡½æ•°çš„åå­—åº”è¯¥ä¸ºselectThingæ ¼å¼"></a>Selectorå‡½æ•°çš„åå­—åº”è¯¥ä¸º<code>selectThing</code>æ ¼å¼</h3><h3 id="é¿å…åœ¨-Redux-ä¸­æ”¾ç½®è¡¨å•çŠ¶æ€"><a href="#é¿å…åœ¨-Redux-ä¸­æ”¾ç½®è¡¨å•çŠ¶æ€" class="headerlink" title="é¿å…åœ¨ Redux ä¸­æ”¾ç½®è¡¨å•çŠ¶æ€"></a>é¿å…åœ¨ Redux ä¸­æ”¾ç½®è¡¨å•çŠ¶æ€</h3><p>æ•°æ®ä¸æ˜¯çœŸæ­£çš„å…¨å±€æ•°æ®ï¼Œä¸ä¼šè¢«ç¼“å­˜ï¼Œä¹Ÿä¸ä¼šè¢«å¤šä¸ªç»„ä»¶åŒæ—¶ä½¿ç”¨ã€‚å°†è¡¨å•è¿æ¥åˆ° Redux é€šå¸¸éœ€è¦åœ¨æ¯ä¸ªå˜æ›´äº‹ä»¶ä¸Šæ‰§è¡Œè°ƒåº¦æ“ä½œï¼Œè¿™ä¼šå¯¼è‡´æ€§èƒ½å¼€é”€ï¼Œå¹¶ä¸”ä¸ä¼šå¸¦æ¥å®é™…çš„å¥½å¤„</p>]]></content>
    
    
    <categories>
      
      <category>Redux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç¿»è¯‘</tag>
      
      <tag>æœ€ä½³å®è·µ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¤¾æ‹›-å­—èŠ‚è·³åŠ¨å‰ç«¯é¢è¯•</title>
    <link href="/article/b0eba624/"/>
    <url>/article/b0eba624/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ‰¾äº†æœ‹å‹å¸®å¿™å†…æ¨äº†å­—èŠ‚è·³åŠ¨-é£ä¹¦ã€‚æ²¡æƒ³åˆ°å“åº”éå¸¸è¿…é€Ÿï¼Œæœ¬ä»¥ä¸ºä¼šè¿‡ä¸€æ®µæ—¶é—´æ‰ä¼šå®‰æ’é¢è¯•ã€‚æ²¡æƒ³åˆ°éš”å¤©å°±å®‰æ’ä¸Šäº†é¢è¯•ï¼Œæœ¬æ¥è¿˜æƒ³åœ¨é¢å­—èŠ‚ä¹‹å‰å…ˆæ‹¿å…¶ä»–å‡ å®¶è¯•æ°´ï¼Œç„¶åå†æ¥é¢è¯•ï¼Œæ²¡æƒ³åˆ°å­—èŠ‚æ•ˆç‡å¤ªé«˜äº†ã€‚</p><p>äºŒé¢å·²ç»“æŸï¼Œåœ¨å­—èŠ‚é¢è¯•å°±æ˜¯äº«å—ï¼Œè™½ç„¶ä¸ªäººéå¸¸ç´§å¼ ï¼Œä½†æ˜¯ä¸€åœºé¢è¯•ä¸‹æ¥çœŸçš„æ”¶è·éå¸¸å¤šã€‚å…¨éƒ¨é—®é¢˜éƒ½æ˜¯åŸºäºä¸ªäººç®€å†æ¥è¿›è¡Œé—®ç­”çš„ï¼Œé¢è¯•è®°å½•æŠ½è±¡äº†ä¸€ä¸‹ã€‚</p><h2 id="ä¸€é¢"><a href="#ä¸€é¢" class="headerlink" title="ä¸€é¢"></a>ä¸€é¢</h2><p>ç°åœ¨å›é¡¾ä¸€ä¸‹é¢è¯•é¢˜ï¼Œå‘ç°å¤§ä½¬å¥½åƒé—®äº†å¥½å¤šå…³äºå‡½æ•°å¼ç¼–ç¨‹çš„é—®é¢˜ï¼Œç»„å†…å¯èƒ½å·²ç»åœ¨è¿›è¡Œå‡½æ•°å¼ç¼–ç¨‹çš„å®è·µäº†ï¼Ÿ</p><h3 id="å †å’Œæ ˆçš„åŒºåˆ«ï¼Ÿ"><a href="#å †å’Œæ ˆçš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="å †å’Œæ ˆçš„åŒºåˆ«ï¼Ÿ"></a>å †å’Œæ ˆçš„åŒºåˆ«ï¼Ÿ</h3><p>æ ˆå’Œå †æ²¡æœ‰æœ¬è´¨åŒºåˆ«ï¼Œä½¿ç”¨æ ˆå†…å­˜æ—¶ï¼Œæ˜¯ä»åœ°å€é«˜ä½å¼€å§‹åˆ†é…å†…å­˜ç©ºé—´ã€‚ä½¿ç”¨å †å†…å­˜æ—¶ï¼Œæ˜¯ä»åœ°å€ä½ä½å¼€å§‹åˆ†é…ç©ºé—´ã€‚æ ˆä¸­å­˜æ”¾çš„ä¸»è¦æ˜¯æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå‡½æ•°è°ƒç”¨æ ˆç­‰ã€‚å †ä¸­å­˜æ”¾çš„æ˜¯å¯¹è±¡è¿™ç§å¤æ‚æ•°æ®ã€‚éœ€è¦æŒ‰åœ°å€è®¿é—®ã€‚</p><h3 id="é€’å½’ä¼šå¼•å‘ä»€ä¹ˆé—®é¢˜ï¼Ÿä¸ºä»€ä¹ˆä¼šçˆ†æ ˆï¼Ÿ"><a href="#é€’å½’ä¼šå¼•å‘ä»€ä¹ˆé—®é¢˜ï¼Ÿä¸ºä»€ä¹ˆä¼šçˆ†æ ˆï¼Ÿ" class="headerlink" title="é€’å½’ä¼šå¼•å‘ä»€ä¹ˆé—®é¢˜ï¼Ÿä¸ºä»€ä¹ˆä¼šçˆ†æ ˆï¼Ÿ"></a>é€’å½’ä¼šå¼•å‘ä»€ä¹ˆé—®é¢˜ï¼Ÿä¸ºä»€ä¹ˆä¼šçˆ†æ ˆï¼Ÿ</h3><p>è¿‡æ·±çš„é€’å½’ä¼šå¼•èµ·çˆ†æ ˆã€‚å†…å­˜ä¸­ç‰¹åœ°ç”¨æ¥å­˜æ”¾å‡½æ•°è°ƒç”¨çš„æ ˆåŒºå†…å­˜æ˜¯æœ‰é™çš„ï¼Œå¦‚æœé€’å½’å¤ªæ·±ï¼Œå°±ä¼šå‡ºç°åªå…¥æ ˆä¸å‡ºæ ˆçš„æƒ…å†µã€‚</p><h3 id="è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«ã€‚"><a href="#è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«ã€‚" class="headerlink" title="è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«ã€‚"></a>è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«ã€‚</h3><p>è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯ CPU è°ƒåº¦çš„æœ€å°å•ä½ã€‚</p><h3 id="Chrome-éƒ½æœ‰ä»€ä¹ˆè¿›ç¨‹ã€‚"><a href="#Chrome-éƒ½æœ‰ä»€ä¹ˆè¿›ç¨‹ã€‚" class="headerlink" title="Chrome éƒ½æœ‰ä»€ä¹ˆè¿›ç¨‹ã€‚"></a>Chrome éƒ½æœ‰ä»€ä¹ˆè¿›ç¨‹ã€‚</h3><p>1 ä¸ªæµè§ˆå™¨ï¼ˆBrowserï¼‰ä¸»è¿›ç¨‹ã€1 ä¸ª GPU è¿›ç¨‹ã€1 ä¸ªç½‘ç»œï¼ˆNetWorkï¼‰è¿›ç¨‹ã€å¤šä¸ªæ¸²æŸ“è¿›ç¨‹å’Œå¤šä¸ªæ’ä»¶è¿›ç¨‹ã€‚</p><h3 id="HTTPs-æ€ä¹ˆå›äº‹ï¼Ÿ"><a href="#HTTPs-æ€ä¹ˆå›äº‹ï¼Ÿ" class="headerlink" title="HTTPs æ€ä¹ˆå›äº‹ï¼Ÿ"></a>HTTPs æ€ä¹ˆå›äº‹ï¼Ÿ</h3><h4 id="ç¬¬ä¸€ç‰ˆï¼šä½¿ç”¨å¯¹ç§°åŠ å¯†"><a href="#ç¬¬ä¸€ç‰ˆï¼šä½¿ç”¨å¯¹ç§°åŠ å¯†" class="headerlink" title="ç¬¬ä¸€ç‰ˆï¼šä½¿ç”¨å¯¹ç§°åŠ å¯†"></a>ç¬¬ä¸€ç‰ˆï¼šä½¿ç”¨å¯¹ç§°åŠ å¯†</h4><ol><li><p>æµè§ˆå™¨å‘é€å®ƒæ‰€æ”¯æŒçš„åŠ å¯†å¥—ä»¶åˆ—è¡¨å’Œä¸€ä¸ªéšæœºæ•° client-randomï¼Œè¿™é‡Œçš„åŠ å¯†å¥—ä»¶æ˜¯æŒ‡åŠ å¯†çš„æ–¹æ³•ï¼ŒåŠ å¯†å¥—ä»¶åˆ—è¡¨å°±æ˜¯æŒ‡æµè§ˆå™¨èƒ½æ”¯æŒå¤šå°‘ç§åŠ å¯†æ–¹æ³•åˆ—è¡¨ã€‚</p></li><li><p>æœåŠ¡å™¨ä¼šä»åŠ å¯†å¥—ä»¶åˆ—è¡¨ä¸­é€‰å–ä¸€ä¸ªåŠ å¯†å¥—ä»¶ï¼Œç„¶åè¿˜ä¼šç”Ÿæˆä¸€ä¸ªéšæœºæ•° service-randomï¼Œå¹¶å°† service-random å’ŒåŠ å¯†å¥—ä»¶åˆ—è¡¨è¿”å›ç»™æµè§ˆå™¨ã€‚</p></li><li><p>æœ€åæµè§ˆå™¨å’ŒæœåŠ¡å™¨åˆ†åˆ«è¿”å›ç¡®è®¤æ¶ˆæ¯ã€‚</p></li><li><p>ç„¶åå®ƒä»¬å†ä½¿ç”¨ç›¸åŒçš„æ–¹æ³•å°† client-random å’Œ service-random æ··åˆèµ·æ¥ç”Ÿæˆä¸€ä¸ªå¯†é’¥ master secretï¼Œæœ‰äº†å¯†é’¥ master secret å’ŒåŠ å¯†å¥—ä»¶ä¹‹åï¼ŒåŒæ–¹å°±å¯ä»¥è¿›è¡Œæ•°æ®çš„åŠ å¯†ä¼ è¾“äº†ã€‚</p></li></ol><h4 id="ç¬¬äºŒç‰ˆï¼šä½¿ç”¨éå¯¹ç§°åŠ å¯†"><a href="#ç¬¬äºŒç‰ˆï¼šä½¿ç”¨éå¯¹ç§°åŠ å¯†" class="headerlink" title="ç¬¬äºŒç‰ˆï¼šä½¿ç”¨éå¯¹ç§°åŠ å¯†"></a>ç¬¬äºŒç‰ˆï¼šä½¿ç”¨éå¯¹ç§°åŠ å¯†</h4><ol><li><p>é¦–å…ˆæµè§ˆå™¨å‘é€åŠ å¯†å¥—ä»¶åˆ—è¡¨ç»™æœåŠ¡å™¨ã€‚</p></li><li><p>ç„¶åæœåŠ¡å™¨ä¼šé€‰æ‹©ä¸€ä¸ªåŠ å¯†å¥—ä»¶ï¼Œä½¿ç”¨éå¯¹ç§°åŠ å¯†æ—¶æœåŠ¡å™¨ä¸Šéœ€è¦æœ‰ç”¨äºæµè§ˆå™¨åŠ å¯†çš„å…¬é’¥å’ŒæœåŠ¡å™¨è§£å¯† HTTP æ•°æ®çš„ç§é’¥ï¼Œç”±äºå…¬é’¥æ˜¯ç»™æµè§ˆå™¨åŠ å¯†ä½¿ç”¨çš„ï¼Œå› æ­¤æœåŠ¡å™¨ä¼šå°†åŠ å¯†å¥—ä»¶å’Œå…¬é’¥ä¸€é“å‘é€ç»™æµè§ˆå™¨ã€‚</p></li><li><p>æœ€åå°±æ˜¯æµè§ˆå™¨å’ŒæœåŠ¡å™¨è¿”å›ç¡®è®¤æ¶ˆæ¯ã€‚</p></li><li><p>åœ¨æµè§ˆå™¨ç«¯å‘æœåŠ¡å™¨ç«¯å‘é€æ•°æ®æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨è¯¥å…¬é’¥æ¥åŠ å¯†æ•°æ®</p></li></ol><h4 id="ç¬¬ä¸‰ç‰ˆï¼šå¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†æ­é…ä½¿ç”¨"><a href="#ç¬¬ä¸‰ç‰ˆï¼šå¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†æ­é…ä½¿ç”¨" class="headerlink" title="ç¬¬ä¸‰ç‰ˆï¼šå¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†æ­é…ä½¿ç”¨"></a>ç¬¬ä¸‰ç‰ˆï¼šå¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†æ­é…ä½¿ç”¨</h4><ol><li><p>é¦–å…ˆæµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€å¯¹ç§°åŠ å¯†å¥—ä»¶åˆ—è¡¨ã€éå¯¹ç§°åŠ å¯†å¥—ä»¶åˆ—è¡¨å’Œéšæœºæ•° client-randomï¼›</p></li><li><p>æœåŠ¡å™¨ä¿å­˜éšæœºæ•° client-randomï¼Œé€‰æ‹©å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†çš„å¥—ä»¶ï¼Œç„¶åç”Ÿæˆéšæœºæ•° service-randomï¼Œå‘æµè§ˆå™¨å‘é€é€‰æ‹©çš„åŠ å¯†å¥—ä»¶ã€service-random å’Œå…¬é’¥ï¼›</p></li><li><p>æµè§ˆå™¨ä¿å­˜å…¬é’¥ï¼Œå¹¶ç”Ÿæˆéšæœºæ•° pre-masterï¼Œç„¶ååˆ©ç”¨å…¬é’¥å¯¹ pre-master åŠ å¯†ï¼Œå¹¶å‘æœåŠ¡å™¨å‘é€åŠ å¯†åçš„æ•°æ®ï¼›</p></li><li><p>æœ€åæœåŠ¡å™¨æ‹¿å‡ºè‡ªå·±çš„ç§é’¥ï¼Œè§£å¯†å‡º pre-master æ•°æ®ï¼Œå¹¶è¿”å›ç¡®è®¤æ¶ˆæ¯ã€‚</p></li><li><p>æœåŠ¡å™¨å’Œæµè§ˆå™¨å°±æœ‰äº†å…±åŒçš„ client-randomã€service-random å’Œ pre-masterï¼Œç„¶åæœåŠ¡å™¨å’Œæµè§ˆå™¨ä¼šä½¿ç”¨è¿™ä¸‰ç»„éšæœºæ•°ç”Ÿæˆå¯¹ç§°å¯†é’¥ã€‚</p></li></ol><h4 id="ç¬¬å››ç‰ˆï¼šæ·»åŠ æ•°å­—è¯ä¹¦"><a href="#ç¬¬å››ç‰ˆï¼šæ·»åŠ æ•°å­—è¯ä¹¦" class="headerlink" title="ç¬¬å››ç‰ˆï¼šæ·»åŠ æ•°å­—è¯ä¹¦"></a>ç¬¬å››ç‰ˆï¼šæ·»åŠ æ•°å­—è¯ä¹¦</h4><ol><li><p>é¦–å…ˆæµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€å¯¹ç§°åŠ å¯†å¥—ä»¶åˆ—è¡¨ã€éå¯¹ç§°åŠ å¯†å¥—ä»¶åˆ—è¡¨å’Œéšæœºæ•° client-randomï¼›</p></li><li><p>æœåŠ¡å™¨ä¿å­˜éšæœºæ•° client-randomï¼Œé€‰æ‹©å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†çš„å¥—ä»¶ï¼Œç„¶åç”Ÿæˆéšæœºæ•° service-randomï¼Œå‘æµè§ˆå™¨å‘é€é€‰æ‹©çš„åŠ å¯†å¥—ä»¶ã€service-random å’Œ è¯ä¹¦</p></li><li><p>æµè§ˆå™¨éªŒè¯è¯ä¹¦ï¼Œç”Ÿæˆéšæœºæ•° pre-masterï¼Œåˆ©ç”¨å…¬é’¥å¯¹ pre-master åŠ å¯†ï¼Œå¹¶å‘æœåŠ¡å™¨å‘é€åŠ å¯†åçš„æ•°æ®ï¼›</p></li><li><p>æœ€åæœåŠ¡å™¨æ‹¿å‡ºè‡ªå·±çš„ç§é’¥ï¼Œè§£å¯†å‡º pre-master æ•°æ®ï¼Œå¹¶è¿”å›ç¡®è®¤æ¶ˆæ¯ã€‚</p></li><li><p>æœåŠ¡å™¨å’Œæµè§ˆå™¨å°±æœ‰äº†å…±åŒçš„ client-randomã€service-random å’Œ pre-masterï¼Œç„¶åæœåŠ¡å™¨å’Œæµè§ˆå™¨ä¼šä½¿ç”¨è¿™ä¸‰ç»„éšæœºæ•°ç”Ÿæˆå¯¹ç§°å¯†é’¥ã€‚</p></li></ol><h3 id="è¯ä¹¦éªŒè¯çš„æµç¨‹ã€‚"><a href="#è¯ä¹¦éªŒè¯çš„æµç¨‹ã€‚" class="headerlink" title="è¯ä¹¦éªŒè¯çš„æµç¨‹ã€‚"></a>è¯ä¹¦éªŒè¯çš„æµç¨‹ã€‚</h3><ol><li><p>é¦–å…ˆæµè§ˆå™¨è¯»å–è¯ä¹¦ä¸­ç›¸å…³çš„æ˜æ–‡ä¿¡æ¯ï¼Œé‡‡ç”¨ CA ç­¾åæ—¶ç›¸åŒçš„ Hash å‡½æ•°æ¥è®¡ç®—å¹¶å¾—åˆ°ä¿¡æ¯æ‘˜è¦ A</p></li><li><p>ç„¶åå†åˆ©ç”¨å¯¹åº” CA çš„å…¬é’¥è§£å¯†ç­¾åæ•°æ®ï¼Œå¾—åˆ°ä¿¡æ¯æ‘˜è¦ Bï¼›</p></li><li><p>å¯¹æ¯”ä¿¡æ¯æ‘˜è¦ A å’Œä¿¡æ¯æ‘˜è¦ Bï¼Œå¦‚æœä¸€è‡´ï¼Œåˆ™å¯ä»¥ç¡®è®¤è¯ä¹¦æ˜¯åˆæ³•çš„ã€‚åŒæ—¶æµè§ˆå™¨è¿˜ä¼šéªŒè¯è¯ä¹¦ç›¸å…³çš„åŸŸåä¿¡æ¯ã€æœ‰æ•ˆæ—¶é—´ç­‰ä¿¡æ¯ã€‚</p></li></ol><h3 id="å¦‚ä½•å°½å¯èƒ½çš„å¤šå‘åŒ…å¹¶ä¸”ä¸ä¸¢åŒ…ï¼Ÿ"><a href="#å¦‚ä½•å°½å¯èƒ½çš„å¤šå‘åŒ…å¹¶ä¸”ä¸ä¸¢åŒ…ï¼Ÿ" class="headerlink" title="å¦‚ä½•å°½å¯èƒ½çš„å¤šå‘åŒ…å¹¶ä¸”ä¸ä¸¢åŒ…ï¼Ÿ"></a>å¦‚ä½•å°½å¯èƒ½çš„å¤šå‘åŒ…å¹¶ä¸”ä¸ä¸¢åŒ…ï¼Ÿ</h3><p>åˆ°ç›®å‰ä¸ºæ­¢ä¸çŸ¥é“æ€ä¹ˆç­”ã€‚</p><h3 id="æ»‘åŠ¨çª—å£"><a href="#æ»‘åŠ¨çª—å£" class="headerlink" title="æ»‘åŠ¨çª—å£"></a>æ»‘åŠ¨çª—å£</h3><p><a href="https://blog.csdn.net/yao5hed/article/details/81046945">æ»‘åŠ¨çª—å£è¯¦è§£</a></p><h3 id="HTTP2-çš„å¤šè·¯å¤ç”¨æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ"><a href="#HTTP2-çš„å¤šè·¯å¤ç”¨æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ" class="headerlink" title="HTTP2 çš„å¤šè·¯å¤ç”¨æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ"></a>HTTP2 çš„å¤šè·¯å¤ç”¨æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ</h3><p>åœ¨ä¸€ä¸ª TCP è¿æ¥ä¸­å¯ä»¥å­˜åœ¨å¤šæ¡æµã€‚ä¹Ÿå°±æ˜¯å¯ä»¥å‘é€å¤šä¸ªè¯·æ±‚ã€‚é€šè¿‡è¿™ä¸ªæŠ€æœ¯ï¼Œå¯ä»¥é¿å… HTTP æ—§ç‰ˆæœ¬ä¸­çš„é˜Ÿå¤´é˜»å¡é—®é¢˜ï¼Œæå¤§çš„æé«˜ä¼ è¾“æ€§èƒ½ã€‚</p><h3 id="HTTP-ä¸­çš„å“åº”å¤´æ‹¥å¡æ€ä¹ˆå›äº‹ï¼Ÿ"><a href="#HTTP-ä¸­çš„å“åº”å¤´æ‹¥å¡æ€ä¹ˆå›äº‹ï¼Ÿ" class="headerlink" title="HTTP ä¸­çš„å“åº”å¤´æ‹¥å¡æ€ä¹ˆå›äº‹ï¼Ÿ"></a>HTTP ä¸­çš„å“åº”å¤´æ‹¥å¡æ€ä¹ˆå›äº‹ï¼Ÿ</h3><p>HTTP/1.1 é€šè¿‡ç®¡é“æŠ€æœ¯å®ç°ä¸€æ¬¡æ€§å‘é€å¤šä¸ªè¯·æ±‚ï¼Œä»¥æœŸæé«˜ååå’Œæ€§èƒ½ã€‚ç„¶è€Œï¼Œè¿™ç§æŠ€æœ¯åœ¨æ¥æ”¶å“åº”æ—¶ï¼Œè¦æ±‚å¿…é¡»æŒ‰ç…§å‘é€è¯·æ±‚çš„é¡ºåºè¿”å›ã€‚å¦‚æœï¼Œç¬¬ä¸€ä¸ªè¯·æ±‚è¢«å µå¡äº†ï¼Œåˆ™åé¢çš„è¯·æ±‚å³ä½¿å¤„ç†å®Œæ¯•äº†ï¼Œä¹Ÿéœ€è¦ç­‰å¾…ã€‚</p><h3 id="WEBPACK-æ„å»ºå¦‚ä½•ä¼˜åŒ–ï¼Ÿ"><a href="#WEBPACK-æ„å»ºå¦‚ä½•ä¼˜åŒ–ï¼Ÿ" class="headerlink" title="WEBPACK æ„å»ºå¦‚ä½•ä¼˜åŒ–ï¼Ÿ"></a>WEBPACK æ„å»ºå¦‚ä½•ä¼˜åŒ–ï¼Ÿ</h3><p>è¯¦è§<a href="https://aruseito.github.io/2021/03/02/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E4%B9%8B%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96/">æ„å»ºä¼˜åŒ–</a></p><h3 id="React-çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#React-çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="React çš„ç”Ÿå‘½å‘¨æœŸ"></a>React çš„ç”Ÿå‘½å‘¨æœŸ</h3><p>react 15:<br>æŒ‚è½½æ—¶ï¼š</p><ul><li><p>constructor</p></li><li><p>componentWillMount</p></li><li><p>render</p></li><li><p>componentDidMount</p></li></ul><p>æ›´æ–°ï¼š</p><ul><li><p>componentWillRecievePropsï¼ˆç”±çˆ¶ç»„ä»¶çš„æ›´æ–°è§¦å‘ï¼‰</p></li><li><p>shouldComponentUpdate</p></li><li><p>componentWillUpdate</p></li><li><p>render</p></li><li><p>componentDidUpdate</p></li></ul><p>å¸è½½ï¼š</p><ul><li>componentWillUnmount</li></ul><p>react 16:</p><p>æŒ‚è½½æ—¶ï¼š</p><ul><li><p>constructor</p></li><li><p>getDerivedStatesFromProps</p></li><li><p>render</p></li><li><p>componentDidMount</p></li></ul><p>æ›´æ–°ï¼š</p><ul><li><p>getDerivedStatesFromProps ï¼ˆ16.3 ä»¥å‰åªæœ‰ New Props ä¼šè§¦å‘ï¼Œ16.4 ä»¥å New Propsã€setStateã€forceUpdate éƒ½å¯ä»¥è§¦å‘ï¼‰</p></li><li><p>shouldComponentUpdate</p></li><li><p>render</p></li><li><p>getSnapshotBeforeUpdate</p></li><li><p>componentDidUpdate</p></li></ul><p>å¸è½½ï¼š</p><ul><li>componentWillUnmount</li></ul><h3 id="React-çš„ç»„ä»¶ç±»å‹"><a href="#React-çš„ç»„ä»¶ç±»å‹" class="headerlink" title="React çš„ç»„ä»¶ç±»å‹"></a>React çš„ç»„ä»¶ç±»å‹</h3><p>ç±»ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶</p><p>å‡½æ•°ç»„ä»¶ï¼šç¬¦åˆ React è®¾è®¡ç†å¿µï¼Œå‡½æ•°ç¼–ç¨‹<br>ç±»ç»„ä»¶ï¼šé¢å‘å¯¹è±¡ç¼–ç¨‹æ€æƒ³</p><h3 id="pureComponet-ä¸-Component"><a href="#pureComponet-ä¸-Component" class="headerlink" title="pureComponet ä¸ Component"></a>pureComponet ä¸ Component</h3><ul><li><p>PureComponent å°†ä¼šåœ¨ shouldComponentUpdate ä¸­å¯¹ç»„ä»¶æ›´æ–°å‰åçš„ props å’Œ state è¿›è¡Œæµ…æ¯”è¾ƒï¼Œå¹¶æ ¹æ®æµ…æ¯”è¾ƒçš„ç»“æœï¼Œå†³å®šæ˜¯å¦éœ€è¦ç»§ç»­æ›´æ–°æµç¨‹ã€‚</p></li><li><p>Component æ²¡æœ‰å®ç° shouldComponentUpdateã€‚</p></li></ul><h3 id="useCallback-å’Œ-useMemo"><a href="#useCallback-å’Œ-useMemo" class="headerlink" title="useCallback å’Œ useMemo"></a>useCallback å’Œ useMemo</h3><ul><li><p>useCallback è¿”å›ä¸€ä¸ª memoized å›è°ƒå‡½æ•°</p></li><li><p>useMemo è¿”å› memoized å€¼</p></li></ul><p>useCallback(fn, deps) ç›¸å½“äº useMemo(() =&gt; fn, deps)</p><h3 id="forwardref"><a href="#forwardref" class="headerlink" title="forwardref"></a>forwardref</h3><p>forwardrefï¼šè½¬å‘ refs åˆ° DOM ç»„ä»¶ã€åœ¨é«˜é˜¶ç»„ä»¶ä¸­è½¬å‘ refs</p><h3 id="Redux-çš„æœ€ä½³å®è·µ"><a href="#Redux-çš„æœ€ä½³å®è·µ" class="headerlink" title="Redux çš„æœ€ä½³å®è·µ"></a>Redux çš„æœ€ä½³å®è·µ</h3><p><a href="https://aruseito.github.io/2021/03/12/Redux%E7%9A%84%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/">ä¸ªäººç†è§£åŠ å®˜æ–¹æ–‡æ¡£ç¿»è¯‘ç‰ˆ</a><br><a href="https://redux.js.org/style-guide/style-guide#priority-a-rules-essential">Redux çš„æœ€ä½³å®è·µå®˜æ–¹æ–‡æ¡£</a></p><h3 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h3><p>ç®—æ³•é¢˜å°±ä¸æ”¾å…·ä½“é¢˜äº†æŠŠã€‚æˆ‘çœ‹é¢è¯•å®˜é‚£é¢æ ‡è®°äº†æˆ‘çš„åå­—+é¢˜ç›®ã€‚ã€‚ã€‚ä¸çŸ¥é“ç›´æ¥æ”¾åŸé¢˜ä¼šä¸ä¼šæœ‰é—®é¢˜ã€‚</p><p>ç®—æ³•é¢˜ä¸€å…±ä¸¤é“ï¼Œç¬¬ä¸€é“è€ƒå¯Ÿï¼šæ•°æ®ç»“æ„æ ˆå’Œé“¾è¡¨ ç¬¬äºŒé¢˜è€ƒæŸ¥å‡½æ•°å¼ç¼–ç¨‹æŸ¯é‡ŒåŒ–ã€‚</p><p>éƒ½ä¸éš¾ï¼Œä½†æ˜¯ä¸€ç´§å¼ è„‘æ¢—äº†ã€‚ç¬¬ä¸€é“é¢˜å†™äº†ä¸ªè ¢æ­»äº†çš„ç®—æ³•ï¼Œåœ¨é¢è¯•å®˜çš„å¼•å¯¼ä¸‹å®Œæˆäº†ä¼˜åŒ–ã€‚</p><p>ç¬¬äºŒé¢˜ç›´æ¥æ²¡äº†æ€è·¯ï¼Œé¢è¯•ç»“æŸåçœ‹äº†ä¸€ä¸‹ï¼Œå‘ç°è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œå¯ä»¥ç›´æ¥ç”¨æ‰©å±•è¿ç®—ç¬¦ã€‚ã€‚ã€‚</p><h4 id="æŸ¯é‡ŒåŒ–"><a href="#æŸ¯é‡ŒåŒ–" class="headerlink" title="æŸ¯é‡ŒåŒ–"></a>æŸ¯é‡ŒåŒ–</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-comment">// ç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶ï¼Œå®šä¹‰ä¸€ä¸ªæ•°ç»„ä¸“é—¨ç”¨æ¥å­˜å‚¨æ‰€æœ‰çš„å‚æ•°</span><br>  <span class="hljs-keyword">let</span> _args = [...arguments];<br><br>  <span class="hljs-comment">// åœ¨å†…éƒ¨å£°æ˜ä¸€ä¸ªå‡½æ•°ï¼Œåˆ©ç”¨é—­åŒ…çš„ç‰¹æ€§ä¿å­˜_argså¹¶æ”¶é›†æ‰€æœ‰çš„å‚æ•°å€¼</span><br>  <span class="hljs-keyword">let</span> adder = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">let</span> _adder = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>      <span class="hljs-comment">// [].push.apply(_args, [].slice.call(arguments));</span><br>      _args.push(...arguments);<br>      <span class="hljs-keyword">return</span> _adder;<br>    &#125;;<br><br>    <span class="hljs-comment">// åˆ©ç”¨éšå¼è½¬æ¢çš„ç‰¹æ€§ï¼Œå½“æœ€åæ‰§è¡Œæ—¶éšå¼è½¬æ¢ï¼Œå¹¶è®¡ç®—æœ€ç»ˆçš„å€¼è¿”å›</span><br>    _adder.toString = <span class="hljs-function">() =&gt;</span> &#123;<br>      <span class="hljs-keyword">return</span> _args.reduce(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> &#123;<br>        <span class="hljs-keyword">return</span> a + b;<br>      &#125;);<br>    &#125;;<br><br>    <span class="hljs-keyword">return</span> _adder;<br>  &#125;;<br>  <span class="hljs-comment">// return adder.apply(null, _args);</span><br>  <span class="hljs-keyword">return</span> adder(..._args);<br>&#125;<br><br><span class="hljs-comment">// æ–°ç‰ˆChromeä¸ä¼šè‡ªåŠ¨è°ƒå–toStringäº†,safariè¿˜å¯ä»¥</span><br>add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>).toString();<br>add(<span class="hljs-number">1</span>)(<span class="hljs-number">2</span>)(<span class="hljs-number">3</span>)(<span class="hljs-number">4</span>).toString(); <span class="hljs-comment">//10</span><br></code></pre></div></td></tr></table></figure><h2 id="äºŒé¢"><a href="#äºŒé¢" class="headerlink" title="äºŒé¢"></a>äºŒé¢</h2><h3 id="child-process-exec-æ€ä¹ˆå®ç°çš„æé«˜æ•ˆç‡ï¼Ÿè¿›ç¨‹å’Œ-CPU-çš„å…³ç³»ï¼Ÿå¦‚æœåªæœ‰ä¸€ä¸ª-CPU-è¿˜èƒ½æå‡æ•ˆç‡å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"><a href="#child-process-exec-æ€ä¹ˆå®ç°çš„æé«˜æ•ˆç‡ï¼Ÿè¿›ç¨‹å’Œ-CPU-çš„å…³ç³»ï¼Ÿå¦‚æœåªæœ‰ä¸€ä¸ª-CPU-è¿˜èƒ½æå‡æ•ˆç‡å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="child_process.exec æ€ä¹ˆå®ç°çš„æé«˜æ•ˆç‡ï¼Ÿè¿›ç¨‹å’Œ CPU çš„å…³ç³»ï¼Ÿå¦‚æœåªæœ‰ä¸€ä¸ª CPU è¿˜èƒ½æå‡æ•ˆç‡å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"></a>child_process.exec æ€ä¹ˆå®ç°çš„æé«˜æ•ˆç‡ï¼Ÿè¿›ç¨‹å’Œ CPU çš„å…³ç³»ï¼Ÿå¦‚æœåªæœ‰ä¸€ä¸ª CPU è¿˜èƒ½æå‡æ•ˆç‡å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h3><p>child_process.exec ä¸»è¦æ˜¯å¼€å¯äº†å¤šè¿›ç¨‹ã€‚å¤šä¸ªè¿›ç¨‹å¯ä»¥å¹¶è¡Œåœ¨å¤šä¸ª cpu ä¸­è®¡ç®—ï¼Œå¯¹äºå• cpuï¼Œå¤šä¸ªè¿›ç¨‹åœ¨è¿™ä¸ªå• cpu ä¸­æ˜¯å¹¶å‘è¿è¡Œï¼Œæ ¹æ®æ—¶é—´ç‰‡è¯»å–ä¸Šä¸‹æ–‡+æ‰§è¡Œç¨‹åº+ä¿å­˜ä¸Šä¸‹æ–‡ã€‚ã€‚åŒä¸€ä¸ªè¿›ç¨‹åŒä¸€æ—¶é—´æ®µåªèƒ½åœ¨ä¸€ä¸ª cpu ä¸­è¿è¡Œï¼Œå¦‚æœè¿›ç¨‹æ•°å°äº cpu æ•°ï¼Œé‚£ä¹ˆæœªä½¿ç”¨çš„ cpu å°†ä¼šç©ºé—²ã€‚</p><h3 id="é¦–å±æ¸²æŸ“æ—¶é—´ä¼˜åŒ–æ–¹æ¡ˆï¼Ÿ"><a href="#é¦–å±æ¸²æŸ“æ—¶é—´ä¼˜åŒ–æ–¹æ¡ˆï¼Ÿ" class="headerlink" title="é¦–å±æ¸²æŸ“æ—¶é—´ä¼˜åŒ–æ–¹æ¡ˆï¼Ÿ"></a>é¦–å±æ¸²æŸ“æ—¶é—´ä¼˜åŒ–æ–¹æ¡ˆï¼Ÿ</h3><ul><li><p>èµ„æºå¤ªå¤§ï¼Ÿèµ„æºå‹ç¼©ï¼Œä¼ è¾“å‹ç¼©ï¼Œä»£ç æ‹†åˆ†ï¼ŒTree sharkingï¼ŒHTTP/2ï¼Œç¼“å­˜ã€‚</p></li><li><p>é¦–é¡µå†…å®¹å¤ªå¤šï¼Ÿæ‡’åŠ è½½,é¢„æ¸²æŸ“ï¼ŒSSR</p></li><li><p>æ—¶åºé—®é¢˜ï¼Ÿprefetchï¼Œpreload</p></li></ul><h3 id="csp-æ˜¯ä»€ä¹ˆï¼Ÿä¼šé€ æˆä»€ä¹ˆé—®é¢˜ï¼Ÿ"><a href="#csp-æ˜¯ä»€ä¹ˆï¼Ÿä¼šé€ æˆä»€ä¹ˆé—®é¢˜ï¼Ÿ" class="headerlink" title="csp æ˜¯ä»€ä¹ˆï¼Ÿä¼šé€ æˆä»€ä¹ˆé—®é¢˜ï¼Ÿ"></a>csp æ˜¯ä»€ä¹ˆï¼Ÿä¼šé€ æˆä»€ä¹ˆé—®é¢˜ï¼Ÿ</h3><p>csp æ˜¯å†…å®¹å®‰å…¨ç­–ç•¥ï¼Œæ˜¯ä¸€ä¸ªé¢å¤–çš„å®‰å…¨å±‚ï¼Œç”¨äºæ£€æµ‹å¹¶å‰Šå¼±æŸäº›ç‰¹å®šç±»å‹çš„æ”»å‡»ï¼ŒåŒ…æ‹¬è·¨ç«™è„šæœ¬ (XSS) å’Œæ•°æ®æ³¨å…¥æ”»å‡»ç­‰ã€‚ä¹±ä¿®æ”¹å¯èƒ½å¼•èµ· XSSï¼Œæ•°æ®åŒ…å—…æ¢æ”»å‡»ã€‚</p><h3 id="typescript-ä¸­çš„-type-å’Œ-interface-çš„åŒºåˆ«ï¼Ÿ"><a href="#typescript-ä¸­çš„-type-å’Œ-interface-çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="typescript ä¸­çš„ type å’Œ interface çš„åŒºåˆ«ï¼Ÿ"></a>typescript ä¸­çš„ type å’Œ interface çš„åŒºåˆ«ï¼Ÿ</h3><ul><li><p>type å¯ä»¥å£°æ˜åŸºæœ¬ç±»å‹åˆ«åï¼Œè”åˆç±»å‹ï¼Œå…ƒç»„ç­‰ç±»å‹</p></li><li><p>type è¯­å¥ä¸­è¿˜å¯ä»¥ä½¿ç”¨ typeof è·å–å®ä¾‹çš„ ç±»å‹è¿›è¡Œèµ‹å€¼</p></li><li><p>interface èƒ½å¤Ÿå£°æ˜åˆå¹¶ã€‚</p></li><li><p>interface ä½¿ç”¨ extends æ‰©å±•ï¼Œtype ä½¿ç”¨äº¤å‰ç±»å‹(&amp;)æ‰©å±•</p></li></ul><h3 id="useCallback-å’Œ-useRef"><a href="#useCallback-å’Œ-useRef" class="headerlink" title="useCallback å’Œ useRef?"></a>useCallback å’Œ useRef?</h3><ul><li><p>userCallback è¿”å›çš„æ˜¯ä¸€ä¸ª memozied å‡½æ•°</p></li><li><p>useRef å¯ä»¥è¿”å›ä¸€ä¸ªå¯å˜çš„ ref å¯¹è±¡ï¼Œæœ¬è´¨ä¸Šï¼Œ<code>useRef</code> å°±åƒæ˜¯å¯ä»¥åœ¨å…¶ <code>.current</code> å±æ€§ä¸­ä¿å­˜ä¸€ä¸ªå¯å˜å€¼çš„â€œç›’å­â€ã€‚<code>useRef() </code>æ¯” <code>ref</code> å±æ€§æ›´æœ‰ç”¨ã€‚å®ƒå¯ä»¥å¾ˆæ–¹ä¾¿åœ°ä¿å­˜ä»»ä½•å¯å˜å€¼ã€‚å®ƒåˆ›å»ºçš„æ˜¯ä¸€ä¸ªæ™®é€š Javascript å¯¹è±¡ã€‚è€Œ <code>useRef()</code> å’Œè‡ªå»ºä¸€ä¸ª <code>&#123;current: ...&#125;</code> å¯¹è±¡çš„å”¯ä¸€åŒºåˆ«æ˜¯ï¼Œ<code>useRef</code> ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“æ—¶è¿”å›åŒä¸€ä¸ª <code>ref</code> å¯¹è±¡ã€‚</p></li></ul><h3 id="hook-çš„ä½¿ç”¨æ³¨æ„äº‹é¡¹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"><a href="#hook-çš„ä½¿ç”¨æ³¨æ„äº‹é¡¹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="hook çš„ä½¿ç”¨æ³¨æ„äº‹é¡¹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"></a>hook çš„ä½¿ç”¨æ³¨æ„äº‹é¡¹ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h3><p>ä¸è¦åœ¨å¾ªç¯ï¼Œæ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ Hookã€‚</p><p>åœ¨åˆå§‹åŒ–é˜¶æ®µï¼Œä¼šå°† hook çš„ç›¸å…³ä¿¡æ¯ä¿å­˜åœ¨ä¸€ä¸ª hook å¯¹è±¡å†…ï¼Œç„¶å hook å¯¹è±¡ä¹‹é—´ä»¥å•å‘é“¾è¡¨çš„å½¢å¼ä¸²è”ã€‚åœ¨æ›´æ–°é˜¶æ®µï¼ŒæŒ‰é¡ºåºå»éå†ä¹‹å‰æ„å»ºå¥½çš„é“¾è¡¨ï¼Œå–å‡ºå¯¹åº”çš„æ•°æ®ä¿¡æ¯è¿›è¡Œæ¸²æŸ“ã€‚hooks çš„æ¸²æŸ“æ˜¯é€šè¿‡â€œä¾æ¬¡éå†â€æ¥å®šä½æ¯ä¸ª hooks å†…å®¹çš„ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±åƒä»æ•°ç»„ä¸­ä¾æ¬¡å–å€¼ä¸€æ ·ï¼Œæ˜¯å®Œå…¨æŒ‰ç…§é¡ºåºï¼ˆæˆ–è€…è¯´ç´¢å¼•ï¼‰æ¥çš„ã€‚å› æ­¤ React ä¸ä¼šçœ‹ä½ å‘½åçš„å˜é‡åæ˜¯ä»€ä¹ˆã€‚å¦‚æœå‰åä¸¤æ¬¡è¯»åˆ°çš„é“¾è¡¨åœ¨é¡ºåºä¸Šå‡ºç°å·®å¼‚ï¼Œé‚£ä¹ˆæ¸²æŸ“çš„ç»“æœå°±ä¼šå‡ºé—®é¢˜ã€‚</p><p>ä»£ç é¢˜ï¼š</p><h3 id="26-è¿›åˆ¶è½¬æ¢ã€‚"><a href="#26-è¿›åˆ¶è½¬æ¢ã€‚" class="headerlink" title="26 è¿›åˆ¶è½¬æ¢ã€‚"></a>26 è¿›åˆ¶è½¬æ¢ã€‚</h3><blockquote><p>0-&gt;A, 1-&gt;B â€¦ 24-&gt;Y,25-&gt;Z,26-&gt;AA,27-&gt;ABâ€¦52-&gt;BA</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-keyword">const</span> convert26 = <span class="hljs-function">(<span class="hljs-params">num</span>)=&gt;</span>&#123;<br>  <span class="hljs-keyword">let</span> real = num + <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;&quot;</span>;<br>  <span class="hljs-keyword">while</span>(real &gt; <span class="hljs-number">0</span>)&#123;<br>    <span class="hljs-keyword">let</span> m = real % <span class="hljs-number">26</span>;<br>    <span class="hljs-keyword">if</span>(m === <span class="hljs-number">0</span>)&#123;<br>      m = <span class="hljs-number">26</span>;<br>    &#125;<br>    str = <span class="hljs-built_in">String</span>.fromCharCode ( m + <span class="hljs-number">64</span>) + str;<br>    real = (real - m) / <span class="hljs-number">26</span><br>  &#125;<br>  <span class="hljs-keyword">return</span> str;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å¶å­ç»“ç‚¹çš„å…¬å…±ç¥–å…ˆèŠ‚ç‚¹"><a href="#å¶å­ç»“ç‚¹çš„å…¬å…±ç¥–å…ˆèŠ‚ç‚¹" class="headerlink" title="å¶å­ç»“ç‚¹çš„å…¬å…±ç¥–å…ˆèŠ‚ç‚¹"></a>å¶å­ç»“ç‚¹çš„å…¬å…±ç¥–å…ˆèŠ‚ç‚¹</h3><blockquote><p>æ¯ä¸ªèŠ‚ç‚¹å‡å«æœ‰æŒ‡å‘å…¶çˆ¶èŠ‚ç‚¹çš„æŒ‡é’ˆå’Œ valï¼Œç»™ä¸¤ä¸ªå¶å­ç»“ç‚¹æ‰¾åˆ°ä»–ä»¬çš„å…¬å…±ç¥–å…ˆèŠ‚ç‚¹ã€‚è¦æ±‚ç©ºé—´å¤æ‚åº¦ä¸º O(1)</p></blockquote><p>æœ€å…ˆç»™äº†ä¸€ä¸ªç©ºé—´å¤æ‚åº¦ O(n)çš„æ€è·¯ã€‚</p><p>é€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹ä¸ºå¼€å§‹éå†ä¸€éå­˜å…¥ MAPï¼Œç¬¬äºŒä¸ªèŠ‚ç‚¹éå†çš„æ—¶å€™åˆ¤æ–­ MAP å†…æ˜¯å¦å­˜åœ¨å³å¯ã€‚</p><p>åé¢é—®é¢è¯•å®˜çš„æ—¶å€™é—®äº†è¿™é“é¢˜ï¼Œé¢è¯•å®˜è¯´ï¼Œè¿™ä¸ªå¯ä»¥å½“ä½œ<a href="https://leetcode-cn.com/problems/liang-ge-lian-biao-de-di-yi-ge-gong-gong-jie-dian-lcof/">ä¸¤ä¸ªé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…¬å…±èŠ‚ç‚¹</a>æ¥åšã€‚æç„¶å¤§æ‚Ÿã€‚ç„¶åè¿˜ç»™æˆ‘è¯¦ç»†è§£è¯´äº†ï¼Œç©ºé—´æ¢æ—¶é—´ï¼Œæ—¶é—´æ¢ç©ºé—´çš„äº‹æƒ…ï¼Œè±ç„¶å¼€æœ—ã€‚</p><p>æ€è·¯å°±æ˜¯ï¼šéå†å®Œè‡ªå·±çš„èŠ‚ç‚¹å äº¤æ¢ä½ç½®ç»§ç»­éå† æœ€åäºŒè€…çš„æ€»æ­¥æ•°æ˜¯ä¸€æ · ç›¸é‡æ—¶å³ä¸ºæ‰€æ±‚ç¬¬ä¸€ä¸ªç¥–å…ˆèŠ‚ç‚¹</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-keyword">var</span> getIntersectionNode = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">headA, headB</span>) </span>&#123;<br>    <span class="hljs-keyword">let</span> firstH = headA, secondH = headB<br><br>    <span class="hljs-keyword">while</span> (firstH !== secondH) &#123;<br>        firstH = firstH ? firstH.next : headB<br>        secondH = secondH ? secondH.next : headA<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> firstH;<br><br>&#125;;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>é¢ç»</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é¢ç»</tag>
      
      <tag>å­—èŠ‚è·³åŠ¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ€§èƒ½ä¼˜åŒ–ä¹‹ä¼ è¾“åŠ è½½ä¼˜åŒ–</title>
    <link href="/article/adf14e0a/"/>
    <url>/article/adf14e0a/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¼ è¾“å‹ç¼©æ–¹æ¡ˆ-GZip"><a href="#ä¼ è¾“å‹ç¼©æ–¹æ¡ˆ-GZip" class="headerlink" title="ä¼ è¾“å‹ç¼©æ–¹æ¡ˆ-GZip"></a>ä¼ è¾“å‹ç¼©æ–¹æ¡ˆ-GZip</h2><p>å¯¹ä¼ è¾“èµ„æºè¿›è¡Œä½“ç§¯å‹ç¼©ï¼Œå¯ä»¥é«˜è¾¾90%</p><p>ä»¥ä¸‹ä¸ºnginxé…ç½®</p><figure class="highlight properties"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs properties"><span class="hljs-attr">gzip</span> <span class="hljs-string">on;</span><br><span class="hljs-attr">gzip_min_length</span> <span class="hljs-string">1k; # æ–‡ä»¶æœ€å°å¯ç”¨å‹ç¼©å¤§å°</span><br><span class="hljs-attr">gzip_comp_level</span> <span class="hljs-string">6; # å‹ç¼©çº§åˆ«1-9 ç­‰çº§è¶Šé«˜CPUæ¶ˆè€—è¶Šé«˜</span><br><span class="hljs-attr">gzip_types</span> <span class="hljs-string">text/plain application/javascript application/x-javascript text/css application/xml text/xml text/javascript application/json; # æ–‡ä»¶å‹ç¼©ç±»å‹ï¼Œä¸€èˆ¬é‡ç‚¹å‹ç¼©æ–‡æœ¬ç±»å‹ï¼Œå›¾ç‰‡å‹ç¼©ä½¿ç”¨gzipæ¶ˆè€—å¤§ï¼Œæ”¶ç›Šå°ã€‚</span><br><span class="hljs-attr">gzip_static</span> <span class="hljs-string">on; # å·²ç»å‹ç¼©è¿‡çš„èµ„æºå¯ä»¥ç›´æ¥ç”¨</span><br><span class="hljs-attr">gzip_vary</span> <span class="hljs-string">on;# å“åº”å¤´æ·»åŠ varyå±æ€§ï¼Œå‘ŠçŸ¥å®¢æˆ·ç«¯å¯ç”¨gzipå‹ç¼©</span><br><span class="hljs-attr">gzip_buffers</span> <span class="hljs-string">4 16k; #ä½¿ç”¨bufferä¼˜åŒ–å‹ç¼©è¿‡ç¨‹</span><br><span class="hljs-attr">gzip_http_version</span> <span class="hljs-string">1.1; #ä½¿ç”¨gzipçš„httpç‰ˆæœ¬</span><br></code></pre></div></td></tr></table></figure><h2 id="å¤ç”¨TCPé“¾æ¥-Keep-Alive"><a href="#å¤ç”¨TCPé“¾æ¥-Keep-Alive" class="headerlink" title="å¤ç”¨TCPé“¾æ¥-Keep Alive"></a>å¤ç”¨TCPé“¾æ¥-Keep Alive</h2><p>ä¸éœ€è¦é‡å¤å»ºç«‹é“¾æ¥ï¼ŒèŠ‚çœäº†é“¾æ¥åˆ›å»ºæ—¶é—´ã€‚</p><p>Chrome-DevTools-NetWork-waterfall-Initial connectionåªå‡ºç°åœ¨ç¬¬ä¸€ä¸ªè¯·æ±‚ï¼Œåç»­æ²¡æœ‰è¿™æ®µæ¶ˆè€—çš„æ—¶é—´ã€‚</p><p>å¯ä»¥é€šè¿‡response Headers-connectionï¼škeep-aliveæŸ¥çœ‹æ˜¯å¦å¼€å¯</p><p>ä»¥ä¸‹ä¸ºnginxé…ç½®ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs properties"><span class="hljs-attr">keepalive_timeout</span> <span class="hljs-string">65; # è¶…æ—¶æ—¶é—´ï¼Œè¶…è¿‡è¯¥æ—¶é—´ä¸ä½¿ç”¨å°±ä¼šå…³é—­ã€‚0è¡¨ç¤ºä¸å¯ç”¨</span><br><span class="hljs-attr">keepalive_requests</span> <span class="hljs-string">100; # åˆ©ç”¨è¯¥TCPé“¾æ¥å¯ä»¥å‘èµ·å¤šå°‘ä¸ªè¯·æ±‚ã€‚</span><br></code></pre></div></td></tr></table></figure><h2 id="HTTPèµ„æºç¼“å­˜"><a href="#HTTPèµ„æºç¼“å­˜" class="headerlink" title="HTTPèµ„æºç¼“å­˜"></a>HTTPèµ„æºç¼“å­˜</h2><p>æé«˜é‡å¤è®¿é—®æ—¶èµ„æºåŠ è½½çš„é€Ÿåº¦ã€‚</p><ul><li><p>Cache-Control/Expires</p></li><li><p>Last-Modified + If-Modified-Sinceï¼šç­‰ä»·äºç¬¬ä¸‰ç§ï¼Œä½†æ²¡æœ‰ç¬¬ä¸‰ç§å¥½ç”¨ï¼šè·Ÿæ—¶é—´æœ‰å…³çš„ï¼Œå¦‚æœæœ¬åœ°å’ŒæœåŠ¡å™¨æ—¶é—´ä¸åŒæ­¥ä¼šæœ‰å‘ã€‚</p></li><li><p>ETag + If-None-Matchï¼šæœåŠ¡ç«¯å…ˆå¯¹æ–‡ä»¶ç”Ÿæˆå”¯ä¸€æ ‡è¯†ETagï¼Œåœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚çš„æ—¶å€™å¸¦å›æ¥ï¼Œç¬¬äºŒæ¬¡è¯·æ±‚çš„æ—¶å€™è¯·æ±‚å¤´ä¼šæœ‰If-None-Matchï¼šETagå€¼çš„å½¢å¼ï¼Œå¦‚æœETagä¸åŒ¹é…å°±æ‹¿æ–°èµ„æºï¼ŒåŒ¹é…å°±è¿”å›304ã€‚</p></li></ul><figure class="highlight properties"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs properties"><span class="hljs-meta">if($request_filename</span> <span class="hljs-string">~* .*\.(?:htm|html)$) # åŒ¹é…HTMLï¼Œæ‰€æœ‰çš„èµ„æºéƒ½æ˜¯é€šè¿‡htmlè¿›è¡ŒåŠ è½½çš„ï¼Œç¼“å­˜å¯èƒ½å¯¼è‡´ç”¨æˆ·æ‹¿ä¸åˆ°æœ€æ–°å†…å®¹ã€‚</span><br><span class="hljs-meta">&#123;</span> <span class="hljs-string"></span><br>    <span class="hljs-attr">add_header</span> <span class="hljs-string">Cache-Control &quot;no-cache, must-revalidate&quot;; # HTTP1.1 å‘ŠçŸ¥æµè§ˆå™¨ä¸éœ€è¦ç¼“å­˜ï¼Œéœ€è¦çš„æ—¶å€™å°±å»è·å–ï¼Œè·å–å®Œæˆåé‡æ–°éªŒè¯ã€‚</span><br>    <span class="hljs-attr">add_header</span> <span class="hljs-string">&quot;Pragma&quot; &quot;no-cache&quot;; # è€ƒè™‘å…¼å®¹æ€§ï¼Œå‘ŠçŸ¥HTTP1.0çš„æµè§ˆå™¨ä¸è¦ç¼“å­˜</span><br>    <span class="hljs-attr">add_header</span> <span class="hljs-string">&quot;Expires&quot; &quot;0&quot;; # 0æˆ–è€…è´Ÿæ•°ä»£è¡¨å‘ŠçŸ¥æµè§ˆå™¨ç«‹å³è¿‡æœŸã€‚</span><br>  <span class="hljs-attr">&#125;</span><br><span class="hljs-meta">if($request_filename</span> <span class="hljs-string">~* .*\.(?:js|css)$) # åŒ¹é…jså’Œcss</span><br><span class="hljs-attr">&#123;</span><br>  <span class="hljs-attr">expires</span> <span class="hljs-string">7d; # æµè§ˆå™¨ç¼“å­˜7å¤©</span><br><span class="hljs-attr">&#125;</span><br><span class="hljs-meta">if($request_filename</span> <span class="hljs-string">~* .*\.(?:jpg|jpeg|gif|png|ico|cur|gz|svg|svgz|mp4|ogg|ogv|webm)$) # åŒ¹é…å›¾ç‰‡èµ„æºç­‰</span><br><span class="hljs-attr">&#123;</span><br>  <span class="hljs-attr">expires</span> <span class="hljs-string">7d; # æµè§ˆå™¨ç¼“å­˜7å¤©</span><br><span class="hljs-attr">&#125;</span><br></code></pre></div></td></tr></table></figure><h2 id="Service-Workers"><a href="#Service-Workers" class="headerlink" title="Service Workers"></a><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Service_Worker_API/Using_Service_Workers">Service Workers</a></h2><h3 id="Service-Workersä½œç”¨"><a href="#Service-Workersä½œç”¨" class="headerlink" title="Service Workersä½œç”¨"></a>Service Workersä½œç”¨</h3><ul><li><p>åŠ é€Ÿé‡å¤è®¿é—®</p></li><li><p>ç¦»çº¿æ”¯æŒ</p></li></ul><h3 id="Service-WorkersåŸç†"><a href="#Service-WorkersåŸç†" class="headerlink" title="Service WorkersåŸç†"></a>Service WorkersåŸç†</h3><p>åœ¨æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯ä¸­é—´åŠ ä¸€ä¸ªä¸­é—´å±‚ï¼šService Workersï¼ˆåœ¨å®¢æˆ·ç«¯ï¼‰ï¼Œåˆæ¬¡è¯·æ±‚ç»è¿‡ServiceWorkersçš„æ—¶å€™ï¼Œè¿›è¡Œç¼“å­˜ï¼Œå†æ¬¡è¯·æ±‚çš„æ—¶å€™ç›´æ¥è¯·æ±‚ServiceWorkersã€‚</p><h3 id="Service-Workersé—®é¢˜"><a href="#Service-Workersé—®é¢˜" class="headerlink" title="Service Workersé—®é¢˜"></a>Service Workersé—®é¢˜</h3><ul><li><p>å»¶é•¿äº†é¦–å±æ—¶é—´ï¼Œä½†é¡µé¢æ€»åŠ è½½æ—¶é—´å‡å°‘</p></li><li><p>å…¼å®¹æ€§ï¼ˆç›®å‰åŸºæœ¬éƒ½æ˜¯æ”¯æŒäº†ï¼‰</p></li><li><p>åªèƒ½åœ¨localhostæˆ–httpsä¸‹ä½¿ç”¨</p></li></ul><h2 id="HTTP-2"><a href="#HTTP-2" class="headerlink" title="HTTP/2"></a>HTTP/2</h2><h3 id="ä¼˜åŠ¿"><a href="#ä¼˜åŠ¿" class="headerlink" title="ä¼˜åŠ¿"></a>ä¼˜åŠ¿</h3><ul><li><p>äºŒè¿›åˆ¶ä¼ è¾“</p></li><li><p>è¯·æ±‚å“åº”å¤šè·¯å¤ç”¨ï¼šå¼‚æ­¥è¯·æ±‚å“åº”èµ„æº</p></li><li><p>server pushï¼šå¯ä»¥çœç•¥TTFBæ—¶é—´</p></li></ul><h3 id="æ­å»ºHTTP-2æœåŠ¡"><a href="#æ­å»ºHTTP-2æœåŠ¡" class="headerlink" title="æ­å»ºHTTP/2æœåŠ¡"></a>æ­å»ºHTTP/2æœåŠ¡</h3><ul><li><p>HTTPSä¸ºåŸºç¡€</p></li><li><p>é€‚åˆè¾ƒé«˜çš„è¯·æ±‚é‡</p></li></ul><h2 id="æœåŠ¡ç«¯æ¸²æŸ“"><a href="#æœåŠ¡ç«¯æ¸²æŸ“" class="headerlink" title="æœåŠ¡ç«¯æ¸²æŸ“"></a>æœåŠ¡ç«¯æ¸²æŸ“</h2><h3 id="å¥½å¤„"><a href="#å¥½å¤„" class="headerlink" title="å¥½å¤„"></a>å¥½å¤„</h3><ul><li><p>åŠ é€Ÿé¦–å±æ¸²æŸ“</p></li><li><p>å‹å¥½çš„SEO</p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/SSR.png" alt="CSRä¸SSR"></p><h3 id="é€‚åˆSSRçš„æƒ…å†µ"><a href="#é€‚åˆSSRçš„æƒ…å†µ" class="headerlink" title="é€‚åˆSSRçš„æƒ…å†µ"></a>é€‚åˆSSRçš„æƒ…å†µ</h3><ul><li><p>æ¶æ„-å¤§å‹ï¼ŒåŠ¨æ€é¡µé¢ï¼Œé¢å‘å…¬ä¼—ç”¨æˆ·</p></li><li><p>æœç´¢å¼•æ“æ’åå¾ˆé‡è¦</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ€§èƒ½ä¼˜åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç½‘ç»œä¼ è¾“</tag>
      
      <tag>nginx</tag>
      
      <tag>HTTP2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ€§èƒ½ä¼˜åŒ–ä¹‹æ„å»ºä¼˜åŒ–</title>
    <link href="/article/1148eb19/"/>
    <url>/article/1148eb19/</url>
    
    <content type="html"><![CDATA[<h2 id="Tree-shaking"><a href="#Tree-shaking" class="headerlink" title="Tree-shaking"></a><a href="https://webpack.docschina.org/guides/tree-shaking/">Tree-shaking</a></h2><p>å°†ä¸Šä¸‹æ–‡æœªç”¨åˆ°çš„ä»£ç åˆ æ‰ï¼Œä¸ä¼šæ‰“åŒ…åˆ°æœ€ç»ˆæ–‡ä»¶ä¸­ï¼ˆåŸºäºES6çš„æ¨¡å—åŒ–æ‰å¯ä»¥ï¼‰ï¼Œæ¥è¾¾åˆ°å‡å°JSæ–‡ä»¶å¤§å°çš„ç›®çš„</p><p>æœ‰äº›ä»£ç å¯èƒ½ä¼šå½±å“åˆ°å…¨å±€ä½œç”¨åŸŸæˆ–æ²¡æœ‰ç”¨ES6çš„æ¨¡å—åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®<code>package.json</code>ä¸­çš„<code>sideEffects</code>æ¥æŒ‡å®šä¸å¸Œæœ›è¢«shakingæ‰çš„æ–‡ä»¶ï¼ˆåœ¨å¯¼å…¥æ—¶ä¼šæ‰§è¡Œç‰¹æ®Šè¡Œä¸ºçš„ä»£ç ï¼Œè€Œä¸æ˜¯ä»…ä»…æš´éœ²ä¸€ä¸ª export æˆ–å¤šä¸ª exportã€‚ä¸¾ä¾‹è¯´æ˜ï¼Œä¾‹å¦‚ polyfillï¼Œå®ƒå½±å“å…¨å±€ä½œç”¨åŸŸï¼Œå¹¶ä¸”é€šå¸¸ä¸æä¾› exportã€‚ï¼‰</p><p>æ³¨æ„babelé»˜è®¤é…ç½®çš„å½±å“ï¼šå¯èƒ½ä¼šå°†es6çš„æ¨¡å—åŒ–è¯­æ³•æ›¿æ¢ä¸ºå…¼å®¹es5çš„å…¶ä»–æ¨¡å—åŒ–è¯­æ³•ã€‚</p><p>webpack 5ï¼šå·²ç»é»˜è®¤é›†æˆterser-webpack-pluginæ¥å‹ç¼©JS</p><h2 id="ä½œç”¨åŸŸæå‡"><a href="#ä½œç”¨åŸŸæå‡" class="headerlink" title="ä½œç”¨åŸŸæå‡"></a>ä½œç”¨åŸŸæå‡</h2><p>æœªå¯ç”¨ï¼šwebpackå°†æ¨¡å—æ‰“åŒ…æˆå•ç‹¬çš„æ¨¡å—ï¼Œæœ‰ä¾èµ–å…³ç³»éƒ¨åˆ†ä¼šé€šè¿‡webpack_requireè¿›æ¥ï¼Œå†è°ƒç”¨ã€‚</p><p>å¯åŠ¨ï¼šå…ˆåˆ†æï¼Œç„¶åå°†ä¾èµ–æå‡æˆ–åˆå¹¶ä¸ºä¸€ä¸ªé—­åŒ…ï¼Œæ¥è¾¾åˆ°å‹ç¼©ä»£ç ä½“ç§¯çš„ç›®çš„ï¼Œæé«˜æ‰§è¡Œæ•ˆç‡ã€‚ï¼ˆå…·ä½“å¯è§webpackæ’ä»¶<a href="https://webpack.docschina.org/plugins/module-concatenation-plugin/#root">ModuleConcatenationPlugin</a>ï¼‰</p><h2 id="Babel7ä¼˜åŒ–é…ç½®"><a href="#Babel7ä¼˜åŒ–é…ç½®" class="headerlink" title="Babel7ä¼˜åŒ–é…ç½®"></a>Babel7ä¼˜åŒ–é…ç½®</h2><h3 id="åœ¨éœ€è¦çš„åœ°æ–¹å¼•å…¥polyfill"><a href="#åœ¨éœ€è¦çš„åœ°æ–¹å¼•å…¥polyfill" class="headerlink" title="åœ¨éœ€è¦çš„åœ°æ–¹å¼•å…¥polyfill"></a>åœ¨éœ€è¦çš„åœ°æ–¹å¼•å…¥polyfill</h3><p>å°†<code>useBuiltIns</code>è®¾ç½®ä¸º<code>usage</code>.</p><p>å„ä¸ªå±æ€§å€¼çš„è¾“å…¥ä¸è¾“å‡ºå·®å¼‚å¯è§ï¼š<a href="https://www.babeljs.cn/docs/babel-preset-env#usebuiltins">useBuiltInsè¯¦ç»†è¯´æ˜</a></p><h3 id="è¾…åŠ©å‡½æ•°çš„æŒ‰éœ€å¼•å…¥-å¤ç”¨"><a href="#è¾…åŠ©å‡½æ•°çš„æŒ‰éœ€å¼•å…¥-å¤ç”¨" class="headerlink" title="è¾…åŠ©å‡½æ•°çš„æŒ‰éœ€å¼•å…¥/å¤ç”¨"></a>è¾…åŠ©å‡½æ•°çš„æŒ‰éœ€å¼•å…¥/å¤ç”¨</h3><p><a href="https://www.babeljs.cn/docs/babel-plugin-transform-runtime#docsNav">@babel/plugin-transform-runtime</a>ï¼šé‡ç”¨ Babel æ³¨å…¥çš„å¸®åŠ©å™¨ä»£ç æ¥å‡å°‘ä»£ç ä½“ç§¯</p><h3 id="æ ¹æ®ç›®æ ‡æµè§ˆå™¨æŒ‰éœ€è½¬æ¢ä»£ç "><a href="#æ ¹æ®ç›®æ ‡æµè§ˆå™¨æŒ‰éœ€è½¬æ¢ä»£ç " class="headerlink" title="æ ¹æ®ç›®æ ‡æµè§ˆå™¨æŒ‰éœ€è½¬æ¢ä»£ç "></a>æ ¹æ®ç›®æ ‡æµè§ˆå™¨æŒ‰éœ€è½¬æ¢ä»£ç </h3><p>éœ€è¦æ”¯æŒçš„ç‰ˆæœ¬è¶Šå°‘ï¼Œä»£ç ä½“ç§¯è¶Šå°ã€‚</p><p>é€šè¿‡<code>target:browsers</code>å±æ€§è®¾ç½®ã€‚<a href="https://github.com/browserslist/browserslist#full-list">browserså¯å¡«å†™çš„å€¼</a></p><h2 id="webpackçš„ä¾èµ–ä¼˜åŒ–"><a href="#webpackçš„ä¾èµ–ä¼˜åŒ–" class="headerlink" title="webpackçš„ä¾èµ–ä¼˜åŒ–"></a>webpackçš„ä¾èµ–ä¼˜åŒ–</h2><p>æé«˜æ„å»ºé€Ÿåº¦ï¼Œä¸»è¦å½±å“å¼€å‘ç¯å¢ƒ</p><h3 id="noParse"><a href="#noParse" class="headerlink" title="noParse"></a>noParse</h3><p>ç›´æ¥é€šçŸ¥webpackå¿½ç•¥è¾ƒå¤§çš„åº“ï¼šè¢«å¿½ç•¥çš„åº“ä¸èƒ½æœ‰importï¼Œrequireï¼Œdefineçš„å¼•å…¥æ–¹å¼</p><h3 id="DllPlugin"><a href="#DllPlugin" class="headerlink" title="DllPlugin"></a><a href="https://webpack.docschina.org/plugins/dll-plugin/#root">DllPlugin</a></h3><p>é¿å…å¼€å‘ç¯å¢ƒæ‰“åŒ…æ—¶å¯¹ä¸å˜çš„é‡å¤çš„åº“é‡å¤æ„å»º</p><p>eg.:</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-comment">//webpack.dll.config.js</span><br><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;webpack&quot;</span>);<br><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&quot;production&quot;</span>,<br>    <span class="hljs-attr">entry</span>: &#123;<br>        <span class="hljs-attr">react</span>: [<span class="hljs-string">&quot;react&quot;</span>, <span class="hljs-string">&quot;react-dom&quot;</span>],<br>    &#125;,<br>    <span class="hljs-attr">output</span>: &#123;<br>        <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;[name].dll.js&quot;</span>,<br>        <span class="hljs-attr">path</span>: path.resolve(__dirname, <span class="hljs-string">&quot;dll&quot;</span>),<br>        <span class="hljs-attr">library</span>: <span class="hljs-string">&quot;[name]&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-keyword">new</span> webpack.DllPlugin(&#123;<br>            <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;[name]&quot;</span>,<br>            <span class="hljs-attr">path</span>: path.resolve(__dirname, <span class="hljs-string">&quot;dll/[name].manifest.json&quot;</span>)<br>        &#125;)<br>    ]<br>&#125;;<br><br><span class="hljs-comment">//webpack.config.js</span><br><span class="hljs-keyword">const</span> DllReferencePlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack/lib/DllReferencePlugin&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports =&#123;<br>  ...,<br>  <span class="hljs-attr">plugins</span>:[<br>    <span class="hljs-keyword">new</span> DllReferencePlugin(&#123;<br>            <span class="hljs-attr">manifest</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;__dirname&#125;</span>/dll/react.manifest.json`</span>)<br>        &#125;)<br>  ],<br>  ...<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="ä»£ç æ‹†åˆ†"><a href="#ä»£ç æ‹†åˆ†" class="headerlink" title="ä»£ç æ‹†åˆ†"></a>ä»£ç æ‹†åˆ†</h2><p>æŠŠå•ä¸ªbundleæ–‡ä»¶æ‹†åˆ†æˆè‹¥å¹²ä¸ªå°çš„bundles/chunksï¼Œä»¥è¾¾åˆ°ç¼©çŸ­é¦–å±åŠ è½½æ—¶é—´</p><h3 id="æ‰‹å·¥å®šä¹‰å…¥å£ï¼ˆè ¢æ–¹æ³•ï¼Œä¸æ¨èï¼‰"><a href="#æ‰‹å·¥å®šä¹‰å…¥å£ï¼ˆè ¢æ–¹æ³•ï¼Œä¸æ¨èï¼‰" class="headerlink" title="æ‰‹å·¥å®šä¹‰å…¥å£ï¼ˆè ¢æ–¹æ³•ï¼Œä¸æ¨èï¼‰"></a>æ‰‹å·¥å®šä¹‰å…¥å£ï¼ˆè ¢æ–¹æ³•ï¼Œä¸æ¨èï¼‰</h3><p>æ‰‹åŠ¨æŒ‡å®šå¤šä¸ªentryï¼Œç”¨åˆ°çš„ä¸€äº›å…¬å…±éƒ¨åˆ†ä¼šé‡å¤æ‰“åŒ…</p><h3 id="splitChunks"><a href="#splitChunks" class="headerlink" title="splitChunks"></a>splitChunks</h3><ul><li><a href="https://webpack.docschina.org/plugins/split-chunks-plugin/">splitChunks</a>æå–å…¬æœ‰ä»£ç ï¼Œæ‹†åˆ†ä¸šåŠ¡ä»£ç ä¸ç¬¬ä¸‰æ–¹åº“.</li></ul><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-built_in">module</span>.exports=&#123;<br>  ...,<br>  <span class="hljs-attr">optimization</span>: &#123;<br>    <span class="hljs-attr">splitChunks</span>: &#123;<br>      <span class="hljs-attr">cacheGroups</span>: &#123; <span class="hljs-comment">//è®¾ç½®ç¼“å­˜ç»„</span><br>        <span class="hljs-attr">vendor</span>: &#123;<span class="hljs-comment">//ç¬¬ä¸‰æ–¹åº“</span><br>            <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;vendor&#x27;</span>,<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]/</span>,<br>            minSize: <span class="hljs-number">0</span>, <br>            <span class="hljs-attr">minChunks</span>: <span class="hljs-number">1</span>,<br>            <span class="hljs-attr">priority</span>: <span class="hljs-number">10</span>,<br>            <span class="hljs-attr">chunks</span>: <span class="hljs-string">&#x27;initial&#x27;</span><br>        &#125;,<br>        <span class="hljs-attr">common</span>: &#123;<span class="hljs-comment">//ä¸šåŠ¡ä»£ç </span><br>            <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;common&#x27;</span>,<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]src[\\/]/</span>,<br>            chunks: <span class="hljs-string">&#x27;all&#x27;</span>,<span class="hljs-comment">//</span><br>            <span class="hljs-attr">minSize</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-attr">minChunks</span>: <span class="hljs-number">2</span><br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;,<br>  ...<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="åŠ¨æ€åŠ è½½"><a href="#åŠ¨æ€åŠ è½½" class="headerlink" title="åŠ¨æ€åŠ è½½"></a>åŠ¨æ€åŠ è½½</h3><p><a href="https://react.docschina.org/docs/concurrent-mode-suspense.html">Suspense</a></p><h2 id="èµ„æºå‹ç¼©"><a href="#èµ„æºå‹ç¼©" class="headerlink" title="èµ„æºå‹ç¼©"></a>èµ„æºå‹ç¼©</h2><h3 id="Minification"><a href="#Minification" class="headerlink" title="Minification"></a><a href="https://webpack.docschina.org/guides/production/#minification">Minification</a></h3><ul><li><p>Terser å‹ç¼©JS</p></li><li><p>mini-css-extract-pluginå’Œoptimize-css-assets-webpack-plugin/CssMinimizerWebpackPlugin  æå–ä¸å‹ç¼©css</p></li><li><p>HtmlWebpackPlugin ç”ŸæˆHTMlå¹¶å‹ç¼©</p></li></ul><h2 id="èµ„æºæŒä¹…åŒ–ç¼“å­˜"><a href="#èµ„æºæŒä¹…åŒ–ç¼“å­˜" class="headerlink" title="èµ„æºæŒä¹…åŒ–ç¼“å­˜"></a>èµ„æºæŒä¹…åŒ–ç¼“å­˜</h2><p>æ¯ä¸ªæ‰“åŒ…çš„èµ„æºæ–‡ä»¶æœ‰å”¯ä¸€çš„hashå€¼ï¼Œä¿®æ”¹ååªæœ‰å—å½±å“çš„æ–‡ä»¶hashå˜åŒ–ï¼Œå¯ä»¥åšå¢é‡å¼æ›´æ–°ï¼Œå……åˆ†åˆ©ç”¨æµè§ˆå™¨ç¼“å­˜ã€‚</p><p>åœ¨webpackè¾“å‡ºæ–‡ä»¶çš„æ—¶å€™ï¼Œfilenameå’ŒchunkFilenameç”¨å‘½åæ—¶ä½¿ç”¨å˜é‡<code>[contenthash]</code></p><h2 id="åº”ç”¨å¤§å°ç›‘æµ‹ä¸åˆ†æ"><a href="#åº”ç”¨å¤§å°ç›‘æµ‹ä¸åˆ†æ" class="headerlink" title="åº”ç”¨å¤§å°ç›‘æµ‹ä¸åˆ†æ"></a>åº”ç”¨å¤§å°ç›‘æµ‹ä¸åˆ†æ</h2><h3 id="Statsåˆ†æä¸å¯è§†åŒ–å›¾è¡¨"><a href="#Statsåˆ†æä¸å¯è§†åŒ–å›¾è¡¨" class="headerlink" title="Statsåˆ†æä¸å¯è§†åŒ–å›¾è¡¨"></a>Statsåˆ†æä¸å¯è§†åŒ–å›¾è¡¨</h3><p>åœ¨ç»ˆç«¯è¾“å…¥<code>webpack --profile --json &gt; stats.json</code></p><p><a href="https://alexkuz.github.io/webpack-chart/">Webpack Chart</a></p><h3 id="webpack-bundle-analyzerè¿›è¡Œä½“ç§¯åˆ†æ"><a href="#webpack-bundle-analyzerè¿›è¡Œä½“ç§¯åˆ†æ" class="headerlink" title="webpack-bundle-analyzerè¿›è¡Œä½“ç§¯åˆ†æ"></a>webpack-bundle-analyzerè¿›è¡Œä½“ç§¯åˆ†æ</h3><ul><li><p><code>webpack --analyze</code></p></li><li><p><code>yarn add source-map-explorer</code>ï¼šéœ€è¦webpackä¸­å¼€å¯devtoolç”Ÿæˆsource-map</p></li></ul><h3 id="speed-measure-webpack-pluginé€Ÿåº¦åˆ†æ"><a href="#speed-measure-webpack-pluginé€Ÿåº¦åˆ†æ" class="headerlink" title="speed-measure-webpack-pluginé€Ÿåº¦åˆ†æ"></a>speed-measure-webpack-pluginé€Ÿåº¦åˆ†æ</h3><p><a href="https://www.npmjs.com/package/speed-measure-webpack-plugin">speed-measure-webpack-plugin</a></p><h2 id="ReactæŒ‰éœ€åŠ è½½çš„å®ç°"><a href="#ReactæŒ‰éœ€åŠ è½½çš„å®ç°" class="headerlink" title="ReactæŒ‰éœ€åŠ è½½çš„å®ç°"></a>ReactæŒ‰éœ€åŠ è½½çš„å®ç°</h2><h3 id="React-RouteråŸºäºwebpackæŒ‰éœ€åŠ è½½ï¼Œä½¿ç”¨loadable-componentåŒ…è£…æˆHOC"><a href="#React-RouteråŸºäºwebpackæŒ‰éœ€åŠ è½½ï¼Œä½¿ç”¨loadable-componentåŒ…è£…æˆHOC" class="headerlink" title="React RouteråŸºäºwebpackæŒ‰éœ€åŠ è½½ï¼Œä½¿ç”¨loadable/componentåŒ…è£…æˆHOC"></a>React RouteråŸºäºwebpackæŒ‰éœ€åŠ è½½ï¼Œä½¿ç”¨loadable/componentåŒ…è£…æˆHOC</h3><p>ä½¿ç”¨<a href="https://www.npmjs.com/package/@loadable/component">@loadable/component</a></p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-keyword">const</span> LoadableComp = loadable(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;./Component.jsx&#x27;</span>), &#123;<br>    <span class="hljs-attr">fallback</span>: <span class="hljs-string">&#x27;&lt;div&gt;loading...&lt;/div&gt;&#x27;</span><br>&#125;);<br></code></pre></div></td></tr></table></figure><blockquote><p><a href="https://segmentfault.com/a/1190000022205477">webpackä¼˜åŒ–</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>æ€§èƒ½ä¼˜åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>webpack</tag>
      
      <tag>babel</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ€§èƒ½ä¼˜åŒ–ä¹‹èµ„æºä¼˜åŒ–</title>
    <link href="/article/c32e6a1d/"/>
    <url>/article/c32e6a1d/</url>
    
    <content type="html"><![CDATA[<h2 id="èµ„æºçš„å‹ç¼©ä¸åˆå¹¶"><a href="#èµ„æºçš„å‹ç¼©ä¸åˆå¹¶" class="headerlink" title="èµ„æºçš„å‹ç¼©ä¸åˆå¹¶"></a>èµ„æºçš„å‹ç¼©ä¸åˆå¹¶</h2><h3 id="ä¸ºä»€ä¹ˆè¦å‹ç¼©-amp-åˆå¹¶"><a href="#ä¸ºä»€ä¹ˆè¦å‹ç¼©-amp-åˆå¹¶" class="headerlink" title="ä¸ºä»€ä¹ˆè¦å‹ç¼©&amp;åˆå¹¶"></a>ä¸ºä»€ä¹ˆè¦å‹ç¼©&amp;åˆå¹¶</h3><ul><li><p>å‡å°‘httpè¯·æ±‚æ•°é‡</p></li><li><p>å‡å°‘è¯·æ±‚èµ„æºçš„å¤§å°</p></li></ul><h3 id="HTML-amp-CSSå‹ç¼©"><a href="#HTML-amp-CSSå‹ç¼©" class="headerlink" title="HTML&amp;CSSå‹ç¼©"></a>HTML&amp;CSSå‹ç¼©</h3><ul><li><p>ä½¿ç”¨åœ¨çº¿å·¥å…·è¿›è¡Œå‹ç¼©</p></li><li><p>ä½¿ç”¨ç¬¬ä¸‰æ–¹NPMåŒ…çš„å·¥å…·</p></li><li><p>ä½¿ç”¨webpackçš„plugin</p></li></ul><h3 id="JSå‹ç¼©ä¸æ··æ·†"><a href="#JSå‹ç¼©ä¸æ··æ·†" class="headerlink" title="JSå‹ç¼©ä¸æ··æ·†"></a>JSå‹ç¼©ä¸æ··æ·†</h3><ul><li><p>ä½¿ç”¨åœ¨çº¿å·¥å…·è¿›è¡Œå‹ç¼©</p></li><li><p>ä½¿ç”¨webpackå¯¹jsåœ¨æ„å»ºæ—¶å‹ç¼©ä¸æ··æ·†</p></li></ul><h3 id="CSS-JSæ–‡ä»¶åˆå¹¶"><a href="#CSS-JSæ–‡ä»¶åˆå¹¶" class="headerlink" title="CSS/JSæ–‡ä»¶åˆå¹¶"></a>CSS/JSæ–‡ä»¶åˆå¹¶</h3><p>ä¼˜ç‚¹ï¼šåªè¿›è¡Œä¸€æ¬¡TCP/IPé“¾æ¥ï¼Œå‡å°‘ä¸‰æ¬¡æ¡æ‰‹ï¼ŒTTFBç­‰æ—¶é—´æ¶ˆè€—<br>ç¼ºç‚¹ï¼šæ–‡ä»¶è¿‡å¤§çš„æƒ…å†µä¸‹ï¼Œæ–‡ä»¶ä¸‹è½½è€—æ—¶é•¿ï¼Œè§£ææ—¶é—´é•¿ã€‚å¦‚æœåˆå¹¶æˆä¸€ä¸ªæ–‡ä»¶ï¼Œæœ‰ä¸€ä¸ªå­æ–‡ä»¶æ”¹åŠ¨ï¼Œç¼“å­˜å°±ä¼šå¤±æ•ˆï¼Œéœ€è¦é‡æ–°åŠ è½½æ•´ä¸ªæ–‡ä»¶ã€‚</p><ul><li><p>è‹¥å¹²å°æ–‡ä»¶</p></li><li><p>æ— å†²çªï¼ŒæœåŠ¡ç›¸åŒçš„æ¨¡å—</p></li><li><p>æ‹’ç»å•çº¯ä¸ºäº†ä¼˜åŒ–ç½‘ç»œåŠ è½½è€Œåˆå¹¶ã€‚</p></li></ul><p>ä¸»æµæ–¹æ¡ˆï¼šå…ˆæ‹†åˆ†ï¼Œå°†æœ€ä¸»è¦çš„å†…å®¹æ›´æ—©çš„åŠ è½½ï¼Œåç»­å†…å®¹åˆ†æ‰¹æ¬¡åŠ è½½ã€‚</p><h2 id="å›¾ç‰‡ä¼˜åŒ–-å›¾ç‰‡æ ¼å¼ä¼˜åŒ–"><a href="#å›¾ç‰‡ä¼˜åŒ–-å›¾ç‰‡æ ¼å¼ä¼˜åŒ–" class="headerlink" title="å›¾ç‰‡ä¼˜åŒ–-å›¾ç‰‡æ ¼å¼ä¼˜åŒ–"></a>å›¾ç‰‡ä¼˜åŒ–-å›¾ç‰‡æ ¼å¼ä¼˜åŒ–</h2><h3 id="å›¾ç‰‡ä¼˜åŒ–çš„æ–¹æ¡ˆ"><a href="#å›¾ç‰‡ä¼˜åŒ–çš„æ–¹æ¡ˆ" class="headerlink" title="å›¾ç‰‡ä¼˜åŒ–çš„æ–¹æ¡ˆ"></a>å›¾ç‰‡ä¼˜åŒ–çš„æ–¹æ¡ˆ</h3><ul><li><p>é€‰æ‹©åˆé€‚çš„æ ¼å¼</p></li><li><p>å¤§å°åˆé€‚ï¼Œè‡ªåŠ¨é€‚é…</p></li><li><p>å›¾ç‰‡å‹ç¼©ï¼ˆä¼šé€ æˆè´¨é‡ä¸‹é™ï¼‰</p></li><li><p>æŒ‰ä¼˜å…ˆçº§åŠ è½½ã€‚</p></li><li><p>æ‡’åŠ è½½</p></li></ul><h3 id="å›¾ç‰‡æ ¼å¼æ¯”è¾ƒ"><a href="#å›¾ç‰‡æ ¼å¼æ¯”è¾ƒ" class="headerlink" title="å›¾ç‰‡æ ¼å¼æ¯”è¾ƒ"></a>å›¾ç‰‡æ ¼å¼æ¯”è¾ƒ</h3><ul><li><p>jpeg/jpgï¼šå‹ç¼©æ¯”é«˜ï¼Œè‰²å½©ä¿å­˜å¥½ã€‚çº¹ç†è¾¹ç¼˜æ¨¡ç³Šï¼ˆå¯ä»¥ç”¨<a href="https://github.com/imagemin/imagemin">imagemin</a>ï¼‰</p></li><li><p>pngï¼šè‰²å½©å¥½ï¼Œçº¹ç†è¾¹ç¼˜æ¸…æ™°ï¼Œæ–‡ä»¶å¤§ã€‚ä¸»è¦ç”¨æ¥åšæ¯”è¾ƒå°çš„å›¾ç‰‡ï¼ˆlogoç­‰ï¼‰ã€‚å‹ç¼©å¯ä»¥ç”¨<a href="https://github.com/imagemin/imagemin-pngquant">imagemin-pngquant</a></p></li><li><p>webPï¼šè´¨é‡é«˜ï¼Œå‹ç¼©æ¯”é«˜ã€‚</p></li></ul><h3 id="IconFont"><a href="#IconFont" class="headerlink" title="IconFont"></a>IconFont</h3><ul><li>æ¯”å›¾ç‰‡å°ï¼ŒåŠ è½½å¿«</li><li>è‡ªç”±çš„å˜åŒ–å¤§å°ï¼Œä¸”ä¸ä¼šæ¨¡ç³Š</li><li>å¯ä»¥ä»»æ„æ”¹å˜é¢œè‰²ï¼ˆåªèƒ½è¢«æ¸²æŸ“æˆå•è‰²æˆ–è€…CSS3çš„æ¸å˜è‰²ï¼‰</li></ul><h3 id="ç§»åŠ¨ç«¯å›¾æ ‡-SVG"><a href="#ç§»åŠ¨ç«¯å›¾æ ‡-SVG" class="headerlink" title="ç§»åŠ¨ç«¯å›¾æ ‡-SVG"></a>ç§»åŠ¨ç«¯å›¾æ ‡-SVG</h3><p>webpack-loaderä½¿ç”¨ï¼š<code>@svgr/webpack</code>ï¼Œ</p><ul><li>éœ€è¦æ‰‹åŠ¨è®¾ç½®å°ºå¯¸å¤§å°</li><li>ä¿æŒå›¾ç‰‡èƒ½åŠ›ï¼Œæ”¯æŒå¤šè‰²å½©</li><li>ç‹¬ç«‹çš„çŸ¢é‡å›¾å½¢</li><li>XMLè¯­æ³•ï¼Œæœç´¢å¼•æ“SEOå’Œæ— éšœç¢è¯»å±è½¯ä»¶è¯»å–</li></ul><h3 id="å›¾ç‰‡åŠ è½½ä¼˜åŒ–"><a href="#å›¾ç‰‡åŠ è½½ä¼˜åŒ–" class="headerlink" title="å›¾ç‰‡åŠ è½½ä¼˜åŒ–"></a>å›¾ç‰‡åŠ è½½ä¼˜åŒ–</h3><ul><li><p>æ‡’åŠ è½½ï¼šåŸç”Ÿæ–¹æ³•ï¼šimgæ ‡ç­¾çš„loadingå±æ€§ï¼›ç¬¬ä¸‰æ–¹ï¼šverlok/lazyload,yall.js,Blazy</p></li><li><p>æ¸è¿›å¼åŠ è½½ï¼šé€æ­¥ä»ä½è´¨é‡åˆ°é«˜è´¨é‡ã€‚ä¼˜ç‚¹ï¼šç”¨æˆ·ä¸€ç›´èƒ½çœ‹åˆ°å†…å®¹ã€‚ è§£å†³æ–¹æ¡ˆï¼šprogressive-imageã€ImageMagickã€libjpegç­‰</p></li><li><p>å“åº”å¼åŠ è½½ï¼šsrcsetå±æ€§ï¼Œsizeså±æ€§ï¼Œpictureå±æ€§</p></li></ul><h2 id="å­—ä½“ä¼˜åŒ–"><a href="#å­—ä½“ä¼˜åŒ–" class="headerlink" title="å­—ä½“ä¼˜åŒ–"></a>å­—ä½“ä¼˜åŒ–</h2><p>å­—ä½“æœªä¸‹è½½å®Œæˆæ—¶ï¼Œæµè§ˆå™¨éšè—æˆ–è‡ªåŠ¨é™çº§ï¼Œå¯¼è‡´å­—ä½“é—ªçƒã€‚</p><p>Flash Of Invisible Text(FOIT)ï¼šä¸å¯è§æ–‡å­—é—ªçƒæŒ‡æˆ‘ä»¬é˜»æ­¢æˆ–å»¶è¿ŸåŠ è½½å­—ä½“ç›´åˆ°å­—ä½“å¯ç”¨ã€‚ å› æ­¤ï¼Œåœ¨åŠ è½½å­—ä½“ä¹‹å‰ï¼Œæˆ‘ä»¬çš„é¡µé¢å¯èƒ½çœ‹èµ·æ¥å¾ˆç©ºç™½ã€‚<br>Flash Of Unstyled Text (FOUT)ï¼šæ— æ ·å¼æ–‡æœ¬é—ªçƒæ˜¯æŒ‡å½“å…ˆåŠ è½½ç³»ç»Ÿé»˜è®¤å­—ä½“ï¼Œåœ¨å‡†å¤‡å¥½è‡ªå®šä¹‰å­—ä½“åŠ è½½å®Œæˆååˆ‡æ¢ã€‚</p><h3 id="æ‹¥æŠ±FOUTï¼šä½¿ç”¨font-display"><a href="#æ‹¥æŠ±FOUTï¼šä½¿ç”¨font-display" class="headerlink" title="æ‹¥æŠ±FOUTï¼šä½¿ç”¨font-display"></a>æ‹¥æŠ±FOUTï¼šä½¿ç”¨<a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/@font-face/font-display">font-display</a></h3><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/font-display.png" alt="font-displayå„ä¸ªå±æ€§æ•ˆæœ"></p><p><a href="https://font-display.glitch.me/">font-displayå„ä¸ªå±æ€§åŠ¨æ€æ•ˆæœ</a></p><h3 id="ä½¿ç”¨CSS-Font-Loading-API"><a href="#ä½¿ç”¨CSS-Font-Loading-API" class="headerlink" title="ä½¿ç”¨CSS Font Loading API"></a>ä½¿ç”¨CSS Font Loading API</h3><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs CSS"><span class="hljs-keyword">@font-face</span>&#123;<br>  unicode-rangeï¼šä¸ä¸€å®šå­—ä½“ä¸­æ‰€æœ‰çš„æ–‡å­—éƒ½ä¼šç”¨åˆ°ï¼Œå¯ä»¥é€šè¿‡è¯¥å±æ€§å®šä¹‰çš„unicodeå­—ä½“èŒƒå›´<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="ä½¿ç”¨ajax-Base64åŠ è½½å­—ä½“ï¼ˆå¯ä»¥ç”¨ï¼Œä½†ä¸æ˜¯æœ€ä½³å®è·µï¼‰"><a href="#ä½¿ç”¨ajax-Base64åŠ è½½å­—ä½“ï¼ˆå¯ä»¥ç”¨ï¼Œä½†ä¸æ˜¯æœ€ä½³å®è·µï¼‰" class="headerlink" title="ä½¿ç”¨ajax+Base64åŠ è½½å­—ä½“ï¼ˆå¯ä»¥ç”¨ï¼Œä½†ä¸æ˜¯æœ€ä½³å®è·µï¼‰"></a>ä½¿ç”¨ajax+Base64åŠ è½½å­—ä½“ï¼ˆå¯ä»¥ç”¨ï¼Œä½†ä¸æ˜¯æœ€ä½³å®è·µï¼‰</h3><ul><li><p>è§£å†³å…¼å®¹æ€§é—®é¢˜</p></li><li><p>ç¼ºç‚¹ï¼šç¼“å­˜é—®é¢˜</p></li></ul><h2 id="ä¼˜åŒ–èµ„æºåŠ è½½çš„é¡ºåº"><a href="#ä¼˜åŒ–èµ„æºåŠ è½½çš„é¡ºåº" class="headerlink" title="ä¼˜åŒ–èµ„æºåŠ è½½çš„é¡ºåº"></a>ä¼˜åŒ–èµ„æºåŠ è½½çš„é¡ºåº</h2><h3 id="èµ„æºä¼˜å…ˆçº§"><a href="#èµ„æºä¼˜å…ˆçº§" class="headerlink" title="èµ„æºä¼˜å…ˆçº§"></a>èµ„æºä¼˜å…ˆçº§</h3><p>æµè§ˆå™¨é»˜è®¤å®‰æ’èµ„æºåŠ è½½ä¼˜å…ˆçº§ï¼ˆå§‹ç»ˆä¼˜å…ˆåŠ è½½HTMLï¼Œæ ¹æ®HTMLåŠ è½½é¡ºåºè¿›è¡ŒåŠ è½½ï¼Œæ¯”å¦‚headå†…çš„èµ„æºä¼˜å…ˆçº§è¾ƒé«˜ï¼‰</p><p>å¯ä»¥é€šè¿‡preloadï¼Œprefetchè°ƒæ•´ä¼˜å…ˆçº§</p><ul><li><p>perloadï¼šæå‰åŠ è½½è¾ƒæ™šå‡ºç°ä½†å¯¹å½“å‰éå¸¸é‡è¦çš„èµ„æºã€‚</p></li><li><p>perfetchï¼šæå‰åŠ è½½åç»§æµè§ˆå™¨éœ€è¦çš„èµ„æºï¼Œä¼˜å…ˆçº§ä½ï¼ˆå› ä¸ºæ˜¯åœ¨æœ‰ç©ºé—²çš„æ—¶å€™æ‰ä¼šè¿›è¡Œä½“å‰åŠ è½½ï¼‰</p></li></ul><p>åœ¨webpackä¸­<a href="https://webpack.docschina.org/guides/code-splitting/#prefetchingpreloading-modules">é¢„è·å–/é¢„åŠ è½½æ¨¡å—</a>:ä½¿ç”¨<code>import(/* webpackPrefetch: true */ &#39;./component.js&#39;);</code></p>]]></content>
    
    
    <categories>
      
      <category>æ€§èƒ½ä¼˜åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>èµ„æºä¼˜åŒ–</tag>
      
      <tag>èµ„æºçš„å‹ç¼©ä¸åˆå¹¶</tag>
      
      <tag>å›¾ç‰‡ä¼˜åŒ–</tag>
      
      <tag>å­—ä½“ä¼˜åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ€§èƒ½ä¼˜åŒ–ä¹‹ä»£ç ä¼˜åŒ–</title>
    <link href="/article/27abae9/"/>
    <url>/article/27abae9/</url>
    
    <content type="html"><![CDATA[<h2 id="JSå¼€é”€å’Œå¦‚ä½•ç¼©çŸ­è§£ææ—¶é—´"><a href="#JSå¼€é”€å’Œå¦‚ä½•ç¼©çŸ­è§£ææ—¶é—´" class="headerlink" title="JSå¼€é”€å’Œå¦‚ä½•ç¼©çŸ­è§£ææ—¶é—´"></a>JSå¼€é”€å’Œå¦‚ä½•ç¼©çŸ­è§£ææ—¶é—´</h2><h3 id="JSå¼€é”€"><a href="#JSå¼€é”€" class="headerlink" title="JSå¼€é”€"></a>JSå¼€é”€</h3><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/cost-of-javascript-2019.png" alt="jsæ—¶é—´å¼€é”€"></p><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><ol><li><p>ç½‘ç»œåŠ è½½æ–¹é¢ï¼šJSæ–‡ä»¶å‹ç¼© </p></li><li><p>ç¼–è¯‘å’Œè§£æï¼šä»£ç æ‹†åˆ†ï¼ŒæŒ‰éœ€åŠ è½½</p></li><li><p>ç¼–è¯‘å’Œè§£æï¼šåˆ é™¤æ²¡å¿…è¦çš„ä»£ç </p></li><li><p>æ‰§è¡Œï¼šå‡å°‘ä¸»çº¿ç¨‹å·¥ä½œé‡</p></li></ol><h3 id="å‡å°‘ä¸»çº¿ç¨‹å·¥ä½œé‡"><a href="#å‡å°‘ä¸»çº¿ç¨‹å·¥ä½œé‡" class="headerlink" title="å‡å°‘ä¸»çº¿ç¨‹å·¥ä½œé‡"></a>å‡å°‘ä¸»çº¿ç¨‹å·¥ä½œé‡</h3><ol><li><p>é¿å…é•¿ä»»åŠ¡ï¼ˆlong taskï¼‰</p></li><li><p>é¿å…è¶…è¿‡1kBçš„è¡Œé—´è„šæœ¬</p></li><li><p>ä½¿ç”¨ rAF å’Œ rIC è¿›è¡Œæ—¶é—´è°ƒåº¦</p></li></ol><h2 id="é…åˆ-V8-æœ‰æ•ˆä¼˜åŒ–ä»£ç "><a href="#é…åˆ-V8-æœ‰æ•ˆä¼˜åŒ–ä»£ç " class="headerlink" title="é…åˆ V8 æœ‰æ•ˆä¼˜åŒ–ä»£ç "></a>é…åˆ V8 æœ‰æ•ˆä¼˜åŒ–ä»£ç </h2><h3 id="V8ç¼–è¯‘åŸç†"><a href="#V8ç¼–è¯‘åŸç†" class="headerlink" title="V8ç¼–è¯‘åŸç†"></a>V8ç¼–è¯‘åŸç†</h3><ol><li><p>ç”ŸæˆæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰å’Œæ‰§è¡Œä¸Šä¸‹æ–‡ï¼šå…ˆè¿›è¡Œè¯æ³•åˆ†æå°†æºä»£ç æ‹†è§£æˆtokenã€‚åœ¨è¿›è¡Œè¯­æ³•åˆ†æï¼Œå°†tokenæ ¹æ®è¯­æ³•è§„åˆ™è½¬åŒ–ä¸ºASTã€‚</p></li><li><p>ç”Ÿæˆå­—èŠ‚ç ï¼šä¼šæ ¹æ® AST ç”Ÿæˆå­—èŠ‚ç ï¼Œå¹¶è§£é‡Šæ‰§è¡Œå­—èŠ‚ç </p></li><li><p>æ‰§è¡Œä»£ç ï¼šåœ¨æ‰§è¡Œå­—èŠ‚ç çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå‘ç°æœ‰çƒ­ç‚¹ä»£ç ï¼ˆHotSpotï¼‰ï¼Œæ¯”å¦‚ä¸€æ®µä»£ç è¢«é‡å¤æ‰§è¡Œå¤šæ¬¡ï¼Œè¿™ç§å°±ç§°ä¸ºçƒ­ç‚¹ä»£ç ï¼Œé‚£ä¹ˆåå°çš„ç¼–è¯‘å™¨å°±ä¼šæŠŠè¯¥æ®µçƒ­ç‚¹çš„å­—èŠ‚ç ç¼–è¯‘ä¸ºæœºå™¨ç ï¼Œç„¶åå½“å†æ¬¡æ‰§è¡Œè¿™æ®µè¢«ä¼˜åŒ–çš„ä»£ç æ—¶ï¼Œåªéœ€è¦æ‰§è¡Œç¼–è¯‘åçš„æœºå™¨ç å°±å¯ä»¥äº†ã€‚ç»è¿‡ç¼–è¯‘å™¨ä¼˜åŒ–è¿‡çš„ä»£ç åªèƒ½é’ˆå¯¹æŸç§å›ºå®šçš„ç»“æ„ï¼Œä¸€æ—¦åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå¯¹è±¡çš„ç»“æ„è¢«åŠ¨æ€ä¿®æ”¹äº†ï¼Œé‚£ä¹ˆä¼˜åŒ–ä¹‹åçš„ä»£ç ä¼šå˜æˆæ— æ•ˆçš„ä»£ç ï¼Œè¿™æ—¶å€™ä¼˜åŒ–ç¼–è¯‘å™¨å°±éœ€è¦æ‰§è¡Œåä¼˜åŒ–æ“ä½œï¼Œç»è¿‡åä¼˜åŒ–çš„ä»£ç ï¼Œä¸‹æ¬¡æ‰§è¡Œæ—¶å°±ä¼šå›é€€åˆ°è§£é‡Šå™¨è§£é‡Šæ‰§è¡Œã€‚</p></li></ol><p>eg.:</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javaScript"><span class="hljs-keyword">const</span> &#123;performance,PerformanceObserver&#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;perf_hooks);</span><br><span class="hljs-string"></span><br><span class="hljs-string">const add = (a,b) =&gt; a + b;</span><br><span class="hljs-string"></span><br><span class="hljs-string">const num1 = 1;</span><br><span class="hljs-string">const numb = 2;</span><br><span class="hljs-string"></span><br><span class="hljs-string">performance.mark(&#x27;</span>start);<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span> ; i &lt; <span class="hljs-number">100000</span> ; i ++)&#123;<br>  add(num1,num2)<br>&#125;<br><span class="hljs-comment">//åˆ†åˆ«æ³¨é‡Šæ‹¼æ¥å­—ç¬¦ä¸²çš„ä»£ç è¿›è¡Œæ—¶é—´æ¯”è¾ƒï¼Œå‘ç°æ—¶é—´å·®è·æå¤§ã€‚</span><br>add(num1,<span class="hljs-string">&#x27;s&#x27;</span>);<br><br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span> ; i &lt; <span class="hljs-number">100000</span> ; i ++)&#123;<br>  add(num1,num2)<br>&#125;<br><br>performance.mark(<span class="hljs-string">&#x27;end&#x27;</span>);<br><br><span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> PerformanceObserver(<span class="hljs-function">(<span class="hljs-params">list</span>)=&gt;</span>&#123;<br>  <span class="hljs-built_in">console</span>.log(list.getEntries()[<span class="hljs-number">0</span>]);<br>&#125;)<br></code></pre></div></td></tr></table></figure><p>æŸ¥çœ‹V8å¯¹å“ªäº›è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå“ªäº›è¿›è¡Œäº†åä¼˜åŒ–å¯ä»¥æ‰§è¡Œ<code>node --trace-opt --trace-deopt file.js</code></p><h3 id="V8ä¼˜åŒ–æœºåˆ¶"><a href="#V8ä¼˜åŒ–æœºåˆ¶" class="headerlink" title="V8ä¼˜åŒ–æœºåˆ¶"></a>V8ä¼˜åŒ–æœºåˆ¶</h3><ol><li><p>è„šæœ¬æµï¼šä¸‹è½½çš„è¿‡ç¨‹ä¸­å¯¹å·²ç»ä¸‹è½½çš„è¶³å¤Ÿå¤§çš„jsæ–‡ä»¶å¼€è¾Ÿæ–°çº¿ç¨‹å…ˆè§£æï¼Œç­‰éƒ½åŠ è½½å®Œåå°†å…¨éƒ¨è§£æç»“æœåˆå¹¶ã€‚</p></li><li><p>å­—èŠ‚ç ç¼“å­˜</p></li><li><p>æ‡’è§£æï¼ˆlazy-parsingï¼‰ï¼šä¸»è¦å¯¹äºå‡½æ•°è€Œè¨€ï¼Œå…ˆä¸è§£æå‡½æ•°å†…éƒ¨é€»è¾‘ï¼Œç­‰ç”¨çš„æ—¶å€™åœ¨è§£æã€‚</p></li></ol><h2 id="å‡½æ•°ä¼˜åŒ–"><a href="#å‡½æ•°ä¼˜åŒ–" class="headerlink" title="å‡½æ•°ä¼˜åŒ–"></a>å‡½æ•°ä¼˜åŒ–</h2><h3 id="å‡½æ•°çš„è§£ææ–¹å¼"><a href="#å‡½æ•°çš„è§£ææ–¹å¼" class="headerlink" title="å‡½æ•°çš„è§£ææ–¹å¼"></a>å‡½æ•°çš„è§£ææ–¹å¼</h3><ul><li><p>æ‡’è§£æï¼ˆlazy-parsingï¼‰ï¼šä¸ä¼šåˆ›å»ºastï¼Œä¼šåˆ›å»ºä½œç”¨åŸŸï¼Œä½†ä¸ä¼šåœ¨é‡Œé¢åŒ…å«å˜é‡å¼•ç”¨æˆ–è€…å£°æ˜ã€‚</p></li><li><p>é¥¥é¥¿è§£æï¼ˆeager-parsingï¼‰ï¼šä¼šå»ºç«‹AST,åˆ›å»ºå®Œæ•´çš„ä½œç”¨åŸŸï¼Œæ‰¾å‡ºæ‰€æœ‰è¯­æ³•é”™è¯¯</p></li></ul><p>é—®é¢˜ï¼šä¸€ä¸ªé©¬ä¸Šè¦æ‰§è¡Œçš„å‡½æ•°åœ¨å£°æ˜çš„æ—¶å€™ä¼šè¿›è¡Œä¸€ä¸ªæ‡’è§£æï¼Œå‘ç°æ˜¯è¯¥å‡½æ•°è¦æ‰§è¡Œäº†ï¼Œåˆä¼šè¿›è¡Œé¥¥é¥¿è§£æï¼Œæ•ˆç‡é™ä½ã€‚</p><p>eg.:</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-keyword">const</span> main = <span class="hljs-function">()=&gt;</span>&#123;<br>  <span class="hljs-comment">//å¯é€šè¿‡å°†å‡½æ•°è½¬ä¸ºç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œå‘Šè¯‰V8ï¼Œaddè¿›è¡Œé¥¥é¥¿è§£æã€‚</span><br>  <span class="hljs-comment">// const add =((a,b)=&gt;a+b);</span><br>  <span class="hljs-keyword">const</span> add = <span class="hljs-function">(<span class="hljs-params">a,b</span>)=&gt;</span>a+b;<br>  <span class="hljs-keyword">const</span> num1 = <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">const</span> num2 = <span class="hljs-number">2</span>;<br>  add(num1 + num2);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>é—®é¢˜ï¼šä½¿ç”¨éƒ¨åˆ†å‹ç¼©å·¥å…·ï¼ˆè€ç‰ˆæœ¬çš„uglyfy å’Œ webpackç­‰ï¼‰æ—¶ï¼Œå¯èƒ½ä¼šå°†ä¸Šè¿°æ‹¬å·å–æ¶ˆæ‰ã€‚<br>è§£å†³ï¼šåˆ©ç”¨Optimize.jsä¼˜åŒ–åŠ è½½æ—¶é—´ã€‚ï¼ˆå°†æ‹¬å·å†åŠ å›æ¥ï¼‰</p><h2 id="å¯¹è±¡ä¼˜åŒ–"><a href="#å¯¹è±¡ä¼˜åŒ–" class="headerlink" title="å¯¹è±¡ä¼˜åŒ–"></a>å¯¹è±¡ä¼˜åŒ–</h2><h3 id="1-ä»¥ç›¸åŒé¡ºåºåˆå§‹åŒ–å¯¹è±¡æˆå‘˜ï¼Œé¿å…éšè—ç±»çš„è°ƒæ•´"><a href="#1-ä»¥ç›¸åŒé¡ºåºåˆå§‹åŒ–å¯¹è±¡æˆå‘˜ï¼Œé¿å…éšè—ç±»çš„è°ƒæ•´" class="headerlink" title="1. ä»¥ç›¸åŒé¡ºåºåˆå§‹åŒ–å¯¹è±¡æˆå‘˜ï¼Œé¿å…éšè—ç±»çš„è°ƒæ•´"></a>1. ä»¥ç›¸åŒé¡ºåºåˆå§‹åŒ–å¯¹è±¡æˆå‘˜ï¼Œé¿å…éšè—ç±»çš„è°ƒæ•´</h3><p>éšè—ç±»å¯ä»¥ç†è§£ä¸ºâ€œæŒ‰å›¾ç´¢éª¥â€ä¸­çš„å›¾ã€‚æé«˜å¯¹è±¡å±æ€§çš„è®¿é—®é€Ÿåº¦ï¼Œå¿«é€Ÿå­˜å–å¯¹è±¡å±æ€§ï¼ŒèŠ‚çœå†…å­˜ç©ºé—´ã€‚</p><p>è¯¦ç»†å¯çœ‹ <a href="https://www.cnblogs.com/chargeworld/p/12236848.html"> V8 ä¸­çš„å¯¹è±¡è¡¨ç¤º </a>ã€‚</p><p>æ–‡ç«  <a href="https://zhuanlan.zhihu.com/p/38202123"> JavaScript å¼•æ“åŸºç¡€ï¼šShapes å’Œ Inline Caches </a>ä¸­è¯¦ç»†äº†éšè—ç±»çš„ç›¸å…³å†…å®¹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RectArea</span></span>&#123;<span class="hljs-comment">//HC0</span><br>  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">l,w</span>)</span>&#123; <br>    <span class="hljs-built_in">this</span>.l = l;<span class="hljs-comment">//HC1</span><br>    <span class="hljs-built_in">this</span>.w = w;<span class="hljs-comment">//HC2</span><br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//è¿™ç§å®ä¾‹åŒ–æ—¶ï¼Œrect2ä¼šå¤ç”¨rect1æ—¶äº§ç”Ÿçš„HCï¼ˆhidden classï¼‰ã€‚</span><br><span class="hljs-keyword">const</span> rect1 = <span class="hljs-keyword">new</span> RectArea(<span class="hljs-number">3</span>,<span class="hljs-number">4</span>);<br><span class="hljs-keyword">const</span> rect2 = <span class="hljs-keyword">new</span> RectArea(<span class="hljs-number">5</span>,<span class="hljs-number">6</span>);<br><br><span class="hljs-comment">//åé¢ä¾‹å­</span><br><span class="hljs-keyword">const</span> car1 = &#123;<span class="hljs-attr">color</span>:<span class="hljs-string">&#x27;red&#x27;</span>&#125;; <span class="hljs-comment">//HC0</span><br>car1.seats = <span class="hljs-number">4</span>; <span class="hljs-comment">//HC1</span><br><br><span class="hljs-keyword">const</span> car2 = &#123;<span class="hljs-attr">seats</span>:<span class="hljs-number">2</span>&#125;; <span class="hljs-comment">//æ— æ³•å¤ç”¨ä»¥ä¸Šä¸¤ç§,åˆ›å»ºæ–°çš„HC2</span><br>cat2.color = <span class="hljs-string">&#x27;blue&#x27;</span>; <span class="hljs-comment">//HC3</span><br></code></pre></div></td></tr></table></figure><h3 id="2-å®ä¾‹åŒ–åé¿å…æ·»åŠ æ–°å±æ€§"><a href="#2-å®ä¾‹åŒ–åé¿å…æ·»åŠ æ–°å±æ€§" class="headerlink" title="2. å®ä¾‹åŒ–åé¿å…æ·»åŠ æ–°å±æ€§"></a>2. å®ä¾‹åŒ–åé¿å…æ·»åŠ æ–°å±æ€§</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-keyword">const</span> car1 = &#123;<span class="hljs-attr">color</span>:<span class="hljs-string">&#x27;red&#x27;</span>&#125;; <span class="hljs-comment">// In-objectå±æ€§</span><br>car1.seats = <span class="hljs-number">4</span>; <span class="hljs-comment">//Normal/Fastå±æ€§ï¼Œå­˜å‚¨åœ¨property storeé‡Œï¼Œéœ€è¦é€šè¿‡æè¿°æ•°ç»„ç®€ä»‹æŸ¥æ‰¾</span><br></code></pre></div></td></tr></table></figure><h3 id="3-å°½é‡ä½¿ç”¨Arrayä»£æ›¿array-likeå¯¹è±¡"><a href="#3-å°½é‡ä½¿ç”¨Arrayä»£æ›¿array-likeå¯¹è±¡" class="headerlink" title="3. å°½é‡ä½¿ç”¨Arrayä»£æ›¿array-likeå¯¹è±¡"></a>3. å°½é‡ä½¿ç”¨Arrayä»£æ›¿array-likeå¯¹è±¡</h3><p>array-likeå¯¹è±¡ï¼šå½¢å¦‚å‡½æ•°å‚æ•°ï¼ˆargumentsè¿™ç§ï¼Œæœ‰ç´¢å¼•æœ‰lengthçš„å¯¹è±¡ï¼‰</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-built_in">Array</span>.prototype.forEach.call(arrObj,<span class="hljs-function">(<span class="hljs-params">v,i</span>)=&gt;</span>&#123; <span class="hljs-comment">//ä¸å¦‚åœ¨çœŸå®æ•°ç»„ä¸Šæ•ˆç‡é«˜ã€‚</span><br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">$&#123;v&#125;</span>:<span class="hljs-subst">$&#123;i&#125;</span>`</span>)<br>&#125;)<br><br><span class="hljs-comment">//æ­£ç¡®å§¿åŠ¿</span><br><span class="hljs-keyword">const</span> arr = <span class="hljs-built_in">Array</span>.prototype.slice.call(arrObj,<span class="hljs-number">0</span>);<span class="hljs-comment">//è½¬æ¢çš„ä»£ä»·æ¯”ä¼˜åŒ–å½±å“å°</span><br>arr.forEach(<span class="hljs-function">(<span class="hljs-params">v,i</span>)=&gt;</span>&#123; <span class="hljs-comment">//ä¸å¦‚åœ¨çœŸå®æ•°ç»„ä¸Šæ•ˆç‡é«˜ã€‚</span><br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">$&#123;v&#125;</span>:<span class="hljs-subst">$&#123;i&#125;</span>`</span>)<br>&#125;)<br></code></pre></div></td></tr></table></figure><h3 id="4-é¿å…è¯»å–è¶…è¿‡æ•°ç»„çš„é•¿åº¦"><a href="#4-é¿å…è¯»å–è¶…è¿‡æ•°ç»„çš„é•¿åº¦" class="headerlink" title="4. é¿å…è¯»å–è¶…è¿‡æ•°ç»„çš„é•¿åº¦"></a>4. é¿å…è¯»å–è¶…è¿‡æ•°ç»„çš„é•¿åº¦</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo</span>(<span class="hljs-params">arr</span>)</span>&#123;<br>  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span> ; i &lt;= arr.length ; i++)&#123; <span class="hljs-comment">// å–å€¼è¶Šç•Œ</span><br>    <span class="hljs-keyword">if</span>(array[i]&gt;<span class="hljs-number">1000</span>)&#123; <span class="hljs-comment">//1. undefinedå’Œ1000 è¿›è¡Œæ¯”è¾ƒ 2.æ²¿åŸå‹é“¾æŸ¥æ‰¾ï¼Œé€ æˆé¢å¤–çš„æ’é”€ã€‚</span><br>      <span class="hljs-built_in">console</span>.log(arr[i]);<span class="hljs-comment">// ä¸šåŠ¡ä¸Šæ— æ•ˆ</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="5-é¿å…å…ƒç´ ç±»å‹è½¬æ¢"><a href="#5-é¿å…å…ƒç´ ç±»å‹è½¬æ¢" class="headerlink" title="5. é¿å…å…ƒç´ ç±»å‹è½¬æ¢"></a>5. é¿å…å…ƒç´ ç±»å‹è½¬æ¢</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-keyword">const</span> array = [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>]; <span class="hljs-comment">//ç±»å‹ï¼šPACKED_SMI_ELEMENTS:æ»¡çš„_smallInt</span><br>array.push(<span class="hljs-number">4.4</span>); <span class="hljs-comment">//ä¸Šè¿°ç±»å‹å¤±æ•ˆï¼Œç±»å‹å˜ä¸ºï¼šPACKED_DOUBLE_ELEMENTS</span><br></code></pre></div></td></tr></table></figure><p>é¿å… -0ï¼Œé™¤éä½ éœ€è¦åœ¨ä»£ç ä¸­æ˜ç¡®åŒºåˆ† -0 å’Œ +0ã€‚</p><p>åŒæ ·è¿˜æœ‰ NaN å’Œ Infinityã€‚å®ƒä»¬è¢«è¡¨ç¤ºä¸ºåŒç²¾åº¦ï¼Œå› æ­¤æ·»åŠ ä¸€ä¸ª NaN æˆ– Infinity ä¼šå°† SMI_ELEMENTS è½¬æ¢ä¸ºDOUBLE_ELEMENTSã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/lattice.png" alt="å…ƒç´ ç±»å‹è½¬æ¢"></p><p>åªèƒ½é€šè¿‡æ ¼å­å‘ä¸‹è¿‡æ¸¡ã€‚ä¸€æ—¦å°†å•ç²¾åº¦æµ®ç‚¹æ•°æ·»åŠ åˆ° Smi æ•°ç»„ä¸­ï¼Œå³ä½¿ç¨åç”¨ Smi è¦†ç›–æµ®ç‚¹æ•°ï¼Œå®ƒä¹Ÿä¼šè¢«æ ‡è®°ä¸º DOUBLEã€‚ç±»ä¼¼åœ°ï¼Œä¸€æ—¦åœ¨æ•°ç»„ä¸­åˆ›å»ºäº†ä¸€ä¸ªæ´ï¼Œå®ƒå°†è¢«æ°¸ä¹…æ ‡è®°ä¸ºæœ‰æ´ HOLEYï¼Œå³ä½¿ç¨åå¡«å……å®ƒä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p><p>è¶Šå…·ä½“ä¼˜åŒ–è¶Šå¤šï¼Œè¶Šé€šç”¨ä¼˜åŒ–è¶Šå°ã€‚</p><p>è¯¦ç»†å¯è§<a href="https://segmentfault.com/a/1190000023193375">ä½ å¯èƒ½ä¸çŸ¥é“çš„V8æ•°ç»„ä¼˜åŒ–</a></p><h3 id="6-é¿å…åˆ›å»ºæ´"><a href="#6-é¿å…åˆ›å»ºæ´" class="headerlink" title="6. é¿å…åˆ›å»ºæ´"></a>6. é¿å…åˆ›å»ºæ´</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-keyword">const</span> array = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">3</span>);<br><span class="hljs-comment">// æ­¤æ—¶ï¼Œæ•°ç»„æ˜¯ç¨€ç–çš„ï¼Œæ‰€ä»¥å®ƒè¢«æ ‡è®°ä¸º `HOLEY_SMI_ELEMENTS`</span><br>array[<span class="hljs-number">0</span>] = <span class="hljs-string">&#x27;a&#x27;</span>;<br><span class="hljs-comment">// æ¥ç€ï¼Œè¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå°æ•´æ•°...æ‰€ä»¥è¿‡æ¸¡åˆ°`HOLEY_ELEMENTS`ã€‚</span><br>array[<span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;b&#x27;</span>;<br>array[<span class="hljs-number">2</span>] = <span class="hljs-string">&#x27;c&#x27;</span>;<br><span class="hljs-comment">// è¿™æ—¶ï¼Œæ•°ç»„ä¸­çš„æ‰€æœ‰ä¸‰ä¸ªä½ç½®éƒ½è¢«å¡«å……ï¼Œæ‰€ä»¥æ•°ç»„è¢«æ‰“åŒ…ï¼ˆå³ä¸å†ç¨€ç–ï¼‰ã€‚</span><br><span class="hljs-comment">// ä½†æ˜¯ï¼Œæˆ‘ä»¬æ— æ³•è½¬æ¢ä¸ºæ›´å…·ä½“çš„ç±»å‹ï¼Œä¾‹å¦‚ â€œPACKED_ELEMENTSâ€ã€‚</span><br><span class="hljs-comment">// å…ƒç´ ç±»ä¿ç•™ä¸ºâ€œHOLEY_ELEMENTSâ€ã€‚</span><br></code></pre></div></td></tr></table></figure><p>è§£å†³æ–¹æ¡ˆ</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-comment">//æ–¹æ³•1</span><br><span class="hljs-keyword">let</span> array = []<br>array.push(newElement) <span class="hljs-comment">//å¾ªç¯</span><br><span class="hljs-comment">// æ–¹æ³•2</span><br><span class="hljs-keyword">let</span> array = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]<br></code></pre></div></td></tr></table></figure><h3 id="7-é¿å…å¤šæ€"><a href="#7-é¿å…å¤šæ€" class="headerlink" title="7. é¿å…å¤šæ€"></a>7. é¿å…å¤šæ€</h3><p>å¦‚æœä»£ç éœ€è¦å¤„ç†åŒ…å«å¤šç§ä¸åŒå…ƒç´ ç±»å‹çš„æ•°ç»„ï¼Œåˆ™å¯èƒ½ä¼šæ¯”å•ä¸ªå…ƒç´ ç±»å‹æ•°ç»„è¦æ…¢ï¼Œå› ä¸ºä»£ç è¦å¯¹ä¸åŒç±»å‹çš„æ•°ç»„å…ƒç´ è¿›è¡Œå¤šæ€æ“ä½œã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-keyword">const</span> each = <span class="hljs-function">(<span class="hljs-params">array, callback</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>; index &lt; array.length; ++index) &#123;<br>    <span class="hljs-keyword">const</span> item = array[index];<br>    callback(item);<br>  &#125;<br>&#125;;<br><span class="hljs-keyword">const</span> doSomething = <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(item);<br><br><br>each([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], doSomething);<br>each([<span class="hljs-number">1.1</span>, <span class="hljs-number">2.2</span>, <span class="hljs-number">3.3</span>], doSomething);<br>each([<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>], doSomething);<br></code></pre></div></td></tr></table></figure><p>è°ƒç”¨äº†<code>each</code>3æ¬¡ï¼Œå¹¶ä¸”æ¯æ¬¡éƒ½æ²¡æœ‰ç»™å®ƒç›¸åŒçš„å…ƒç´ ç±»å‹ï¼Œåœ¨V8ä¸­ï¼Œå®ƒé‡‡ç”¨å†…è”ç¼“å­˜ï¼ˆInline Cachesï¼Œç®€ç§° ICï¼‰æ¥ç¼“å­˜è°ƒç”¨çš„å®ç°ä»¥ä¼˜åŒ–è¿™äº›æ“ä½œçš„æ‰§è¡Œè¿‡ç¨‹ã€‚<br>å½“ç¬¬ä¸€æ¬¡åªä¼ å…¥ç±»å‹ä¸º<code>packed_smi_element</code>çš„<code>[1,2,3]</code>ï¼Œv8ä¼šä½¿ç”¨ICæ¥ç¼“å­˜è¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨ï¼Œè®°å½•å…ƒç´ ç±»å‹ä»¥åŠå…¶ä»–ä¿¡æ¯ï¼Œé‚£ä¹ˆä¸‹ä¸€æ¬¡ä¼ å…¥<code>packed_smi_element</code>æ—¶ï¼Œç›´æ¥å°±å¯ä»¥ä»ç¼“å­˜é‡Œå–åˆ°ä¼˜åŒ–åçš„è°ƒç”¨æ–¹æ³•ï¼Œç„¶åè¿›è¡Œè°ƒç”¨ã€‚<br>ä½†æ˜¯ç¬¬äºŒæ¬¡å¦‚æœä¼ å…¥çš„ä¸ä¸€æ ·çš„å…ƒç´ ç±»å‹ï¼Œæ¯”å¦‚<code>packed_double_number</code>ï¼Œé‚£ä¹ˆv8åˆä¼šé‡æ–°ç¼“å­˜ä¸€ä¸ªæ–°çš„è°ƒç”¨å®ç°ï¼ˆé€‚ç”¨äº<code>packed_double_number</code>ï¼‰ï¼Œé‚£ä¹ˆä¼ å…¥å…ƒç´ çš„æ—¶å€™å°±éœ€è¦è¿›è¡Œ2æ¬¡åˆ¤æ–­äº†ï¼Œå…ˆåˆ¤æ–­æ˜¯ä¸æ˜¯smiï¼Œå¦‚æœä¸æ˜¯ï¼Œå°±åˆ¤æ–­æ˜¯ä¸æ˜¯packed_double_numberï¼Œå¦‚æœæ˜¯å…¶ä»–ï¼Œé‚£ä¹ˆåˆä¼šé‡æ–°ç¼“å­˜ä¸€ä¸ªæ–°çš„è°ƒç”¨å®ç°.ä¼˜åŒ–ä¸åä¼˜åŒ–</p><h2 id="HTMLä¼˜åŒ–"><a href="#HTMLä¼˜åŒ–" class="headerlink" title="HTMLä¼˜åŒ–"></a>HTMLä¼˜åŒ–</h2><ul><li><p>å‡å°‘iframesä½¿ç”¨ã€‚å¿…è¦ä½¿ç”¨æ—¶ï¼Œå…ˆå»ºç«‹ä¸ªç©ºiframeï¼Œå»¶è¿Ÿæˆ–åœ¨åˆé€‚çš„æ—¶æœºä½¿ç”¨<code>setAttribute</code>èµ‹å€¼<code>src</code></p></li><li><p>å‹ç¼©ç©ºç™½ç¬¦</p></li><li><p>é¿å…èŠ‚ç‚¹æ·±å±‚çº§åµŒå¥—</p></li><li><p>é¿å…tableå¸ƒå±€</p></li><li><p>åˆ é™¤æ³¨é‡Šï¼ˆå’Œå‹ç¼©ç©ºç™½ç¬¦ä¸€ä¸ªé“ç†ï¼Œå‹ç¼©æ–‡ä»¶ï¼‰</p></li><li><p>CSS&amp;JavaSCriptå°½é‡å¤–é“¾ï¼ˆé¿å…HTMLå¤§æ–‡ä»¶ï¼‰</p></li><li><p>æ ‡ç­¾è¯­ä¹‰åŒ–ï¼ˆ1.æ–¹ä¾¿äººçœ‹æ‡‚ä»£ç  2.æ–¹ä¾¿æµè§ˆå™¨é’ˆå¯¹æ ‡ç­¾åšçš„ä¼˜åŒ–ï¼‰</p></li><li><p>JSæ–‡ä»¶æ”¾åˆ°å°¾éƒ¨ï¼ˆåŠ è½½JSæ˜¯é˜»å¡çš„ï¼Œä¼šé˜»å¡æ¸²æŸ“ï¼‰</p></li></ul><h2 id="CSSå¯¹æ€§èƒ½çš„å½±å“"><a href="#CSSå¯¹æ€§èƒ½çš„å½±å“" class="headerlink" title="CSSå¯¹æ€§èƒ½çš„å½±å“"></a>CSSå¯¹æ€§èƒ½çš„å½±å“</h2><h3 id="åˆ©ç”¨DevToolsæµ‹é‡æ ·å¼å¼€é”€"><a href="#åˆ©ç”¨DevToolsæµ‹é‡æ ·å¼å¼€é”€" class="headerlink" title="åˆ©ç”¨DevToolsæµ‹é‡æ ·å¼å¼€é”€"></a>åˆ©ç”¨DevToolsæµ‹é‡æ ·å¼å¼€é”€</h3><h3 id="CSSä¼˜åŒ–"><a href="#CSSä¼˜åŒ–" class="headerlink" title="CSSä¼˜åŒ–"></a>CSSä¼˜åŒ–</h3><ul><li><p>é™ä½CSSå¯¹æ¸²æŸ“çš„é˜»å¡ï¼ˆ1.å°½é‡æ—©çš„å»ä¸‹è½½CSS 2.é™ä½CSSæ–‡ä»¶å¤§å°ï¼Œä»…åŠ è½½é¦–å±éœ€è¦çš„CSSï¼Œä¸éœ€è¦çš„å»¶è¿ŸåŠ è½½ï¼‰</p></li><li><p>åˆ©ç”¨GPUè¿›è¡Œå®ŒæˆåŠ¨ç”»ï¼ˆå•ç‹¬å‡ºä¸€ä¸ªå±‚ï¼Œä¸å½±å“å¸ƒå±€ä¸ç»˜åˆ¶ï¼‰</p></li><li><p>ä½¿ç”¨<a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/contain">contain</a>å±æ€§ï¼ˆå‡å°‘é‡ç»˜ä¸å›æµï¼‰</p></li><li><p>ä½¿ç”¨font-displayå±æ€§ï¼ˆè®©æ–‡å­—æ›´æ—©çš„æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œå‡è½»å­—ä½“é—ªåŠ¨ï¼‰</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ€§èƒ½ä¼˜åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>HTML</tag>
      
      <tag>CSS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ€§èƒ½ä¼˜åŒ–ä¹‹æ¸²æŸ“ä¼˜åŒ–</title>
    <link href="/article/41870d4/"/>
    <url>/article/41870d4/</url>
    
    <content type="html"><![CDATA[<h2 id="æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹ï¼ˆå¯¹åº”é¢è¯•é¢˜ï¼šä»ç”¨æˆ·è¾“å…¥urlåˆ°æ˜¾ç¤ºéƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼‰"><a href="#æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹ï¼ˆå¯¹åº”é¢è¯•é¢˜ï¼šä»ç”¨æˆ·è¾“å…¥urlåˆ°æ˜¾ç¤ºéƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼‰" class="headerlink" title="æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹ï¼ˆå¯¹åº”é¢è¯•é¢˜ï¼šä»ç”¨æˆ·è¾“å…¥urlåˆ°æ˜¾ç¤ºéƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼‰"></a>æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹ï¼ˆå¯¹åº”é¢è¯•é¢˜ï¼šä»ç”¨æˆ·è¾“å…¥urlåˆ°æ˜¾ç¤ºéƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼‰</h2><ol start="0"><li><p>çœç•¥ç½‘ç»œç›¸å…³éƒ¨åˆ†ã€‚</p></li><li><p>æ¸²æŸ“è¿›ç¨‹å°† HTML å†…å®¹è½¬æ¢ä¸ºèƒ½å¤Ÿè¯»æ‡‚çš„ DOM æ ‘ç»“æ„ã€‚</p></li><li><p>æ¸²æŸ“å¼•æ“å°† CSS æ ·å¼è¡¨è½¬åŒ–ä¸ºæµè§ˆå™¨å¯ä»¥ç†è§£çš„ styleSheetsï¼Œè®¡ç®—å‡º DOM èŠ‚ç‚¹çš„æ ·å¼ã€‚</p></li><li><p>åˆ›å»ºå¸ƒå±€æ ‘ï¼Œå¹¶è®¡ç®—å…ƒç´ çš„å¸ƒå±€ä¿¡æ¯ã€‚</p></li><li><p>å¯¹å¸ƒå±€æ ‘è¿›è¡Œåˆ†å±‚ï¼Œå¹¶ç”Ÿæˆåˆ†å±‚æ ‘ã€‚</p></li><li><p>ä¸ºæ¯ä¸ªå›¾å±‚ç”Ÿæˆç»˜åˆ¶åˆ—è¡¨ï¼Œå¹¶å°†å…¶æäº¤åˆ°åˆæˆçº¿ç¨‹ã€‚</p></li><li><p>åˆæˆçº¿ç¨‹å°†å›¾å±‚åˆ†æˆå›¾å—ï¼Œå¹¶åœ¨å…‰æ …åŒ–çº¿ç¨‹æ± ä¸­å°†å›¾å—è½¬æ¢æˆä½å›¾ã€‚</p></li><li><p>åˆæˆçº¿ç¨‹å‘é€ç»˜åˆ¶å›¾å—å‘½ä»¤ DrawQuad ç»™æµè§ˆå™¨è¿›ç¨‹ã€‚</p></li><li><p>æµè§ˆå™¨è¿›ç¨‹æ ¹æ® DrawQuad æ¶ˆæ¯ç”Ÿæˆé¡µé¢ï¼Œå¹¶æ˜¾ç¤ºåˆ°æ˜¾ç¤ºå™¨ä¸Šã€‚</p></li></ol><p>ä¸»æµç¨‹ï¼šDOM -ã€‹Style-ã€‹Layout-ã€‹Layer-ã€‹Paint</p><h2 id="å¸ƒå±€"><a href="#å¸ƒå±€" class="headerlink" title="å¸ƒå±€"></a>å¸ƒå±€</h2><h3 id="é‡æ’ï¼ˆå›æµï¼‰å’Œé‡ç»˜"><a href="#é‡æ’ï¼ˆå›æµï¼‰å’Œé‡ç»˜" class="headerlink" title="é‡æ’ï¼ˆå›æµï¼‰å’Œé‡ç»˜"></a>é‡æ’ï¼ˆå›æµï¼‰å’Œé‡ç»˜</h3><p>é€šè¿‡ JavaScript æˆ–è€… CSS ä¿®æ”¹å…ƒç´ çš„å‡ ä½•ä½ç½®å±æ€§ï¼Œä¾‹å¦‚æ”¹å˜å…ƒç´ çš„å®½åº¦ã€é«˜åº¦ç­‰ï¼Œé‚£ä¹ˆæµè§ˆå™¨ä¼šè§¦å‘é‡æ–°å¸ƒå±€ï¼Œè§£æä¹‹åçš„ä¸€ç³»åˆ—å­é˜¶æ®µï¼ˆå³ä»ä¸Šæ–‡åºå·2å¼€å§‹ï¼‰ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å«é‡æ’ã€‚</p><p>é€šè¿‡ JavaScript æˆ–è€… CSS ä¿®æ”¹å…ƒç´ æ²¡æœ‰å¼•èµ·å‡ ä½•ä½ç½®çš„å˜æ¢ï¼ˆå³ç»˜åˆ¶å±æ€§ï¼ˆå…ƒç´ çš„é¢œè‰²ã€èƒŒæ™¯è‰²ã€è¾¹æ¡†ç­‰ï¼‰ï¼‰ï¼Œå¸ƒå±€é˜¶æ®µå°†ä¸ä¼šè¢«æ‰§è¡Œï¼Œç›´æ¥è¿›å…¥äº†ç»˜åˆ¶é˜¶æ®µï¼Œç„¶åæ‰§è¡Œä¹‹åçš„ä¸€ç³»åˆ—å­é˜¶æ®µï¼ˆå³è·³è¿‡åºå·3ï¼Œ4ï¼‰ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å«é‡ç»˜ã€‚</p><h3 id="å½±å“é‡æ’ï¼ˆå›æµï¼‰çš„æ“ä½œ"><a href="#å½±å“é‡æ’ï¼ˆå›æµï¼‰çš„æ“ä½œ" class="headerlink" title="å½±å“é‡æ’ï¼ˆå›æµï¼‰çš„æ“ä½œ"></a>å½±å“é‡æ’ï¼ˆå›æµï¼‰çš„æ“ä½œ</h3><ul><li><p>æ·»åŠ /åˆ é™¤å…ƒç´ </p></li><li><p>æ“ä½œstyles</p></li><li><p>display:none</p></li><li><p>offsetLeft,scrollTop,clientWidth</p></li><li><p>ç§»åŠ¨å…ƒç´ ä½ç½®</p></li><li><p>ä¿®æ”¹æµè§ˆå™¨å¤§å°ï¼Œå­—ä½“å¤§å°ã€‚</p></li></ul><p>æ‰¹é‡æ·»åŠ DOMæ—¶å¯ä»¥ä½¿ç”¨DocumentFragment</p><h3 id="é¿å…Layout-thrashing"><a href="#é¿å…Layout-thrashing" class="headerlink" title="é¿å…Layout thrashing"></a>é¿å…Layout thrashing</h3><ul><li><p>é¿å…é‡æ’ï¼ˆå›æµï¼‰</p></li><li><p>è¯»å†™åˆ†ç¦»ï¼šFastDomï¼ŒåŸç†ï¼šè¯»å†™åˆ†ç¦»ï¼Œæ‰¹é‡æ“ä½œï¼Œä½¿ç”¨window.requestAnimationFrameã€‚</p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/life-of-a-frame.png" alt="å¸§çš„ç”Ÿå‘½å‘¨æœŸ"></p><h3 id="å‡å°‘é‡ç»˜çš„æ–¹æ¡ˆ"><a href="#å‡å°‘é‡ç»˜çš„æ–¹æ¡ˆ" class="headerlink" title="å‡å°‘é‡ç»˜çš„æ–¹æ¡ˆ"></a>å‡å°‘é‡ç»˜çš„æ–¹æ¡ˆ</h3><ul><li><p>åˆ©ç”¨DevToolsè¯†åˆ«paintçš„ç“¶é¢ˆ</p></li><li><p>åˆ©ç”¨will-changeåˆ›å»ºæ–°å›¾å±‚</p></li></ul><h3 id="è§¦å‘åˆæˆè¿‡ç¨‹çš„å±æ€§"><a href="#è§¦å‘åˆæˆè¿‡ç¨‹çš„å±æ€§" class="headerlink" title="è§¦å‘åˆæˆè¿‡ç¨‹çš„å±æ€§"></a>è§¦å‘åˆæˆè¿‡ç¨‹çš„å±æ€§</h3><p>æ¸²æŸ“å¼•æ“å°†è·³è¿‡å¸ƒå±€å’Œç»˜åˆ¶ï¼Œåªæ‰§è¡Œåç»­çš„åˆæˆæ“ä½œï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšåˆæˆã€‚</p><ul><li><p>ä½ç½®ï¼štransformï¼štranslate</p></li><li><p>ç¼©æ”¾ï¼štransformï¼šscale</p></li><li><p>æ—‹è½¬ï¼štransformï¼šrotate</p></li><li><p>é€æ˜åº¦ï¼šopacity</p></li></ul><h3 id="ä½¿ç”¨Flexboxä¼˜åŒ–å¸ƒå±€"><a href="#ä½¿ç”¨Flexboxä¼˜åŒ–å¸ƒå±€" class="headerlink" title="ä½¿ç”¨Flexboxä¼˜åŒ–å¸ƒå±€"></a>ä½¿ç”¨Flexboxä¼˜åŒ–å¸ƒå±€</h3><p>æ …æ ¼æ–¹æ¡ˆæ€§èƒ½å¯¹æ¯”ï¼ˆfloat vs flexï¼‰ï¼šåˆ†åˆ«ç”¨float å’Œ flexå®ç°æ¸²æŸ“10wä¸ªå¤§å°ä¸€æ ·çš„divå—ï¼Œç„¶åä½¿ç”¨ChromDevTools-Performanceè¿›è¡ŒæŸ¥çœ‹</p><ul><li><p>floatï¼šrenderingï¼ˆRecalculate+Layoutï¼‰ï¼š1804ms Paintingï¼š60ms</p></li><li><p>flexï¼šrenderingï¼ˆRecalculate+Layoutï¼‰ï¼š1267ms Paintingï¼š34ms</p></li></ul><p>flexboxä¼˜åŠ¿ï¼š</p><ul><li><p>æ›´é«˜æ€§èƒ½çš„å®ç°æ–¹å¼</p></li><li><p>å®¹å™¨æœ‰èƒ½åŠ›å†³å®šå­å…ƒç´ çš„å¤§å°ï¼Œé¡ºåºï¼Œå¯¹é½ï¼Œé—´éš”ç­‰ã€‚</p></li><li><p>åŒå‘å¸ƒå±€</p></li></ul><h2 id="é«˜é¢‘äº‹ä»¶å¤„ç†"><a href="#é«˜é¢‘äº‹ä»¶å¤„ç†" class="headerlink" title="é«˜é¢‘äº‹ä»¶å¤„ç†"></a>é«˜é¢‘äº‹ä»¶å¤„ç†</h2><h3 id="é˜²æŠ–"><a href="#é˜²æŠ–" class="headerlink" title="é˜²æŠ–"></a>é˜²æŠ–</h3><p>ä»»åŠ¡é¢‘ç¹è§¦å‘çš„æƒ…å†µä¸‹ï¼Œåªæœ‰ä»»åŠ¡è§¦å‘çš„é—´éš”è¶…è¿‡æŒ‡å®šé—´éš”çš„æ—¶å€™ï¼Œä»»åŠ¡æ‰ä¼šæ‰§è¡Œã€‚</p><p>æ¯”å¦‚å½“ç›‘å¬é¼ æ ‡ç§»åŠ¨ç­‰äº‹ä»¶æ—¶ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-comment">//ç”¨æ¥è¡¨ç¤ºäº‹ä»¶æ˜¯å¦åœ¨æ‰§è¡Œä¸­ã€‚</span><br><span class="hljs-keyword">let</span> enabled =<span class="hljs-literal">false</span>;<br><br><span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">&quot;pointermove&quot;</span>,<span class="hljs-function">(<span class="hljs-params">e</span>)=&gt;</span>&#123;<br>  <span class="hljs-keyword">if</span>(enabled) <span class="hljs-keyword">return</span>;<br>  enabled = <span class="hljs-literal">true</span>;<br>  <span class="hljs-comment">//æ‰§è¡Œä¸€ä¸ªåŠ¨ç”»ï¼Œå¹¶ä¸”è¦æ±‚æµè§ˆå™¨åœ¨ä¸‹æ¬¡é‡ç»˜ä¹‹å‰è°ƒç”¨æŒ‡å®šçš„å›è°ƒå‡½æ•°æ›´æ–°åŠ¨ç”»</span><br>  <span class="hljs-built_in">window</span>.requestAnimationFrame(<span class="hljs-function">()=&gt;</span>&#123;<br>    changeWidth();<br>    enabled = <span class="hljs-literal">false</span>;<br>  &#125;)<br>&#125;)<br></code></pre></div></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-comment">//èŠ‚æµ</span><br><span class="hljs-keyword">let</span> enabled = <span class="hljs-literal">true</span>;<br><br><span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">&quot;pointermove&quot;</span>,<span class="hljs-function">(<span class="hljs-params">e</span>)=&gt;</span>&#123;<br>  <span class="hljs-keyword">if</span>(enabled)&#123;<br>    enabled = <span class="hljs-literal">false</span>;<br>    <span class="hljs-built_in">window</span>.requestAnimationFrame (<span class="hljs-function">()=&gt;</span>&#123;<br>        changeWidth();<br>    &#125;)<br>    <span class="hljs-built_in">window</span>.setTimeout(<span class="hljs-function">()=&gt;</span>enbled = <span class="hljs-literal">true</span>,<span class="hljs-number">50</span>)<br>  &#125;<br>&#125;)<br></code></pre></div></td></tr></table></figure><h2 id="Reactæ—¶é—´è°ƒåº¦å®ç°"><a href="#Reactæ—¶é—´è°ƒåº¦å®ç°" class="headerlink" title="Reactæ—¶é—´è°ƒåº¦å®ç°"></a>Reactæ—¶é—´è°ƒåº¦å®ç°</h2><p>React Fiberï¼šæŠŠæ›´æ–°è¿‡ç¨‹ç¢ç‰‡åŒ–ï¼Œæ¯æ‰§è¡Œå®Œä¸€æ®µæ›´æ–°è¿‡ç¨‹ï¼Œå°±æŠŠæ§åˆ¶æƒäº¤è¿˜ç»™Reactè´Ÿè´£ä»»åŠ¡åè°ƒçš„æ¨¡å—ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–ç´§æ€¥ä»»åŠ¡è¦åšï¼Œå¦‚æœæ²¡æœ‰å°±ç»§ç»­å»æ›´æ–°ï¼Œå¦‚æœæœ‰ç´§æ€¥ä»»åŠ¡ï¼Œé‚£å°±å»åšç´§æ€¥ä»»åŠ¡ã€‚</p><h3 id="åŸºæœ¬åŸç†"><a href="#åŸºæœ¬åŸç†" class="headerlink" title="åŸºæœ¬åŸç†"></a>åŸºæœ¬åŸç†</h3><ul><li><p>requestIdleCallbackçš„é—®é¢˜ï¼šå…¼å®¹æ€§ä¸å¥½ã€‚åœ¨æµè§ˆå™¨çš„ç©ºé—²æ—¶æ®µå†…è°ƒç”¨çš„å‡½æ•°æ’é˜Ÿï¼Œèƒ½å¤Ÿåœ¨ä¸»äº‹ä»¶å¾ªç¯ä¸Šæ‰§è¡Œåå°å’Œä½ä¼˜å…ˆçº§å·¥ä½œï¼Œè€Œä¸ä¼šå½±å“å»¶è¿Ÿå…³é”®äº‹ä»¶ã€‚</p></li><li><p>é€šè¿‡rAFæ¨¡æ‹ŸrICï¼šåœ¨requestAnimationFrameè·å–ä¸€æ¡¢çš„å¼€å§‹æ—¶é—´ï¼Œè§¦å‘ä¸€ä¸ªpostMessageï¼Œåœ¨ç©ºé—²çš„æ—¶å€™è°ƒç”¨idleTickæ¥å®Œæˆå¼‚æ­¥ä»»åŠ¡ã€‚</p></li></ul><h2 id="é¢„æ¸²æŸ“"><a href="#é¢„æ¸²æŸ“" class="headerlink" title="é¢„æ¸²æŸ“"></a>é¢„æ¸²æŸ“</h2><p>reactå¯ä»¥ä½¿ç”¨<a href="https://www.npmjs.com/package/react-snap">react-snap</a></p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-keyword">import</span> &#123; hydrate, render &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-dom&quot;</span>;<br> <br><span class="hljs-keyword">const</span> rootElement = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;root&quot;</span>);<br><span class="hljs-comment">//å¦‚æœæœ‰å­èŠ‚ç‚¹ï¼Œè¡¨ç¤ºç»å†è¿‡äº†ssr</span><br><span class="hljs-keyword">if</span> (rootElement.hasChildNodes()) &#123;<br>  <span class="hljs-comment">// é€šè¿‡è¯¥æ–¹æ³•è¿›è¡Œè¡¥æ°´</span><br>  hydrate(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>, rootElement);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>  render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>, rootElement);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>åŸç†ï¼šä½¿ç”¨ Headless Chromeçˆ¬å–é¡µé¢çš„å†…å®¹ï¼ˆæ¨¡æ‹Ÿæœç´¢å¼•æ“çš„çˆ¬è™«ï¼Ÿï¼‰ï¼Œç„¶åå†…å®¹ç›´æ¥æ”¾åˆ°buildçš„htmlä¸­ã€‚</p><h3 id="é¢„æ¸²æŸ“çš„ä½œç”¨"><a href="#é¢„æ¸²æŸ“çš„ä½œç”¨" class="headerlink" title="é¢„æ¸²æŸ“çš„ä½œç”¨"></a>é¢„æ¸²æŸ“çš„ä½œç”¨</h3><ul><li><p>å¤§å‹å•é¡µåº”ç”¨çš„æ€§èƒ½ç“¶é¢ˆï¼šJSä¸‹è½½+è§£æ+æ‰§è¡Œ</p></li><li><p>SSRçš„ä¸»è¦é—®é¢˜ï¼šç‰ºç‰²TTFBæ¥è¡¥æ•‘First Paintï¼›å®ç°å¤æ‚ï¼›</p></li><li><p>Pre-renderingæ‰“åŒ…æ—¶æå‰æ¸²æŸ“é¡µé¢ï¼Œæ²¡æœ‰æœåŠ¡ç«¯å‚ä¸ã€‚</p></li></ul><p>å¯èƒ½å­˜åœ¨çš„é—®é¢˜ï¼š</p><ul><li>å†…è”æ ·å¼ï¼Œä¸ç»è¿‡é…ç½®ä¼šå‡ºç°æ˜æ˜¾çš„æ ·å¼é—ªåŠ¨ã€‚ï¼ˆå¯ä»¥é’ˆå¯¹é¦–å±æŠŠCSSæå–å‡ºæ¥å†…åµŒåˆ°HTMLä¸­ï¼Œå‰©ä¸‹çš„CSSç”¨webpackæå–åˆ°æ–‡ä»¶ä¸­ï¼Œè¿›è¡Œç¼“å­˜ï¼‰</li></ul><h2 id="å¯è§†åŒ–çª—å£ï¼ˆwindowingï¼‰æé«˜åˆ—è¡¨æ€§èƒ½-è™šæ‹Ÿåˆ—è¡¨"><a href="#å¯è§†åŒ–çª—å£ï¼ˆwindowingï¼‰æé«˜åˆ—è¡¨æ€§èƒ½-è™šæ‹Ÿåˆ—è¡¨" class="headerlink" title="å¯è§†åŒ–çª—å£ï¼ˆwindowingï¼‰æé«˜åˆ—è¡¨æ€§èƒ½ - è™šæ‹Ÿåˆ—è¡¨"></a>å¯è§†åŒ–çª—å£ï¼ˆwindowingï¼‰æé«˜åˆ—è¡¨æ€§èƒ½ - è™šæ‹Ÿåˆ—è¡¨</h2><p><a href="https://www.npmjs.com/package/react-window">react-window</a></p><ul><li><p>åªæ¸²æŸ“å¯è§çš„è¡Œï¼Œæ¸²æŸ“å’Œæ»šåŠ¨çš„æ€§èƒ½éƒ½ä¼šæå‡</p></li><li><p>å‡å°‘äº†å‘ˆç°åˆå§‹è§†å›¾å’Œå¤„ç†æ›´æ–°æ‰€éœ€çš„å·¥ä½œé‡å’Œæ—¶é—´</p></li><li><p>é¿å…äº† DOM èŠ‚ç‚¹çš„è¿‡åº¦åˆ†é…ï¼Œä»è€Œå‡å°‘äº†å†…å­˜å ç”¨ï¼ˆLazy loadingæ—¶ï¼Œdomä¼šå˜å¾—éå¸¸å¤§ï¼‰</p></li></ul><h2 id="ä½¿ç”¨éª¨æ¶ç»„ä»¶å‡å°‘å¸ƒå±€ç§»åŠ¨ï¼ˆLayout-shiftï¼‰"><a href="#ä½¿ç”¨éª¨æ¶ç»„ä»¶å‡å°‘å¸ƒå±€ç§»åŠ¨ï¼ˆLayout-shiftï¼‰" class="headerlink" title="ä½¿ç”¨éª¨æ¶ç»„ä»¶å‡å°‘å¸ƒå±€ç§»åŠ¨ï¼ˆLayout shiftï¼‰"></a>ä½¿ç”¨éª¨æ¶ç»„ä»¶å‡å°‘å¸ƒå±€ç§»åŠ¨ï¼ˆLayout shiftï¼‰</h2><p>ä¸»è¦ä½œç”¨å°±æ˜¯å ä½ï¼Œä¸è¦æ˜¾ç¤ºçš„ç»„ä»¶å¤§å°ä¸€æ ·å¤§ï¼Œç­‰æ•°æ®åŠ è½½å®Œæˆåå†æ˜¾ç¤ºæ•°æ®ã€‚å¯ä»¥æå‡ç”¨æˆ·æ„ŸçŸ¥æ€§èƒ½</p><h2 id="é¦–å±æ¸²æŸ“ä¼˜åŒ–æ–¹æ¡ˆ"><a href="#é¦–å±æ¸²æŸ“ä¼˜åŒ–æ–¹æ¡ˆ" class="headerlink" title="é¦–å±æ¸²æŸ“ä¼˜åŒ–æ–¹æ¡ˆ"></a>é¦–å±æ¸²æŸ“ä¼˜åŒ–æ–¹æ¡ˆ</h2><p>é¦–å± - ç”¨æˆ·åŠ è½½çš„3ä¸ªå…³é”®æ—¶åˆ»</p><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/Loading-is-a-journey.png" alt="ç”¨æˆ·åŠ è½½çš„3ä¸ªå…³é”®æ—¶åˆ»"></p><p>å¯¹åº”çš„æµ‹é‡æŒ‡æ ‡ï¼š</p><ul><li><p>First Contentful Paintï¼ˆFCPï¼‰â€”â€“ is it happeningï¼Ÿï¼ˆç½‘ç»œè¯·æ±‚æ˜¯å¦å‘é€å‡ºå»äº†ï¼Ÿï¼‰</p></li><li><p>Largest Contentful Paintï¼ˆLCPï¼‰â€”â€“ is it usefulï¼Ÿï¼ˆç½‘é¡µå†…å®¹æ˜¯å¦å¯¹æˆ‘æœ‰ç”¨ï¼Ÿï¼‰</p></li><li><p>Time To Interactive ï¼ˆTTIï¼‰ â€”â€“ is it usableï¼Ÿï¼ˆæ˜¯å¦å¯ä»¥äº¤äº’äº†ï¼Ÿï¼‰</p></li></ul><p>æ–¹æ¡ˆï¼š</p><ul><li><p>èµ„æºä½“ç§¯å¤ªå¤§ï¼Ÿèµ„æºå‹ç¼©ï¼Œä¼ è¾“å‹ç¼©ï¼Œä»£ç æ‹†åˆ†ï¼ŒTree shakingï¼ŒHTTP/2ï¼Œç¼“å­˜</p></li><li><p>é¦–é¡µå†…å®¹å¤ªå¤šï¼Ÿè·¯ç”±/ç»„ä»¶/å†…å®¹æ‡’åŠ è½½ï¼Œé¢„æ¸²æŸ“/SSRï¼ŒInline CSS</p></li><li><p>åŠ è½½é¡ºåºä¸åˆé€‚ï¼Ÿ prefetchï¼Œpreload</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ€§èƒ½ä¼˜åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æµè§ˆå™¨æ¸²æŸ“åŸç†</tag>
      
      <tag>é‡æ’å’Œé‡ç»˜</tag>
      
      <tag>é¢„æ¸²æŸ“</tag>
      
      <tag>é¦–å±æ¸²æŸ“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ€§èƒ½ä¼˜åŒ–ä¹‹æ€§èƒ½ä¼˜åŒ–çš„æŒ‡æ ‡ä¸å·¥å…·</title>
    <link href="/article/bc89d796/"/>
    <url>/article/bc89d796/</url>
    
    <content type="html"><![CDATA[<p>TODO: æ›´æ–°ChromeDevToolsä½¿ç”¨è¯´æ˜ï¼Œä»¥åŠå„é¡¹å‚æ•°è¯´æ˜</p><h2 id="æ€§èƒ½ä¼˜åŒ–çš„æ„ä¹‰"><a href="#æ€§èƒ½ä¼˜åŒ–çš„æ„ä¹‰" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–çš„æ„ä¹‰"></a>æ€§èƒ½ä¼˜åŒ–çš„æ„ä¹‰</h2><p>é«˜æ€§èƒ½æ„å‘³ç€ç”¨æˆ·å‚ä¸åº¦æé«˜ï¼Œç”¨æˆ·ç•™å­˜æ•°æé«˜ï¼Œè¿›è€Œä¿ƒè¿›é«˜è½¬åŒ–ç‡ï¼Œseoæ’åä¹Ÿä¼šæé«˜ã€‚</p><h2 id="æ€§èƒ½ä¼˜åŒ–-åŠ è½½æŒ‡æ ‡"><a href="#æ€§èƒ½ä¼˜åŒ–-åŠ è½½æŒ‡æ ‡" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–-åŠ è½½æŒ‡æ ‡"></a>æ€§èƒ½ä¼˜åŒ–-åŠ è½½æŒ‡æ ‡</h2><ul><li><p>Speed Indexï¼šæµ‹é‡é¡µé¢åŠ è½½è¿‡ç¨‹ä¸­å†…å®¹çš„å¯è§†åŒ–æ˜¾ç¤ºé€Ÿåº¦</p></li><li><p>TTFBï¼šæµè§ˆå™¨å¼€å§‹æ”¶åˆ°æœåŠ¡å™¨å“åº”æ•°æ®çš„æ—¶é—´ï¼ˆåå°å¤„ç†æ—¶é—´+é‡å®šå‘æ—¶é—´ï¼‰ï¼Œæ˜¯åæ˜ æœåŠ¡ç«¯å“åº”é€Ÿåº¦çš„é‡è¦æŒ‡æ ‡ã€‚</p></li><li><p>Loadï¼ˆé¡µé¢åŠ è½½æ—¶é—´ï¼‰ï¼šæ‰€æœ‰èµ„æºåŠ è½½å®Œæ¯•éœ€è¦çš„æ—¶é—´</p></li><li><p>First Contentful Paintï¼ˆé¦–æ¬¡æ¸²æŸ“è€—æ—¶ï¼‰ï¼šæµè§ˆå™¨æ¸²æŸ“ç¬¬ä¸€æ®µ DOM å†…å®¹æ‰€éœ€è¦çš„æ—¶é—´</p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/AruSeito/AruSeito.github.io@main/source/img/Loading-is-a-journey.png" alt="åŠ è½½è¿‡ç¨‹"></p><h2 id="æ€§èƒ½ä¼˜åŒ–-å“åº”æŒ‡æ ‡"><a href="#æ€§èƒ½ä¼˜åŒ–-å“åº”æŒ‡æ ‡" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–-å“åº”æŒ‡æ ‡"></a>æ€§èƒ½ä¼˜åŒ–-å“åº”æŒ‡æ ‡</h2><ul><li><p>äº¤äº’åŠ¨ä½œçš„åé¦ˆæ—¶é—´</p></li><li><p>å¸§ç‡FPS</p></li><li><p>å¼‚æ­¥è¯·æ±‚å®Œæˆçš„æ—¶é—´</p></li></ul><h2 id="RAILæµ‹é‡æ¨¡å‹"><a href="#RAILæµ‹é‡æ¨¡å‹" class="headerlink" title="RAILæµ‹é‡æ¨¡å‹"></a>RAILæµ‹é‡æ¨¡å‹</h2><ul><li><p>Rï¼šResponse äº‹ä»¶å“åº”</p></li><li><p>Aï¼šAnimation åŠ¨ç”»è¿‡æ¸¡</p></li><li><p>Iï¼šIdle ç©ºé—²ï¼šä¸»çº¿ç¨‹ç©ºé—²</p></li><li><p>Lï¼šLoad åŠ è½½ï¼šç½‘ç»œèµ„æºçš„åŠ è½½</p></li></ul><h3 id="è¯„ä¼°æ ‡å‡†"><a href="#è¯„ä¼°æ ‡å‡†" class="headerlink" title="è¯„ä¼°æ ‡å‡†"></a>è¯„ä¼°æ ‡å‡†</h3><ul><li><p>Rï¼šå¤„ç†äº‹ä»¶åº”åœ¨50msä»¥å†…å®Œæˆ</p></li><li><p>Aï¼šæ¯10msäº§ç”Ÿä¸€å¸§</p></li><li><p>Iï¼šå°½å¯èƒ½å¢åŠ ç©ºé—²æ—¶é—´</p></li><li><p>Lï¼šåœ¨5så†…å®Œæˆå†…å®¹åŠ è½½å¹¶å¯ä»¥äº¤äº’</p></li></ul><h2 id="æ€§èƒ½æµ‹é‡å·¥å…·"><a href="#æ€§èƒ½æµ‹é‡å·¥å…·" class="headerlink" title="æ€§èƒ½æµ‹é‡å·¥å…·"></a>æ€§èƒ½æµ‹é‡å·¥å…·</h2><ul><li><p>Chrome DevToolsï¼šå¼€å‘è°ƒè¯•ï¼Œæ€§èƒ½æµ‹è¯•</p></li><li><p>Lighthouseï¼šç½‘ç«™æ•´ä½“è´¨é‡è¯„ä¼°</p></li><li><p>WebPageTest.orgï¼šå¤šæµ‹è¯•åœ°ç‚¹ï¼Œå…¨é¢æ€§èƒ½æŠ¥å‘Š</p></li></ul><h2 id="å¸¸ç”¨çš„æ€§èƒ½æµ‹è¯•API"><a href="#å¸¸ç”¨çš„æ€§èƒ½æµ‹è¯•API" class="headerlink" title="å¸¸ç”¨çš„æ€§èƒ½æµ‹è¯•API"></a>å¸¸ç”¨çš„æ€§èƒ½æµ‹è¯•API</h2><p>å¯ä»¥åŸ‹ç‚¹è¿›è¡Œæ€§èƒ½ç›‘æµ‹ã€‚</p><p>å„é¡¹æŒ‡æ ‡ä¸»è¦æ˜¯<code>performance.getEntriesByType(&#39;navigation&#39;)</code>ä¸‹æ•°æ®çš„è®¡ç®—ï¼Œç”¨äºåº¦é‡å½“å‰é¡µé¢åŠ è½½é€Ÿåº¦<br><code>performance.getEntriesByType(&#39;resource&#39;)</code>ç”¨äºè®¡ç®—é¡µé¢åŠ è½½æ—¶è¯·æ±‚èµ„æºçš„é€Ÿåº¦ã€‚</p><ul><li><p>DNS è§£æè€—æ—¶: domainLookupEnd - domainLookupStart</p></li><li><p>TCP è¿æ¥è€—æ—¶: connectEnd - connectStart</p></li><li><p>SSL å®‰å…¨è¿æ¥è€—æ—¶: connectEnd - secureConnectionStart</p></li><li><p>ç½‘ç»œè¯·æ±‚è€—æ—¶ (TTFB): responseStart - requestStart</p></li><li><p>æ•°æ®ä¼ è¾“è€—æ—¶: responseEnd - responseStart</p></li><li><p>DOM è§£æè€—æ—¶: domInteractive - responseEnd</p></li><li><p>èµ„æºåŠ è½½è€—æ—¶: loadEventStart - domContentLoadedEventEnd</p></li><li><p>First Byteæ—¶é—´: responseStart - domainLookupStart</p></li><li><p>ç™½å±æ—¶é—´: responseEnd - fetchStart</p></li><li><p>é¦–æ¬¡å¯äº¤äº’æ—¶é—´: domInteractive - fetchStart</p></li><li><p>DOM Ready æ—¶é—´: domContentLoadEventEnd - fetchStart</p></li><li><p>é¡µé¢å®Œå…¨åŠ è½½æ—¶é—´: loadEventStart - fetchStart</p></li><li><p>http å¤´éƒ¨å¤§å°ï¼š transferSize - encodedBodySize</p></li><li><p>é‡å®šå‘æ¬¡æ•°ï¼šperformance.navigation.redirectCount</p></li><li><p>é‡å®šå‘è€—æ—¶: redirectEnd - redirectStart</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-comment">//é€šè¿‡å…³é”®APIè·å–é•¿ä»»åŠ¡ï¼ˆlong Taskï¼‰åˆ—è¡¨</span><br><span class="hljs-comment">//è§‚å¯Ÿè€…æ¨¡å¼</span><br><span class="hljs-keyword">let</span> ob = <span class="hljs-keyword">new</span> PerformanceObserver(<span class="hljs-function">(<span class="hljs-params">list</span>)=&gt;</span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> list.getEntries())&#123;<br>        <span class="hljs-built_in">console</span>.log(entry)<br>    &#125;<br>&#125;)<br>ob.observe(&#123;<span class="hljs-attr">entryTypes</span>:[<span class="hljs-string">&quot;longtask&quot;</span>]&#125;)<br></code></pre></div></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-comment">//åˆ¤æ–­ç”¨æˆ·æ˜¯å¦åœ¨çœ‹å½“å‰é¡µé¢ï¼Œå¦‚æœæ²¡çœ‹å¯ä»¥æ–­æ‰ç½‘ç»œä¼ è¾“ï¼Œä¿å­˜å½“å‰çŠ¶æ€ã€‚</span><br><span class="hljs-comment">// chrome</span><br><span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">&#x27;webkitvisbilitychange&#x27;</span>,<span class="hljs-function">()=&gt;</span>&#123;&#125;)<br></code></pre></div></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-comment">//è·å–ç”¨æˆ·ç½‘ç»œç¯å¢ƒï¼Œæ ¹æ®ç”¨æˆ·ç½‘ç»œç¯å¢ƒè¿›è¡Œèµ„æºçš„è°ƒæ•´ï¼Œå¦‚æœå›¾ç‰‡çš„å‹ç¼©ã€‚</span><br><span class="hljs-keyword">let</span> connection =navigator.connection || navigator.mozConnection || navigator.webkitConnection;<br><span class="hljs-keyword">let</span> type = connection.effectiveType;<br><span class="hljs-keyword">const</span> updateConnectionStatus = <span class="hljs-function">()=&gt;</span>&#123;&#125;<br>connection.addEventListener(<span class="hljs-string">&#x27;change&#x27;</span>,updateConnectionStatus);<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ€§èƒ½ä¼˜åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ChromeDevTools</tag>
      
      <tag>LightHouse</tag>
      
      <tag>æ€§èƒ½æµ‹é‡API</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JavaScriptä¹‹äº‹ä»¶å¾ªç¯</title>
    <link href="/article/b561c95f/"/>
    <url>/article/b561c95f/</url>
    
    <content type="html"><![CDATA[<blockquote><p>æœ¬æ–‡æ‘˜æŠ„è‡ª<a href="https://mp.weixin.qq.com/s/a6aFweCiLF0Mx03fARP8qQ">æ·˜å®æŠ€æœ¯</a></p></blockquote><h2 id="äº‹ä»¶å¾ªç¯æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#äº‹ä»¶å¾ªç¯æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="äº‹ä»¶å¾ªç¯æ˜¯ä»€ä¹ˆï¼Ÿ"></a>äº‹ä»¶å¾ªç¯æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>åœ¨EcmaScriptçš„æ ‡å‡†å®šä¹‰ä¸­æ²¡æœ‰æåˆ°äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰è¿™ä¸ªå®šä¹‰ï¼Œåè€Œæ˜¯HTMLçš„æ ‡å‡†å®šä¹‰ä¸­å®šä¹‰äº†äº‹ä»¶å¾ªç¯ã€‚</p><blockquote><p>To coordinate events, user interaction, scripts, rendering, networking, and so forth, user agents must use event loops as described in this section. Each agent has an associated event loop, which is unique to that agent.</p></blockquote><p>æ ¹æ®æ ‡å‡†ä¸­å¯¹äº‹ä»¶å¾ªç¯çš„å®šä¹‰æè¿°ï¼Œå‘ç°äº‹ä»¶å¾ªç¯æœ¬è´¨ä¸Šæ˜¯user agentç”¨äºåè°ƒç”¨æˆ·äº¤äº’ï¼ˆé¼ æ ‡ã€é”®ç›˜ï¼‰ã€è„šæœ¬ï¼ˆå¦‚ JavaScriptï¼‰ã€æ¸²æŸ“ï¼ˆå¦‚ HTML DOMã€CSS æ ·å¼ï¼‰ã€ç½‘ç»œç­‰è¡Œä¸ºçš„ä¸€ä¸ªæœºåˆ¶ã€‚</p><p>å„ç§æµè§ˆå™¨äº‹ä»¶åŒæ—¶è§¦å‘æ—¶ï¼Œè‚¯å®šæœ‰ä¸€ä¸ªå…ˆæ¥ååˆ°çš„æ’é˜Ÿé—®é¢˜ã€‚å†³å®šè¿™äº›äº‹ä»¶å¦‚ä½•æ’é˜Ÿè§¦å‘çš„æœºåˆ¶ï¼Œå°±æ˜¯äº‹ä»¶å¾ªç¯ã€‚è¿™ä¸ªæ’é˜Ÿè¡Œä¸ºä»¥ JavaScript å¼€å‘è€…çš„è§’åº¦æ¥çœ‹ï¼Œä¸»è¦æ˜¯åˆ†æˆä¸¤ä¸ªé˜Ÿåˆ—ï¼š</p><ul><li><p>ä¸€ä¸ªæ˜¯ JavaScript å¤–éƒ¨çš„é˜Ÿåˆ—ã€‚å¤–éƒ¨çš„é˜Ÿåˆ—ä¸»è¦æ˜¯æµè§ˆå™¨åè°ƒçš„å„ç±»äº‹ä»¶çš„é˜Ÿåˆ—ï¼Œæ ‡å‡†æ–‡ä»¶ä¸­ç§°ä¹‹ä¸º Task Queueã€‚ä¸‹æ–‡ä¸­ä¸ºäº†æ–¹ä¾¿ç†è§£ç»Ÿä¸€ç§°ä¸ºå¤–éƒ¨é˜Ÿåˆ—ã€‚</p></li><li><p>å¦ä¸€ä¸ªæ˜¯ JavaScript å†…éƒ¨çš„é˜Ÿåˆ—ã€‚è¿™éƒ¨åˆ†ä¸»è¦æ˜¯ JavaScript å†…éƒ¨æ‰§è¡Œçš„ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ ‡å‡†ä¸­ç§°ä¹‹ä¸º Microtask Queueã€‚ä¸‹æ–‡ä¸­ä¸ºäº†æ–¹ä¾¿ç†è§£ç»Ÿä¸€ç§°ä¸ºå†…éƒ¨é˜Ÿåˆ—ã€‚</p></li></ul><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶ä¸ºäº†å¥½ç†è§£ç®¡è¿™ä¸ªå«é˜Ÿåˆ— (Queue)ï¼Œä½†æ˜¯æœ¬è´¨ä¸Šæ˜¯æœ‰åºé›†åˆ (Set)ï¼Œå› ä¸ºä¼ ç»Ÿçš„é˜Ÿåˆ—éƒ½æ˜¯å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰çš„ï¼Œè€Œè¿™é‡Œçš„é˜Ÿåˆ—åˆ™ä¸ç„¶ï¼Œæ’åˆ°æœ€å‰é¢ä½†æ˜¯æ²¡æœ‰æ»¡è¶³æ¡ä»¶ä¹Ÿæ˜¯ä¸ä¼šæ‰§è¡Œçš„ï¼ˆæ¯”å¦‚å¤–éƒ¨é˜Ÿåˆ—é‡Œåªæœ‰ä¸€ä¸ª setTimeout çš„å®šæ—¶ä»»åŠ¡ï¼Œä½†æ˜¯æ—¶é—´è¿˜æ²¡æœ‰åˆ°ï¼Œæ²¡æœ‰æ»¡è¶³æ¡ä»¶ä¹Ÿä¸ä¼šæŠŠä»–å‡ºåˆ—æ¥æ‰§è¡Œï¼‰ã€‚</p><h2 id="å¤–éƒ¨é˜Ÿåˆ—"><a href="#å¤–éƒ¨é˜Ÿåˆ—" class="headerlink" title="å¤–éƒ¨é˜Ÿåˆ—"></a>å¤–éƒ¨é˜Ÿåˆ—</h2><p>å¤–éƒ¨é˜Ÿåˆ—å°±æ˜¯ JavaScript å¤–éƒ¨çš„äº‹ä»¶çš„é˜Ÿåˆ—ï¼Œäº‹ä»¶æºä¸»è¦æœ‰ï¼š</p><ul><li><p>DOM æ“ä½œ (é¡µé¢æ¸²æŸ“)</p></li><li><p>ç”¨æˆ·äº¤äº’ (é¼ æ ‡ã€é”®ç›˜)</p></li><li><p>ç½‘ç»œè¯·æ±‚ (Ajax ç­‰)</p></li><li><p>History API æ“ä½œ</p></li><li><p>å®šæ—¶å™¨ (setTimeout ç­‰) </p></li></ul><p>HTML æ ‡å‡†ä¸­æ˜ç¡®æŒ‡å‡ºä¸€ä¸ªäº‹ä»¶å¾ªç¯ç”±ä¸€ä¸ªæˆ–å¤šä¸ªå¤–éƒ¨é˜Ÿåˆ—ï¼Œè€Œæ¯ä¸€ä¸ªå¤–éƒ¨äº‹ä»¶æºéƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„å¤–éƒ¨é˜Ÿåˆ—ã€‚ä¸åŒäº‹ä»¶æºçš„é˜Ÿåˆ—å¯ä»¥æœ‰ä¸åŒçš„ä¼˜å…ˆçº§ï¼ˆä¾‹å¦‚åœ¨ç½‘ç»œäº‹ä»¶å’Œç”¨æˆ·äº¤äº’ä¹‹é—´ï¼Œæµè§ˆå™¨å¯ä»¥ä¼˜å…ˆå¤„ç†é¼ æ ‡è¡Œä¸ºï¼Œä»è€Œè®©ç”¨æˆ·æ„Ÿè§‰æ›´åŠ æµç¨‹ï¼‰ã€‚</p><h2 id="å†…éƒ¨é˜Ÿåˆ—"><a href="#å†…éƒ¨é˜Ÿåˆ—" class="headerlink" title="å†…éƒ¨é˜Ÿåˆ—"></a>å†…éƒ¨é˜Ÿåˆ—</h2><p>å†…éƒ¨é˜Ÿåˆ—ï¼ˆMicrotask Queueï¼‰ï¼Œå³ JavaScript è¯­è¨€å†…éƒ¨çš„äº‹ä»¶é˜Ÿåˆ—ï¼Œåœ¨ HTML æ ‡å‡†ä¸­ï¼Œå¹¶æ²¡æœ‰æ˜ç¡®è§„å®šè¿™ä¸ªé˜Ÿåˆ—çš„äº‹ä»¶æºï¼Œé€šå¸¸è®¤ä¸ºæœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ul><li><p>Promise çš„æˆåŠŸ (.then) ä¸å¤±è´¥ (.catch)</p></li><li><p>MutationObserver</p></li><li><p>Object.observe (å·²åºŸå¼ƒ)</p></li></ul><h2 id="å¤„ç†æ¨¡å‹"><a href="#å¤„ç†æ¨¡å‹" class="headerlink" title="å¤„ç†æ¨¡å‹"></a>å¤„ç†æ¨¡å‹</h2><p>åœ¨æ ‡å‡†å®šä¹‰ä¸­äº‹ä»¶å¾ªç¯çš„æ­¥éª¤æ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œæˆ‘ä»¬ç®€å•æè¿°ä¸€ä¸‹è¿™ä¸ªå¤„ç†è¿‡ç¨‹ï¼š</p><ol><li><p>ä»å¤–éƒ¨é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªå¯æ‰§è¡Œä»»åŠ¡ï¼Œå¦‚æœæœ‰åˆ™æ‰§è¡Œï¼Œæ²¡æœ‰ä¸‹ä¸€æ­¥ã€‚</p></li><li><p>æŒ¨ä¸ªå–å‡ºå†…éƒ¨é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œï¼Œæ‰§è¡Œå®Œæ¯•æˆ–æ²¡æœ‰ï¼Œåˆ™ä¸‹ä¸€æ­¥ã€‚</p></li><li><p>æµè§ˆå™¨æ¸²æŸ“ã€‚</p></li></ol><p><img src="https://chenxiumiao-1252816278.cos.ap-beijing.myqcloud.com/2021/02/22/20210222142647.png" alt="äº‹ä»¶å¾ªç¯ç®€åŒ–æ¨¡å‹"></p><p>ç”±ä¸Šæ–‡æ ‡å‡†ä¸­æåˆ°çš„æ ‡å‡†å¯çŸ¥ï¼šJavaScript çš„æ‰§è¡Œä¹Ÿæ˜¯ä¸€ä¸ªæµè§ˆå™¨å‘èµ·çš„å¤–éƒ¨äº‹ä»¶ã€‚</p><p>æ‰€ä»¥æœ¬è´¨çš„æ‰§è¡Œé¡ºåºæ˜¯ï¼š</p><ol><li><p>ä¸€æ¬¡å¤–éƒ¨äº‹ä»¶</p></li><li><p>æ‰€æœ‰å†…éƒ¨äº‹ä»¶</p></li><li><p>HTML æ¸²æŸ“</p></li><li><p>å›åˆ°åˆ° 1</p></li></ol><p>eg.:</p><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs HTML"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">pre</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;main&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span><br><span class="javascript">        <span class="hljs-keyword">const</span> main = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&#x27;#main&#x27;</span>);</span><br><span class="javascript">        <span class="hljs-keyword">const</span> callback = <span class="hljs-function">(<span class="hljs-params">i, fn</span>) =&gt;</span> <span class="hljs-function">() =&gt;</span> &#123;</span><br><span class="javascript">            <span class="hljs-built_in">console</span>.log(i)</span><br><span class="javascript">            main.innerText += fn(i);</span><br><span class="javascript">        &#125;;</span><br><span class="javascript">        <span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>;</span><br><span class="javascript">        <span class="hljs-keyword">while</span>(i++ &lt; <span class="hljs-number">5000</span>) &#123;</span><br><span class="javascript">            <span class="hljs-built_in">setTimeout</span>(callback(i, <span class="hljs-function">(<span class="hljs-params">i</span>) =&gt;</span> <span class="hljs-string">&#x27;\n&#x27;</span> + i + <span class="hljs-string">&#x27;&lt;&#x27;</span>))</span><br><span class="javascript">        &#125;</span><br><span class="javascript"></span><br><span class="javascript">        <span class="hljs-keyword">while</span>(i++ &lt; <span class="hljs-number">10000</span>) &#123;</span><br><span class="javascript">            <span class="hljs-built_in">Promise</span>.resolve().then(callback(i, <span class="hljs-function">(<span class="hljs-params">i</span>) =&gt;</span> i +<span class="hljs-string">&#x27;,&#x27;</span>))</span><br><span class="javascript">        &#125;</span><br><span class="javascript">        <span class="hljs-built_in">console</span>.log(i)</span><br><span class="javascript">        main.innerText += <span class="hljs-string">&#x27;[end &#x27;</span> + i + <span class="hljs-string">&#x27; ]\n&#x27;</span></span><br><span class="javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></div></td></tr></table></figure><ol><li><p>JavaScript æ‰§è¡Œå®Œæ¯• innerText é¦–å…ˆåŠ ä¸Š [end 10001]</p></li><li><p>å†…éƒ¨é˜Ÿåˆ—ï¼šPromise çš„ then å…¨éƒ¨ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œå¾€ innerText ä¸Šè¿½åŠ äº†å¾ˆé•¿ä¸€æ®µå­—ç¬¦ä¸²</p></li><li><p>HTML æ¸²æŸ“ï¼š1 å’Œ 2 è¿½åŠ åˆ° innerText ä¸Šçš„å†…å®¹åŒæ—¶æ¸²æŸ“</p></li><li><p>å¤–éƒ¨é˜Ÿåˆ—ï¼šæŒ¨ä¸ªæ‰§è¡Œ setTimeout ä¸­è¿½åŠ åˆ° innerText çš„å†…å®¹</p></li><li><p>HTML æ¸²æŸ“ï¼šå°† 4 ä¸­çš„å†…å®¹æ¸²æŸ“ã€‚</p></li><li><p>å›åˆ°ç¬¬ 4 æ­¥èµ°å¤–éƒ¨é˜Ÿåˆ—çš„æµç¨‹ï¼ˆå†…éƒ¨é˜Ÿåˆ—å·²æ¸…ç©ºï¼‰</p></li></ol><h2 id="æµè§ˆå™¨ä¸-Node-js-çš„äº‹ä»¶å¾ªç¯å·®å¼‚"><a href="#æµè§ˆå™¨ä¸-Node-js-çš„äº‹ä»¶å¾ªç¯å·®å¼‚" class="headerlink" title="æµè§ˆå™¨ä¸ Node.js çš„äº‹ä»¶å¾ªç¯å·®å¼‚"></a>æµè§ˆå™¨ä¸ Node.js çš„äº‹ä»¶å¾ªç¯å·®å¼‚</h2><p>æµè§ˆç«¯æ˜¯å°† JavaScript é›†æˆåˆ° HTML çš„äº‹ä»¶å¾ªç¯ä¹‹ä¸­ï¼ŒNode.js åˆ™æ˜¯å°† JavaScript é›†æˆåˆ° libuv çš„ I/O å¾ªç¯ä¹‹ä¸­ã€‚</p><p>HTML (æµè§ˆå™¨ç«¯) ä¸ libuv (æœåŠ¡ç«¯) é¢å¯¹çš„åœºæ™¯æœ‰å¾ˆå¤§çš„å·®å¼‚ã€‚é¦–å…ˆèƒ½ç›´è§‚æ„Ÿå—åˆ°çš„åŒºåˆ«æ˜¯ï¼š</p><ul><li><p>äº‹ä»¶å¾ªç¯çš„è¿‡ç¨‹æ²¡æœ‰ HTML æ¸²æŸ“ã€‚åªå‰©ä¸‹äº†å¤–éƒ¨é˜Ÿåˆ—å’Œå†…éƒ¨é˜Ÿåˆ—è¿™ä¸¤ä¸ªéƒ¨åˆ†ã€‚</p></li><li><p>å¤–éƒ¨é˜Ÿåˆ—çš„äº‹ä»¶æºä¸åŒã€‚Node.js ç«¯æ²¡æœ‰äº†é¼ æ ‡ç­‰å¤–è®¾ä½†æ˜¯æ–°å¢äº†æ–‡ä»¶ç­‰ IOã€‚</p></li><li><p>å†…éƒ¨é˜Ÿåˆ—çš„äº‹ä»¶ä»…å‰©ä¸‹ Promise çš„ then å’Œ catchã€‚</p></li></ul><p>Node.js ï¼ˆlibuvï¼‰åœ¨æœ€åˆè®¾è®¡çš„æ—¶å€™æ˜¯å…è®¸æ‰§è¡Œå¤šæ¬¡å¤–éƒ¨çš„äº‹ä»¶å†åˆ‡æ¢åˆ°å†…éƒ¨é˜Ÿåˆ—çš„ï¼Œè€Œæµè§ˆå™¨ç«¯ä¸€æ¬¡äº‹ä»¶å¾ªç¯åªå…è®¸æ‰§è¡Œä¸€æ¬¡å¤–éƒ¨äº‹ä»¶ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;timer1&#x27;</span>);<br>  <span class="hljs-built_in">Promise</span>.resolve().then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;promise1&#x27;</span>);<br>  &#125;);<br>&#125;);<br><br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;timer2&#x27;</span>);<br>  <span class="hljs-built_in">Promise</span>.resolve().then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;promise2&#x27;</span>);<br>  &#125;);<br>&#125;);<br></code></pre></div></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­åœ¨æµè§ˆå™¨ç«¯æ‰§è¡Œçš„ç»“æœæ˜¯ timer1 -&gt; promise1 -&gt; timer2 -&gt; promise2ï¼Œè€Œåœ¨ Node.js æ—©æœŸç‰ˆæœ¬ï¼ˆ11 ä¹‹å‰ï¼‰æ‰§è¡Œçš„ç»“æœå´æ˜¯ timer1 -&gt; timer2 -&gt; promise1 -&gt; promise2ã€‚</p><h3 id="æµè§ˆå™¨ç«¯"><a href="#æµè§ˆå™¨ç«¯" class="headerlink" title="æµè§ˆå™¨ç«¯"></a>æµè§ˆå™¨ç«¯</h3><ol><li><p>å¤–éƒ¨é˜Ÿåˆ—ï¼šä»£ç æ‰§è¡Œï¼Œä¸¤ä¸ª timeout åŠ å…¥å¤–éƒ¨é˜Ÿåˆ—</p></li><li><p>å†…éƒ¨é˜Ÿåˆ—ï¼šç©º</p></li><li><p>å¤–éƒ¨é˜Ÿåˆ—ï¼šç¬¬ä¸€ä¸ª timeout æ‰§è¡Œï¼Œpromise åŠ å…¥å†…éƒ¨é˜Ÿåˆ—</p></li><li><p>å†…éƒ¨é˜Ÿåˆ—ï¼šæ‰§è¡Œç¬¬ä¸€ä¸ª promise</p></li><li><p>å¤–éƒ¨é˜Ÿåˆ—ï¼šç¬¬äºŒä¸ª timeout æ‰§è¡Œï¼Œpromise åŠ å…¥å†…éƒ¨é˜Ÿåˆ—</p></li><li><p>å†…éƒ¨é˜Ÿåˆ—ï¼šæ‰§è¡Œç¬¬äºŒä¸ª promise</p></li></ol><h3 id="Node-js-æœåŠ¡ç«¯"><a href="#Node-js-æœåŠ¡ç«¯" class="headerlink" title="Node.js æœåŠ¡ç«¯"></a>Node.js æœåŠ¡ç«¯</h3><ol><li><p>å¤–éƒ¨é˜Ÿåˆ—ï¼šä»£ç æ‰§è¡Œï¼Œä¸¤ä¸ª timeout åŠ å…¥å¤–éƒ¨é˜Ÿåˆ—</p></li><li><p>å†…éƒ¨é˜Ÿåˆ—ï¼šç©º</p></li><li><p>å¤–éƒ¨é˜Ÿåˆ—ï¼šä¸¤ä¸ª timeout éƒ½æ‰§è¡Œå®Œ</p></li><li><p>å†…éƒ¨é˜Ÿåˆ—ï¼šä¸¤ä¸ª promise éƒ½æ‰§è¡Œå®Œ</p></li></ol><p>setImmediate çš„å¼•å…¥æ˜¯ä¸ºäº†è§£å†³ setTimeout çš„ç²¾åº¦é—®é¢˜ï¼Œç”±äº setTimeout æŒ‡å®šçš„å»¶è¿Ÿæ—¶é—´æ˜¯æ¯«ç§’ï¼ˆmsï¼‰ä½†å®é™…ä¸€æ¬¡æ—¶é—´å¾ªç¯çš„æ—¶é—´å¯èƒ½æ˜¯çº³ç§’çº§çš„ï¼Œæ‰€ä»¥åœ¨ä¸€æ¬¡äº‹ä»¶å¾ªç¯çš„å¤šä¸ªå¤–éƒ¨é˜Ÿåˆ—ä¸­ï¼Œæ‰¾åˆ°æŸä¸€ä¸ªé˜Ÿåˆ—ç›´æ¥æ‰§è¡Œå…¶ä¸­çš„ callback å¯ä»¥å¾—åˆ°æ¯” setTimeout æ›´æ—©æ‰§è¡Œçš„æ•ˆæœã€‚æˆ‘ä»¬ç»§ç»­ä»¥å¼€å§‹çš„åœºæ™¯æ„é€ ä¸€ä¸ªä¾‹å­ï¼Œå¹¶åœ¨ Node.js 10.x çš„ç‰ˆæœ¬ä¸Šæ‰§è¡Œ</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;setTimeout1&#x27;</span>);<br>  <span class="hljs-built_in">Promise</span>.resolve().then(<span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;promise1&#x27;</span>));<br>&#125;);<br><br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;setTimeout2&#x27;</span>);<br>  <span class="hljs-built_in">Promise</span>.resolve().then(<span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;promise2&#x27;</span>));<br>&#125;);<br><br>setImmediate(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;setImmediate1&#x27;</span>);<br>  <span class="hljs-built_in">Promise</span>.resolve().then(<span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;promise3&#x27;</span>));<br>&#125;);<br><br>setImmediate(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;setImmediate2&#x27;</span>);<br>  <span class="hljs-built_in">Promise</span>.resolve().then(<span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;promise4&#x27;</span>));<br>&#125;);<br></code></pre></div></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><ol><li>setImmediate1</li><li>setImmediate2</li><li>promise3</li><li>promise4</li><li>setTimeout1</li><li>setTimeout2</li><li>promise1</li><li>promise2</li></ol><p>è¿™é‡Œ setTimeout åœ¨ setImmediate åé¢æ‰§è¡Œçš„åŸå› æ˜¯å› ä¸º ms ç²¾åº¦çš„é—®é¢˜ï¼Œæƒ³è¦æ‰‹åŠ¨ fix è¿™ä¸ªç²¾åº¦å¯ä»¥æ’å…¥ä¸€æ®µ const now = Date.now(); wihle (Date.now() &lt; now + 1) {} å³å¯çœ‹åˆ° setTimeout åœ¨ setImmediate ä¹‹å‰æ‰§è¡Œäº†ã€‚</p><p>æ ¹æ®è¿™ä¸ªæ‰§è¡Œç»“æœï¼Œæˆ‘ä»¬å¯ä»¥æ¨æµ‹å‡º Node.js ä¸­çš„äº‹ä»¶å¾ªç¯ä¸æµè§ˆå™¨ç±»ä¼¼ï¼Œä¹Ÿæ˜¯å¤–éƒ¨é˜Ÿåˆ—ä¸å†…éƒ¨é˜Ÿåˆ—çš„å¾ªç¯ï¼Œè€Œ setImmediate åœ¨å¦å¤–ä¸€ä¸ªå¤–éƒ¨é˜Ÿåˆ—ä¸­ã€‚</p><p><img src="https://chenxiumiao-1252816278.cos.ap-beijing.myqcloud.com/2021/02/22/20210222143802.png" alt="Node.jsäº‹ä»¶å¾ªç¯å›¾"></p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹å½“ Node.js åœ¨ä¸æµè§ˆå™¨ç«¯å¯¹é½äº†äº‹ä»¶å¾ªç¯çš„äº‹ä»¶ä¹‹åï¼Œè¿™ä¸ªä¾‹å­çš„æ‰§è¡Œç»“æœä¸ºï¼š</p><ol><li>setImmediate1</li><li>promise3</li><li>setImmediate2</li><li>promise4</li><li>setTimeout1</li><li>promise1</li><li>setTimeout2</li><li>promise2</li></ol><p>å…¶ä¸­ä¸»è¦æœ‰ä¸¤ç‚¹éœ€è¦å…³æ³¨ï¼Œä¸€æ˜¯å¤–éƒ¨é˜Ÿåˆ—åœ¨æ¯æ¬¡äº‹ä»¶å¾ªç¯åªæ‰§è¡Œäº†ä¸€ä¸ªï¼Œå¦ä¸€ä¸ªæ˜¯ Node.js å›ºå®šäº†å¤šä¸ªå¤–éƒ¨é˜Ÿåˆ—çš„ä¼˜å…ˆçº§ã€‚setImmediate çš„å¤–éƒ¨é˜Ÿåˆ—æ²¡æœ‰æ‰§è¡Œå®Œçš„æ—¶å€™ï¼Œæ˜¯ä¸ä¼šæ‰§è¡Œ timeout çš„å¤–éƒ¨é˜Ÿåˆ—çš„ã€‚äº†è§£äº†è¿™ä¸ªç‚¹ä¹‹åï¼ŒNode.js çš„äº‹ä»¶å¾ªç¯å°±å˜å¾—å¾ˆç®€å•äº†ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸‹ Node.js å®˜æ–¹æ–‡æ¡£ä¸­å¯¹äºäº‹ä»¶å¾ªç¯é¡ºåºçš„å±•ç¤ºï¼š</p><p><img src="https://chenxiumiao-1252816278.cos.ap-beijing.myqcloud.com/2021/02/22/20210222143917.png" alt="Node.jså®˜æ–¹æ–‡æ¡£ä¹‹äº‹ä»¶å¾ªç¯"></p><p>å…¶ä¸­ check é˜¶æ®µæ˜¯ç”¨äºæ‰§è¡Œ setImmediate äº‹ä»¶çš„ã€‚ç»“åˆæœ¬æ–‡ä¸Šé¢çš„æ¨è®ºæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼ŒNode.js å®˜æ–¹è¿™ä¸ªæ‰€è°“äº‹ä»¶å¾ªç¯è¿‡ç¨‹ï¼Œå…¶å®åªæ˜¯å®Œæ•´çš„äº‹ä»¶å¾ªç¯ä¸­ Node.js çš„å¤šä¸ªå¤–éƒ¨é˜Ÿåˆ—ç›¸äº’ä¹‹é—´çš„ä¼˜å…ˆçº§é¡ºåºã€‚</p><p>eg:</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>);<br><br>setImmediate(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;setImmediate&#x27;</span>);<br>&#125;);<br><br>fs.readdir(__dirname, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;fs.readdir&#x27;</span>);<br>&#125;);<br><br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;setTimeout&#x27;</span>);<br>&#125;);<br><br><span class="hljs-built_in">Promise</span>.resolve().then(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;promise&#x27;</span>);<br>&#125;);<br></code></pre></div></td></tr></table></figure><p>è¾“å‡ºï¼š</p><blockquote><ol><li>promise</li><li>setTimeout</li><li>fs.readdir</li><li>setImmediate</li></ol></blockquote><p>æ ¹æ®è¾“å‡ºç»“æœï¼Œæˆ‘ä»¬å¯ä»¥æ¢³ç†å‡ºæ¥ï¼š</p><ol><li><p>å¤–éƒ¨é˜Ÿåˆ—ï¼šæ‰§è¡Œå½“å‰ script</p></li><li><p>å†…éƒ¨é˜Ÿåˆ—ï¼šæ‰§è¡Œ promise</p></li><li><p>å¤–éƒ¨é˜Ÿåˆ—ï¼šæ‰§è¡Œ setTimeout</p></li><li><p>å†…éƒ¨é˜Ÿåˆ—ï¼šç©º</p></li><li><p>å¤–éƒ¨é˜Ÿåˆ—ï¼šæ‰§è¡Œ fs.readdir</p></li><li><p>å†…éƒ¨é˜Ÿåˆ—ï¼šç©º</p></li><li><p>å¤–éƒ¨é˜Ÿåˆ—ï¼šæ‰§è¡Œ check ï¼ˆsetImmediateï¼‰</p></li></ol><p>è¿™ä¸ªé¡ºåºç¬¦åˆ Node.js å¯¹å…¶å¤–éƒ¨é˜Ÿåˆ—çš„ä¼˜å…ˆçº§å®šä¹‰ï¼š</p><p><img src="https://chenxiumiao-1252816278.cos.ap-beijing.myqcloud.com/2021/02/22/20210222145007.png" alt="ç¬¬ä¸€éƒ¨åˆ†"></p><p>timerï¼ˆsetTimeoutï¼‰æ˜¯ç¬¬ä¸€é˜¶æ®µçš„åŸå› åœ¨ libuv çš„æ–‡æ¡£ä¸­æœ‰æè¿° â€”â€” ä¸ºäº†å‡å°‘æ—¶é—´ç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨ï¼ˆSystem Callï¼‰ã€‚setImmediate å‡ºç°åœ¨ check é˜¶æ®µæ˜¯è¹­äº† libuv ä¸­ poll é˜¶æ®µä¹‹åçš„æ£€æŸ¥è¿‡ç¨‹ï¼ˆè¿™ä¸ªè¿‡ç¨‹æ”¾åœ¨ poll ä¸­ä¹Ÿå¾ˆå¥‡æ€ªï¼Œæ”¾åœ¨ poll ä¹‹åæ„Ÿè§‰æ¯”è¾ƒåˆé€‚ï¼‰ã€‚</p><p>idle, prepare å¯¹åº”çš„æ˜¯ libuv ä¸­çš„ä¸¤ä¸ªå«åš idle å’Œ prepare çš„å¥æŸ„ã€‚ç”±äº I/O çš„ poll è¿‡ç¨‹å¯èƒ½é˜»å¡ä½äº‹ä»¶å¾ªç¯ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªå¥æŸ„ä¸»è¦æ˜¯ç”¨æ¥è§¦å‘ poll ï¼ˆé˜»å¡ï¼‰ä¹‹å‰éœ€è¦è§¦å‘çš„å›è°ƒï¼š</p><p><img src="https://chenxiumiao-1252816278.cos.ap-beijing.myqcloud.com/2021/02/22/20210222145015.png" alt="ç¬¬äºŒéƒ¨åˆ†"></p><p>ç”±äº poll å¯èƒ½ block ä½äº‹ä»¶å¾ªç¯ï¼Œæ‰€ä»¥åº”å½“æœ‰ä¸€ä¸ªå¤–éƒ¨é˜Ÿåˆ—ä¸“é—¨ç”¨äºæ‰§è¡Œ I/O çš„ callback ï¼Œå¹¶ä¸”ä¼˜å…ˆçº§åœ¨ poll ä»¥åŠ prepare to poll ä¹‹å‰ã€‚</p><p>å¦å¤–æˆ‘ä»¬çŸ¥é“ç½‘ç»œ IO å¯èƒ½æœ‰éå¸¸å¤šçš„è¯·æ±‚åŒæ—¶è¿›æ¥ï¼Œå¦‚æœè¯¥é˜¶æ®µå¦‚æœæ— é™åˆ¶çš„æ‰§è¡Œè¿™äº› callbackï¼Œå¯èƒ½å¯¼è‡´ Node.js çš„è¿›ç¨‹å¡æ­»è¯¥é˜¶æ®µï¼Œå…¶ä»–å¤–éƒ¨é˜Ÿåˆ—çš„ä»£ç éƒ½æ²¡å‘æ‰§è¡Œäº†ã€‚æ‰€ä»¥å½“å‰å¤–éƒ¨é˜Ÿåˆ—åœ¨æ‰§è¡Œä¸€å®šæ•°é‡çš„ callback ä¹‹åä¼šæˆªæ–­ã€‚ç”±äºæˆªæ–­çš„è¿™ä¸ªç‰¹æ€§ï¼Œè¿™ä¸ªä¸“é—¨æ‰§è¡Œ I/O callbacks çš„å¤–éƒ¨é˜Ÿåˆ—ä¹Ÿå« pengding callbacksï¼š</p><p><img src="https://chenxiumiao-1252816278.cos.ap-beijing.myqcloud.com/2021/02/22/20210222145027.png" alt="å®Œæ•´"></p>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Node.js</tag>
      
      <tag>JavaScript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>enzymeå­¦ä¹ è®°å½•ä¹‹Shallow,Mount,renderçš„åŒºåˆ«</title>
    <link href="/article/d1e3eefb/"/>
    <url>/article/d1e3eefb/</url>
    
    <content type="html"><![CDATA[<h2 id="render"><a href="#render" class="headerlink" title="render"></a>render</h2><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Render react components to static HTML and analyze the resulting HTML structure.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">render</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt;(<span class="hljs-params">node: ReactElement&lt;P&gt;, options?: any</span>): <span class="hljs-title">cheerio</span>.<span class="hljs-title">Cheerio</span></span>;<br><br></code></pre></div></td></tr></table></figure><p>é€šè¿‡è·Ÿè¿›æ–¹æ³•å¯ä»¥çœ‹åˆ°æ³¨é‡Šè¡¨æ˜ï¼šæ˜¯å°†Reactç»„ä»¶æ¸²æŸ“ä¸ºHTMLç»“æ„ã€‚<br>é€šè¿‡æŸ¥é˜…èµ„æ–™åˆå¾—å‡ºï¼šè¯¥renderæ–¹æ³•ä»…è°ƒç”¨ç»„ä»¶å†…çš„renderæ–¹æ³•ï¼Œä½†æ˜¯ä¼šæ¸²æŸ“å…¨éƒ¨çš„å­ç»„ä»¶</p><h2 id="shallow"><a href="#shallow" class="headerlink" title="shallow"></a>shallow</h2><p>æµ…æ¸²æŸ“ï¼Œä¸€ä¸ªçœŸæ­£çš„å•å…ƒæµ‹è¯•ã€‚å­ç»„ä»¶å¹¶ä¸ä¼šæ¸²æŸ“ã€‚æ¸²æŸ“çš„ç»“æœä¸ºReactæ ‘ã€‚<br>åœ¨è°ƒç”¨è¯¥æ–¹æ³•æ—¶ï¼Œä¼šè°ƒç”¨ç»„ä»¶å†…çš„ç”Ÿå‘½å‘¨æœŸï¼š<code>constructor</code>å’Œ<code>render</code>ã€‚<br>åœ¨ä½¿ç”¨è¯¥æ–¹æ³•æ¸²æŸ“åä¼šå¾—åˆ°ä¸€ä¸ªï¼š<code>ShallowWrapper</code>,<code>ShallowWrapper</code>å†…éƒ¨åˆåŒ…å«åˆ<code>setProps</code>æ–¹æ³•ï¼Œåœ¨è°ƒç”¨<code>setProps</code>æ–¹æ³•æ—¶ï¼Œåˆ™ä¼šè°ƒç”¨ç”Ÿå‘½å‘¨æœŸï¼š </p><ul><li><code>componentWillReceiveProps</code></li><li><code>shouldComponentUpdate</code></li><li><code>componentWillUpdate</code></li><li><code>render</code><br>å½“<code>ShallowWrapper</code>è°ƒç”¨<code>unmount</code>æ–¹æ³•æ—¶ï¼Œä»…è°ƒç”¨ç”Ÿå‘½å‘¨æœŸçš„<code>componentWillUnmount</code></li></ul><h2 id="mount"><a href="#mount" class="headerlink" title="mount"></a>mount</h2><p>æµ‹è¯•<code>componentDidMount</code>å’Œ<code>componentDidUpdate</code>çš„å”¯ä¸€æ–¹å¼ï¼Œä¼šæ¸²æŸ“åŒ…æ‹¬å­ç»„ä»¶åœ¨å†…çš„æ‰€æœ‰ç»„ä»¶ã€‚æ¸²æŸ“ç»“æœä¸ºReactæ ‘<br>åœ¨è°ƒç”¨è¯¥æ–¹æ³•æ—¶ï¼Œä¼šè°ƒç”¨ç»„ä»¶å†…çš„ç”Ÿå‘½å‘¨æœŸ</p><ul><li><code>constructor</code></li><li><code>render</code></li><li><code>componentDidMount</code><br>ä½¿ç”¨<code>mount</code>çš„è¿”å›å€¼ä¸º<code>ReactWrapper</code>ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨<code>setProps</code>æ–¹æ³•ï¼Œè°ƒç”¨çš„ç”Ÿå‘½å‘¨æœŸä¸º</li><li><code>componentWillReceiveProps</code></li><li><code>shouldComponentUpdate</code></li><li><code>componentWillUpdate</code></li><li><code>render</code></li><li><code>componentDidUpdate</code><br>åœ¨ä½¿ç”¨<code>unmount</code>æ—¶ï¼Œ</li><li><code>componentWillUnmount</code></li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>å¦‚æœéœ€è¦æµ‹è¯•<code>componentDidMount</code>å’Œ<code>componentDidUpdate</code>ï¼Œå°±ä½¿ç”¨<code>mount</code></li><li>å¦‚æœæ²¡å¿…è¦æ¸²æŸ“å­ç»„ä»¶ï¼Œä½¿ç”¨<code>shallow</code></li><li>å¦‚æœä¸æ¶‰åŠåˆ°ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œä½¿ç”¨<code>render</code></li></ul>]]></content>
    
    
    <categories>
      
      <category>è‡ªåŠ¨åŒ–æµ‹è¯•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è‡ªåŠ¨åŒ–æµ‹è¯•</tag>
      
      <tag>jest</tag>
      
      <tag>enzyme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>travis-ciå­¦ä¹ è®°å½•</title>
    <link href="/article/1dae22d5/"/>
    <url>/article/1dae22d5/</url>
    
    <content type="html"><![CDATA[<p>åè¯è§£é‡Šå¤§éƒ¨åˆ†å‡ä¸ºæœºå™¨ç›´ç¿»ï¼Œéƒ¨åˆ†ç¨åŠ ä¸ªäººç†è§£</p><h2 id="åè¯è§£é‡Š"><a href="#åè¯è§£é‡Š" class="headerlink" title="åè¯è§£é‡Š"></a>åè¯è§£é‡Š</h2><ul><li>jobï¼šä¸€ä¸ªè‡ªåŠ¨åŒ–çš„è¿‡ç¨‹ï¼Œå…‹éš†å­˜å‚¨åº“åˆ°ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼Œç„¶åæ‰§è¡Œä¸€ç³»åˆ—çš„<em>phases</em>ï¼Œå¦‚ç¼–è¯‘ä»£ç ï¼Œè¿è¡Œæµ‹è¯•ç­‰ã€‚å¦‚æœ<code>script</code>é˜¶æ®µçš„è¿”å›ä»£ç éé›¶ï¼Œåˆ™ä½œä¸šå¤±è´¥ã€‚</li><li>phaseï¼š<em>job</em>çš„è¿ç»­æ­¥éª¤ã€‚ä¾‹å¦‚ï¼Œ<code>install</code>é˜¶æ®µåœ¨<code>script</code>é˜¶æ®µä¹‹å‰ï¼Œ<code>script</code>é˜¶æ®µåœ¨å¯é€‰çš„<code>deploy</code>é˜¶æ®µä¹‹å‰ã€‚</li><li>buildï¼šæŒ‰é¡ºåºè¿è¡Œçš„ä¸€ç»„<em>job</em>ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ª<em>build</em>å¯èƒ½æœ‰ä¸¤ä¸ª<em>job</em>ï¼Œæ¯ä¸ª<em>job</em>ç”¨ä¸åŒç‰ˆæœ¬çš„ç¼–ç¨‹è¯­è¨€æµ‹è¯•ä¸€ä¸ªé¡¹ç›®ã€‚å½“æ‰€æœ‰çš„<em>job</em>éƒ½å®Œæˆæ—¶ï¼Œ<em>build</em>å°±ç»“æŸäº†ã€‚</li><li>stageï¼š<em>build stages</em>æ˜¯å¯¹<em>job</em>è¿›è¡Œåˆ†ç»„çš„ä¸€ç§æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨æ¯ä¸ª<em>stage</em>ä¸­å¹¶è¡Œè¿è¡Œ<em>job</em>ï¼Œä½†æ˜¯è¦æŒ‰é¡ºåºè¿è¡Œ<em>stage</em>ã€‚</li></ul><h2 id="ç”Ÿå‘½å‘¨æœŸ"><a href="#ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ"></a>ç”Ÿå‘½å‘¨æœŸ</h2><ol><li><code>apt addons</code> - å¯é€‰ï¼Œç”¨æ¥æ·»åŠ aptæºã€aptåŒ…ç­‰</li><li><code>cache component</code> - å¯é€‰ï¼Œç”¨æ¥è®¾ç½®ç¼“å­˜ä¸ç»å¸¸æ›´æ”¹çš„ä¸œè¥¿ï¼ŒåŠ å¿«æ„å»ºé€Ÿåº¦</li><li><code>before_install</code> - åœ¨<code>install</code>ä¹‹å‰</li><li><code>install</code> - å®‰è£…éœ€è¦çš„ä¾èµ–ï¼Œå¯ä»¥æŒ‡å®šè‡ªå·±çš„è„šæœ¬æ¥å®‰è£…ä¾èµ–ï¼Œå¦åˆ™å–å†³äºè¯­è¨€</li><li><code>before_script</code> - åœ¨<code>script</code>ä¹‹å‰</li><li><code>script</code> - è¿è¡Œæ„å»ºè„šæœ¬</li><li><code>before_cache</code> - å¯é€‰ï¼Œå½“åˆ‡ä»…å½“ç¼“å­˜ç”Ÿæ•ˆæ—¶</li><li><code>after_success</code> æˆ–<code>after_failure</code> - å½“æ„å»ºæˆåŠŸ/å¤±è´¥åï¼Œç»“æœä¿å­˜åœ¨<code>TRAVIS_TEST_RESULT</code>ç¯å¢ƒå˜é‡ä¸­ã€‚</li><li><code>before_deploy</code> - å¯é€‰ï¼Œå½“ä¸”ä»…å½“éƒ¨ç½²å¤„äºæ´»åŠ¨çŠ¶æ€</li><li><code>deploy</code> - å¯é€‰ï¼Œéƒ¨ç½²</li><li><code>after_deploy</code> - å¯é€‰ï¼Œå½“ä¸”ä»…å½“éƒ¨ç½²å¤„äºæ´»åŠ¨çŠ¶æ€</li><li><code>after_script</code> - åœ¨<code>script</code>ä¹‹å</li></ol><h3 id="ä¸­æ–­æ„å»º"><a href="#ä¸­æ–­æ„å»º" class="headerlink" title="ä¸­æ–­æ„å»º"></a>ä¸­æ–­æ„å»º</h3><ul><li>å¦‚æœ<code>befor_install</code>ã€<code>install</code>å’Œ<code>before_script</code>è¿”å›ä¸€ä¸ªé0çš„é€€å‡ºç ï¼Œåˆ™æ„å»ºå‡ºé”™å¹¶ä¸”ç«‹å³é€€å‡ºã€‚</li><li>å¦‚æœ<code>script</code>è¿”å›éé›¶é€€å‡ºç ï¼Œåˆ™æ„å»ºå¤±è´¥ï¼Œä½†åœ¨è¢«æ ‡è®°ä¸ºå¤±è´¥ä¹‹å‰ç»§ç»­è¿è¡Œã€‚</li><li><code>after _ success</code>ã€<code>after _ failure</code>ã€<code>after _ script</code>ã€<code>after _ deploy</code> å’Œåç»­é˜¶æ®µçš„é€€å‡ºä»£ç ä¸å½±å“æ„å»ºç»“æœã€‚ä½†æ˜¯ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªé˜¶æ®µè¶…æ—¶ï¼Œæ„å»ºå°†è¢«æ ‡è®°ä¸ºå¤±è´¥ã€‚</li></ul><h2 id="å®è·µé‡åˆ°çš„é—®é¢˜è®°å½•"><a href="#å®è·µé‡åˆ°çš„é—®é¢˜è®°å½•" class="headerlink" title="å®è·µé‡åˆ°çš„é—®é¢˜è®°å½•"></a>å®è·µé‡åˆ°çš„é—®é¢˜è®°å½•</h2><p>æŒ‰ç…§<a href="https://docs.travis-ci.com/user/deployment/npm/">å‘å¸ƒnpm</a>é…ç½®ä¸€ä¸ªæœ€ç®€å•çš„npmå‘å¸ƒã€‚</p><p>åœ¨é…ç½®ä¸­å¹¶æœªé…ç½®testé˜¶æ®µï¼Œä½†æ˜¯travisCIä¼šé»˜è®¤åœ¨æ‰§è¡Œå®Œ <code>npm install</code>å³ <code>install</code>é˜¶æ®µåæ‰§è¡Œ <code>npm run test</code>ã€‚ä¸€å¼€å§‹æˆ‘åœ¨ <code>package.json</code>é…ç½®çš„ <code>&quot;test&quot;: &quot;npm run test is running!&quot;,</code>ã€‚çœ‹travisä¸­çš„æ—¥å¿—å‘ç°ä¸€ç›´æ­»å¾ªç¯åœ¨æ‰§è¡Œ <code>npm run test</code> ï¼ŒåŸæ¥è¿™ä¸ªåœ¨é‡Œé¢ä¼šè½¬æ¢æˆç›¸åº”çš„å‘½ä»¤ï¼Œæƒ³è¾“å‡ºé…ç½®ä¿¡æ¯åº”è¯¥ <code>&quot;test&quot;: &quot;echo \&quot; ci run success \&quot;&quot;</code></p>]]></content>
    
    
    <categories>
      
      <category>æ—§åšå®¢æ–‡ç« </category>
      
    </categories>
    
    
    <tags>
      
      <tag>å·¥ç¨‹åŒ–</tag>
      
      <tag>æŒç»­åŒ–é›†æˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è„šæ‰‹æ¶å¼€å‘è®°å½•</title>
    <link href="/article/ffeb6d55/"/>
    <url>/article/ffeb6d55/</url>
    
    <content type="html"><![CDATA[<h1 id="è„šæ‰‹æ¶å¼€å‘è®°å½•"><a href="#è„šæ‰‹æ¶å¼€å‘è®°å½•" class="headerlink" title="è„šæ‰‹æ¶å¼€å‘è®°å½•"></a>è„šæ‰‹æ¶å¼€å‘è®°å½•</h1><ul><li><input checked="" disabled="" type="checkbox"> è¾“å…¥æ¨¡å—</li><li><input checked="" disabled="" type="checkbox"> è¾“å‡ºæ¨¡å—</li><li><input checked="" disabled="" type="checkbox"> gitæ“ä½œæ¨¡å—</li></ul><h2 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h2><p>é¦–å…ˆåˆå§‹åŒ–é¡¹ç›® <code>npm init</code></p><p>åœ¨ <code>package.json</code>ä¸­æ·»åŠ è„šæœ¬çš„å…¥å£æ–‡ä»¶ï¼Œ</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;bin&quot;</span>:&#123;<br>    <span class="hljs-attr">&quot;acbg&quot;</span>:&#x27;bin/init.js&#x27; <span class="hljs-comment">//æ ¼å¼ä¸ºâ€œå‘½ä»¤åâ€ï¼šâ€œå…¥å£æ–‡ä»¶ç›¸å¯¹package.jsonçš„è·¯å¾„â€</span><br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å»ºç«‹å…¥å£æ–‡ä»¶ <code>mkdir bin &amp;&amp; touch bin/init.js</code></p><p>åœ¨init.jsæ–‡ä»¶ä¸­è¾“å…¥ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-meta">#!/usr/bin/env node</span><br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;Hello,Cli&#x27;</span>);<br></code></pre></div></td></tr></table></figure><p><strong>å…¥å£æ–‡ä»¶çš„ç¬¬ä¸€è¡Œä¸€å®šè¦æ·»åŠ  <code>#!/usr/bin/env node</code> ï¼Œè¿™è¡Œä»£ç çš„æ„æ€æ˜¯æŒ‡å®šè„šæœ¬ä½¿ç”¨nodeè¿è¡Œï¼Œå³å½“æˆ‘ä»¬è¾“å…¥ <code>acbg</code>æ—¶å®é™…ä¸Šè¿è¡Œçš„æ˜¯ <code>node acbg</code></strong></p><p><em>envä¸­åŒ…å«äº†è®¸å¤šç³»ç»Ÿç¯å¢ƒå˜é‡ï¼Œ<code>/usr/bin/env node</code>ä½¿ç”¨è¿™ä¸ªæ˜¯ä¸ºäº†é˜²æ­¢ç”¨æˆ·æ²¡æœ‰å°†nodeå®‰è£…åœ¨é»˜è®¤çš„/usr/binä¸‹ï¼Œå½“ç³»ç»Ÿçœ‹åˆ°è¿™ä¸€è¡Œçš„æ—¶å€™ï¼Œé¦–å…ˆä¼šæ‰¾åˆ°envé‡Œé¢çš„nodeå®‰è£…è·¯å¾„ï¼Œåœ¨è°ƒå–nodeã€‚</em></p><p>é€šè¿‡ <code>package.json</code>é…ç½®æˆ‘ä»¬éœ€è¦çš„æ–‡ä»¶ï¼ˆæˆ–è€…æ˜¯å»é™¤ä¸éœ€è¦çš„ï¼‰ï¼Œ<strong>ä¸€å®šè¦å»é™¤node_modules,ä¸ç„¶linkçš„æ—¶å€™ä¼šå·¨æ…¢</strong></p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br><span class="hljs-attr">&quot;files&quot;</span>:[<span class="hljs-string">&quot;./bin&quot;</span>,<span class="hljs-string">&quot;./src&quot;</span>]<br>&#125;<br></code></pre></div></td></tr></table></figure><p><em>ä¹Ÿå¯ä»¥é€šè¿‡ <code>.gitignore</code>æˆ– <code>.npmrc</code>ç­‰é…ç½®æ–‡ä»¶å¿½ç•¥ã€‚</em></p><p>ä¸ºäº†æ–¹ä¾¿åœ¨æœ¬åœ°æµ‹è¯•ï¼Œåœ¨å½“å‰é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œ <code>npm link</code></p><p><em><code>npm link</code>åœ¨å…¨å±€nodeåŒ…å†…å»ºç«‹äº†å½“å‰é¡¹ç›®çš„æ›¿èº«ï¼Œå½“è®¿é—®åˆ°å…¨å±€nodeåŒ…ä¸­çš„å½“å‰é¡¹ç›®æ—¶ä¼šè½¬åˆ°å½“å‰é¡¹ç›®å®é™…æ‰€åœ¨è·¯å¾„,å¯ä»¥ç®€å•çš„ç†è§£ä¸ºç›¸å½“äºæ‰§è¡Œäº† <code>npm install -g å½“å‰é¡¹ç›®</code></em></p><p>åœ¨ç»ˆç«¯è¿è¡Œ <code>acbg</code>æµ‹è¯•å‘½ä»¤æ˜¯å¦æˆåŠŸã€‚</p><h2 id="åˆ†æå·¥å…·é€»è¾‘"><a href="#åˆ†æå·¥å…·é€»è¾‘" class="headerlink" title="åˆ†æå·¥å…·é€»è¾‘"></a>åˆ†æå·¥å…·é€»è¾‘</h2><p>ç›®æ ‡ï¼šç”¨æˆ·åœ¨è¿è¡Œcliåè¾“å…¥ä¸€äº›å€¼ï¼Œå¯ä»¥æ‰¹é‡åœ¨gitlabä¸Šå¯¹åº”é¡¹ç›®å»ºç«‹æ–°çš„åˆ†æ”¯ã€‚</p><p>é¦–å…ˆå°†å·¥å…·åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå·¥å…·å†…éƒ¨ä¸å·¥å…·å¤–éƒ¨ï¼ˆå³éœ€è¦äººå·¥å¹²é¢„æ“ä½œè¾“å…¥çš„ï¼‰ã€‚</p><p>åœ¨åˆ†æå·¥å…·å¤–éƒ¨æ—¶ï¼Œå¯ä»¥å°†å·¥å…·å†…éƒ¨å½“æˆé»‘ç›’ï¼Œåªå…³å¿ƒè¾“å…¥ä¸è¾“å‡ºã€‚</p><p>å¤–éƒ¨æµç¨‹ï¼š</p><p><img src="https://chenxiumiao-1252816278.cos.ap-beijing.myqcloud.com/2020/11/24/%E5%A4%96%E9%83%A8%E6%B5%81%E7%A8%8B.png" alt="å¤–éƒ¨æµç¨‹"></p><p>å†…éƒ¨æµç¨‹ï¼š</p><p><img src="https://chenxiumiao-1252816278.cos.ap-beijing.myqcloud.com/2020/11/24/%E5%86%85%E9%83%A8%E6%B5%81%E7%A8%8B.png" alt="å†…éƒ¨æµç¨‹"></p><p>é€šè¿‡æµç¨‹å›¾æ¨ç®—å‡ºéœ€è¦åšçš„æ¨¡å—ï¼š</p><p><img src="https://chenxiumiao-1252816278.cos.ap-beijing.myqcloud.com/2020/11/24/%E6%A8%A1%E5%9D%97.png" alt="æ¨¡å—"></p><p>ç”±æ¨¡å—å›¾å¯ä»¥å¾—å‡ºéœ€è¦åšçš„åŠŸèƒ½ï¼ŒæŒ‰ç…§è¿™äº›æ¨¡å—åˆ†åˆ«å®ç°å¯¹åº”çš„å‡½æ•°å°±å¯ä»¥äº†ã€‚</p><h2 id="å‘½ä»¤è¡Œäº¤äº’"><a href="#å‘½ä»¤è¡Œäº¤äº’" class="headerlink" title="å‘½ä»¤è¡Œäº¤äº’"></a>å‘½ä»¤è¡Œäº¤äº’</h2><p>å‘½ä»¤è¡Œäº¤äº’ä½¿ç”¨<a href="https://www.npmjs.com/package/inquirer">inquirer</a>ã€‚</p><p>å…·ä½“ä¾‹å­å¯ä»¥çœ‹é“¾æ¥å†…å®˜æ–¹æä¾›çš„ç¤ºä¾‹ã€‚</p><p>è¾“å…¥gitlabåœ°å€æ¨¡å—ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> inquirer = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;inquirer&#x27;</span>);<br><span class="hljs-keyword">const</span> CONFIG = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./config&#x27;</span>).CONFIG;<br><br><span class="hljs-keyword">const</span> getAddress = <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-keyword">return</span> inquirer.prompt(&#123;<br>    <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;input&#x27;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;address&#x27;</span>,<br>    <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;è¯·è¾“å…¥gitlabåœ°å€&#x27;</span><br>  &#125;).then(<span class="hljs-function">(<span class="hljs-params">ans</span>) =&gt;</span> &#123;<br>    CONFIG.address = ans.address;<br>  &#125;)<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å…¶ä»–è¾“å…¥æ¨¡å—ä¹ŸæŒ‰ç…§è¿™æ ·å­åšå‡ºæ¥ã€‚</p><h2 id="å·¥å…·å¤„ç†è¿‡ç¨‹"><a href="#å·¥å…·å¤„ç†è¿‡ç¨‹" class="headerlink" title="å·¥å…·å¤„ç†è¿‡ç¨‹"></a>å·¥å…·å¤„ç†è¿‡ç¨‹</h2><h3 id="è·å–ä¸tokenå¯¹åº”åœ°å€ä¸‹çš„é¡¹ç›®ä¿¡æ¯"><a href="#è·å–ä¸tokenå¯¹åº”åœ°å€ä¸‹çš„é¡¹ç›®ä¿¡æ¯" class="headerlink" title="è·å–ä¸tokenå¯¹åº”åœ°å€ä¸‹çš„é¡¹ç›®ä¿¡æ¯"></a>è·å–ä¸tokenå¯¹åº”åœ°å€ä¸‹çš„é¡¹ç›®ä¿¡æ¯</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> getProjectInfo = <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-keyword">return</span> axios.get(<span class="hljs-string">`https://gitlab.<span class="hljs-subst">$&#123;CONFIG.address&#125;</span>.com/api/v4/projects?private_token=<span class="hljs-subst">$&#123;CONFIG.token&#125;</span>`</span>)<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å°†è·å–åˆ°çš„ä¿¡æ¯æ ¼å¼åŒ–è¾“å‡º"><a href="#å°†è·å–åˆ°çš„ä¿¡æ¯æ ¼å¼åŒ–è¾“å‡º" class="headerlink" title="å°†è·å–åˆ°çš„ä¿¡æ¯æ ¼å¼åŒ–è¾“å‡º"></a>å°†è·å–åˆ°çš„ä¿¡æ¯æ ¼å¼åŒ–è¾“å‡º</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//å±•ç¤ºprojectä¿¡æ¯</span><br><span class="hljs-keyword">const</span> showProjectInfo = <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> &#123; projectInfo &#125; = CONFIG;<br>  projectInfo.forEach(<span class="hljs-function">(<span class="hljs-params">value, index</span>) =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`project ID:<span class="hljs-subst">$&#123;value.id&#125;</span>   project Name:<span class="hljs-subst">$&#123;value.name&#125;</span>    project repo:<span class="hljs-subst">$&#123;value.repo&#125;</span>`</span>);<br>  &#125;)<br>&#125;<br></code></pre></div></td></tr></table></figure><p>tips:å¯ä»¥ä½¿ç”¨<a href="https://www.npmjs.com/package/chalk">chalk</a>æ¥ä¸ºæ§åˆ¶å°æ·»åŠ ä¸€ç‚¹é¢œè‰²æ›´åŠ ç¾è§‚ã€‚</p><h3 id="å…‹éš†é¡¹ç›®"><a href="#å…‹éš†é¡¹ç›®" class="headerlink" title="å…‹éš†é¡¹ç›®"></a>å…‹éš†é¡¹ç›®</h3><p>ä½¿ç”¨<a href="https://www.npmjs.com/package/download-git-repo">download-git-repo</a>æ¥cloneé¡¹ç›®ï¼Œå…·ä½“ä½¿ç”¨æ–¹æ³•å¯ä»¥æŸ¥çœ‹è¯´æ˜é¡µã€‚åŸºäºè¯¥packagesä¸­çš„æ–¹æ³•å°è£…cloneçš„æ–¹æ³•</p><p>20201126æ›´æ–°ï¼šdownload-git-repoåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­æœ‰ä¸€äº›é—®é¢˜ï¼Œå†åŠ ä¸Šè¿™ä¸ªå·¥å…·ä»…éœ€è¦ä½¿ç”¨cloneåŠŸèƒ½ï¼Œå› æ­¤æ”¹æˆ<a href="https://www.npmjs.com/package/git-clone">git-clone</a>è¿™ä¸ªåº“ã€‚</p><p>download-git-repoé‡åˆ°çš„é—®é¢˜ï¼š</p><p><img src="https://chenxiumiao-1252816278.cos.ap-beijing.myqcloud.com/2020/11/26/1606398697.png" alt="image.png"></p><p>åœ¨è®¾ç½®ç¬¬ä¸‰ä¸ªå‚æ•°ä¸º <code>clone:true</code>åï¼Œåœ¨æ²¡æœ‰æŠ¥é”™çš„æƒ…å†µä¸‹ä¼šå¼•èµ· <code>.git</code>ä¿¡æ¯è¢«åˆ é™¤ï¼Œè‡´ä½¿åç»­æ“ä½œæ— æ³•è¿›è¡Œã€‚</p><p>åŸä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> downloadRepo = <span class="hljs-function">(<span class="hljs-params">repo, name</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>    download(<span class="hljs-string">`direct:<span class="hljs-subst">$&#123;repo&#125;</span>`</span>, name, &#123; <span class="hljs-attr">clone</span>: <span class="hljs-literal">true</span> &#125;, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span> (err) reject(err);<br>      resolve(<span class="hljs-string">&#x27;success&#x27;</span>);<br>    &#125;)<br>  &#125;)<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ–°ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> cloneRepo = <span class="hljs-function">(<span class="hljs-params">repo, name</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>    gitClone(repo, name, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span> (!!err) reject(err);<br>      resolve(<span class="hljs-string">&#x27;download success&#x27;</span>);<br>    &#125;)<br>  &#125;)<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å°è£…æ‰§è¡Œshellå‘½ä»¤æ–¹æ³•"><a href="#å°è£…æ‰§è¡Œshellå‘½ä»¤æ–¹æ³•" class="headerlink" title="å°è£…æ‰§è¡Œshellå‘½ä»¤æ–¹æ³•"></a>å°è£…æ‰§è¡Œshellå‘½ä»¤æ–¹æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> runCMD = <span class="hljs-function">(<span class="hljs-params">cmd</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>    childProcess.exec(cmd, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span> (!!err) reject(err);<br>      resolve(<span class="hljs-string">&#x27;run CMD success&#x27;</span>)<br>    &#125;)<br>  &#125;)<br>&#125;<br></code></pre></div></td></tr></table></figure><p><del>åç»­çš„æ‰“å¼€é¡¹ç›®ç›®å½•ï¼Œåˆ‡æ¢åˆ°æºåˆ†æ”¯ï¼Œæ‹‰å–æ–°åˆ†æ”¯ï¼Œæ¨é€åˆ°è¿œç«¯éƒ½å¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ¥åšåˆ°ï¼Œå› ä¸ºè¿™äº›æŒ‡ä»¤ä¹‹é—´æ˜¯æœ‰å…ˆåé¡ºåºä¾èµ–å…³ç³»çš„ï¼Œæ‰€ä»¥å°è£…æˆä¸€ä¸ªpromiseã€‚</del></p><p>20201126æ›´æ–°ï¼šæœ¬æƒ³å†å°†runCMDå°è£…æˆå¤šä¸ªæ–¹æ³•ï¼Œç„¶åå°†ä»–ä»¬é“¾å¼è°ƒç”¨ï¼Œç»“æœå› ä¸ºchildProcessæ¯ä¸ªå‘½ä»¤ä¸åœ¨ä¸€ä¸ªè¿›ç¨‹é‡Œï¼Œæ‰€ä»¥å¤±è´¥ã€‚</p><h2 id="ç»„è£…"><a href="#ç»„è£…" class="headerlink" title="ç»„è£…"></a>ç»„è£…</h2><p>ä»¥ä¸Šæ­¥éª¤å·²ç»å°†æ‰€éœ€è¦çš„ç§¯æœ¨å‡†å¤‡å¥½ï¼Œç°åœ¨åªéœ€è¦å°†ç§¯æœ¨æ‹¼åœ¨ä¸€èµ·å°±å¯ä»¥å½¢æˆå®Œæˆçš„cliäº†ã€‚</p><p>å®Œæˆå“å¯è§ï¼š<a href="https://github.com/AruSeito/all-checkout-gitlab">all-checkout-branch</a></p><h2 id="æŒç»­ä¼˜åŒ–é¡¹"><a href="#æŒç»­ä¼˜åŒ–é¡¹" class="headerlink" title="æŒç»­ä¼˜åŒ–é¡¹"></a>æŒç»­ä¼˜åŒ–é¡¹</h2><ul><li><input checked="" disabled="" type="checkbox"> CI/CDã€‚ï¼ˆ20201130å®Œæˆç®€å•çš„CIï¼Œè®°å½•å¯è§<a href="https://aruseito.github.io/2021/02/15/travis-ci-%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/">CI</a>ï¼‰</li></ul>]]></content>
    
    
    <categories>
      
      <category>æ—§åšå®¢æ–‡ç« </category>
      
    </categories>
    
    
    <tags>
      
      <tag>å·¥ç¨‹åŒ–</tag>
      
      <tag>nodejs</tag>
      
      <tag>è„šæ‰‹æ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Šæ·±å…¥æµ…å‡º React å’Œ Reduxã€‹ è¯»ä¹¦ç¬”è®°</title>
    <link href="/article/d130c1af/"/>
    <url>/article/d130c1af/</url>
    
    <content type="html"><![CDATA[<h1 id="ã€Šæ·±å…¥æµ…å‡º-React-å’Œ-Reduxã€‹-è¯»ä¹¦ç¬”è®°"><a href="#ã€Šæ·±å…¥æµ…å‡º-React-å’Œ-Reduxã€‹-è¯»ä¹¦ç¬”è®°" class="headerlink" title="ã€Šæ·±å…¥æµ…å‡º React å’Œ Reduxã€‹ è¯»ä¹¦ç¬”è®°"></a>ã€Šæ·±å…¥æµ…å‡º React å’Œ Reduxã€‹ è¯»ä¹¦ç¬”è®°</h1><p>React ä¸ Redux çš„æ ¸å¿ƒï¼šUI=render(state)</p><h2 id="React"><a href="#React" class="headerlink" title="React"></a>React</h2><h3 id="å…³äº-prop-ä¸-state"><a href="#å…³äº-prop-ä¸-state" class="headerlink" title="å…³äº prop ä¸ state"></a>å…³äº prop ä¸ state</h3><ul><li>prop ç”¨äºå®šä¹‰å¤–éƒ¨æ¥å£ï¼Œstate ç”¨äºè®°å½•å†…éƒ¨çŠ¶æ€ï¼›</li><li>prop çš„èµ‹å€¼åœ¨å¤–éƒ¨ä¸–ç•Œä½¿ç”¨ç»„ä»¶æ—¶ï¼Œstate çš„èµ‹å€¼åœ¨ç»„ä»¶å†…éƒ¨ï¼›</li><li>ç»„ä»¶ä¸åº”è¯¥æ”¹å˜ prop çš„å€¼ï¼Œè€Œ state å­˜åœ¨çš„ç›®çš„å°±æ˜¯è®©ç»„ä»¶æ¥æ”¹å˜çš„ã€‚</li></ul><h3 id="ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ"></a>ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ</h3><p>React ç”Ÿå‘½å‘¨æœŸå¯èƒ½ä¼šç»å†å¦‚ä¸‹ä¸‰ä¸ªé˜¶æ®µï¼š</p><ul><li>è£…è½½è¿‡ç¨‹ï¼ˆMountï¼‰ï¼šæŠŠç»„ä»¶ç¬¬ä¸€æ¬¡åœ¨ DOM æ ‘ä¸­æ¸²æŸ“çš„è¿‡ç¨‹</li><li>æ›´æ–°è¿‡ç¨‹ï¼ˆUpdateï¼‰ï¼šå½“ç»„ä»¶è¢«é‡æ–°æ¸²æŸ“çš„è¿‡ç¨‹</li><li>å¸è½½è¿‡ç¨‹ï¼ˆUnmountï¼‰ï¼šç»„ä»¶ä» DOM ä¸­åˆ é™¤çš„è¿‡ç¨‹</li></ul><h4 id="è£…è½½è¿‡ç¨‹"><a href="#è£…è½½è¿‡ç¨‹" class="headerlink" title="è£…è½½è¿‡ç¨‹"></a>è£…è½½è¿‡ç¨‹</h4><p>è£…åœ¨è¿‡ç¨‹ä¸­ä¼šä¾æ¬¡è°ƒç”¨ä»¥ä¸‹å‡½æ•°ï¼š</p><ul><li>constructor</li><li>getInitialState</li><li>getDefaultProps</li><li>componentWillMount</li><li>render</li><li>componentDidMount</li></ul><h5 id="constructor-NaN"><a href="#constructor-NaN" class="headerlink" title="constructor"></a>constructor</h5><p>åˆ›é€ ä¸€ä¸ªç»„ä»¶ç±»çš„å®ä¾‹ï¼Œä¼šè°ƒç”¨å¯¹åº”çš„æ„é€ å‡½æ•°ã€‚æ— çŠ¶æ€çš„ React ç»„ä»¶ä¸éœ€è¦å®šä¹‰æ„é€ å‡½æ•°ã€‚ç›®çš„ï¼š</p><ul><li>åˆå§‹åŒ– state</li><li>ç»‘å®šæˆå‘˜å‡½æ•°çš„ this ç¯å¢ƒ</li></ul><h5 id="getInitialState-å’Œ-getDefaultProps"><a href="#getInitialState-å’Œ-getDefaultProps" class="headerlink" title="getInitialState å’Œ getDefaultProps"></a>getInitialState å’Œ getDefaultProps</h5><p>getInitialState è¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼ä¼šç”¨æ¥åˆå§‹åŒ–ç»„ä»¶çš„ this.stateã€‚getDefaultProps å‡½æ•°çš„è¿”å›å€¼å¯ä»¥ä½œä¸º props çš„åˆå§‹å€¼ã€‚è¿™ä¸¤ä¸ªå‡½æ•°åªæœ‰ç”¨ React.createClass æ–¹æ³•åˆ›é€ çš„ç»„ä»¶ç±»æ‰ä¼šå‘ç”Ÿä½œç”¨ã€‚getInitialState åªå‡ºç°åœ¨è£…è½½è¿‡ç¨‹ä¸­ï¼Œåœ¨ä¸€ä¸ªç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹ä¸­ï¼Œè¿™ä¸ªå‡½æ•°åªè¢«è°ƒç”¨ä¸€æ¬¡ã€‚ä½¿ç”¨ Es6 çš„è¯ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­é€šè¿‡ç»™ this.state èµ‹å€¼å®ŒæˆçŠ¶æ€çš„åˆå§‹åŒ–ï¼Œé€šè¿‡ç»™ç±»å±æ€§ defaultProps èµ‹å€¼æŒ‡å®š props åˆå§‹å€¼ã€‚</p><h5 id="render"><a href="#render" class="headerlink" title="render"></a>render</h5><p>render å‡½æ•°å¹¶ä¸åšå®é™…çš„æ¸²æŸ“åŠ¨ä½œï¼Œå®ƒåªæ˜¯è¿”å›ä¸€ä¸ª jsx æè¿°çš„ç»“æ„ï¼Œæœ€ç»ˆç”± React æ¥æ“ä½œæ¸²æŸ“è¿‡ç¨‹ã€‚render å‡½æ•°åº”è¯¥æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ã€‚</p><h5 id="componentWillMount-å’Œ-componentDidMount"><a href="#componentWillMount-å’Œ-componentDidMount" class="headerlink" title="componentWillMount å’Œ componentDidMount"></a>componentWillMount å’Œ componentDidMount</h5><p>componentWillMountå‘ç”Ÿåœ¨â€œå°†è¦è£…è½½â€çš„æ—¶å€™ï¼Œè¿™ä¸ªæ—¶å€™æ²¡æœ‰ä»»ä½•æ¸²æŸ“ç»“æœã€‚<br>å½“ render å‡½æ•°è¢«è°ƒç”¨å®Œä¹‹åï¼ŒcomponentDidMount å‡½æ•°å¹¶ä¸ä¼šè¢«ç«‹åˆ»è°ƒç”¨ï¼ŒcomponentDidMount è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œrender å‡½æ•°è¿”å›çš„ä¸œè¥¿å·²ç»å¼•å‘äº†æ¸²æŸ“ï¼Œç»„ä»¶å·²ç»è¢«â€œè£…è½½â€åˆ°äº† DOM æ ‘ä¸Šã€‚<br>componentWillMount å¯ä»¥å†æœåŠ¡å™¨ç«¯è¢«è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨æµè§ˆå™¨ç«¯è¢«è°ƒç”¨ï¼›è€Œ componentDidMount åªèƒ½åœ¨æµè§ˆå™¨ç«¯è¢«è°ƒç”¨ã€‚</p><h4 id="æ›´æ–°è¿‡ç¨‹"><a href="#æ›´æ–°è¿‡ç¨‹" class="headerlink" title="æ›´æ–°è¿‡ç¨‹"></a>æ›´æ–°è¿‡ç¨‹</h4><p>æ›´æ–°è¿‡ç¨‹ä¸­ä¼šä¾æ¬¡è°ƒç”¨ä»¥ä¸‹å‡½æ•°ï¼ˆå¹¶ä¸æ˜¯æ‰€æœ‰æ›´æ–°éƒ½ä¼šæ‰§è¡Œå…¨éƒ¨å‡½æ•°ï¼‰ï¼š</p><ul><li>componentWillReceiveProps</li><li>shouldComponentUpdate</li><li>componentWillUpdate</li><li>render</li><li>componentDidUpdate</li></ul><h5 id="componentWillReceiveProps"><a href="#componentWillReceiveProps" class="headerlink" title="componentWillReceiveProps"></a>componentWillReceiveProps</h5><p>å½“çˆ¶ç»„ä»¶çš„ render å‡½æ•°è¢«è°ƒç”¨å°±ä¼šè°ƒç”¨è¯¥å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°é€‚åˆæ ¹æ®æ–°çš„ props å€¼ï¼ˆä¹Ÿå°±æ˜¯å‚æ•° nextPropsï¼‰æ¥è®¡ç®—å‡ºæ˜¯ä¸æ˜¯è¦æ›´æ–°å†…éƒ¨çŠ¶æ€ stateã€‚</p><h5 id="shouldComponentUpdate"><a href="#shouldComponentUpdate" class="headerlink" title="shouldComponentUpdate"></a>shouldComponentUpdate</h5><p>è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå‘Šè¯‰ reactåº“è¿™ä¸ªç»„ä»¶åœ¨è¿™æ¬¡æ›´æ–°è¿‡ç¨‹ä¸­æ˜¯å¦è¦ç»§ç»­ã€‚å¯ä»¥ä½œä¸ºä¼˜åŒ–ç‚¹ã€‚</p><h5 id="componentWillUpdate-å’Œ-componentDidUpdate"><a href="#componentWillUpdate-å’Œ-componentDidUpdate" class="headerlink" title="componentWillUpdate å’Œ componentDidUpdate"></a>componentWillUpdate å’Œ componentDidUpdate</h5><p>å½“åœ¨æœåŠ¡å™¨ç«¯ä½¿ç”¨ React æ¸²æŸ“æ—¶ï¼ŒcomponentDidUpdate å‡½æ•°ï¼Œå¹¶ä¸æ˜¯åªåœ¨æµè§ˆå™¨ç«¯æ‰æ‰§è¡Œçš„ï¼Œæ— è®ºæ›´æ–°è¿‡ç¨‹å‘ç”Ÿåœ¨æœåŠ¡å™¨ç«¯è¿˜æ˜¯æµè§ˆå™¨ç«¯éƒ½ä¼šè¢«è°ƒç”¨ã€‚ä½¿ç”¨ React åšæœåŠ¡å™¨æ¸²æŸ“æ—¶ï¼ŒåŸºæœ¬ä¸ä¼šç»å†æ›´æ–°è¿‡ç¨‹ï¼Œæ­£å¸¸æƒ…å†µä¸‹æœåŠ¡å™¨ç«¯ä¸ä¼šè°ƒç”¨ componentDidUpdate</p><h4 id="å¸è½½è¿‡ç¨‹"><a href="#å¸è½½è¿‡ç¨‹" class="headerlink" title="å¸è½½è¿‡ç¨‹"></a>å¸è½½è¿‡ç¨‹</h4><h5 id="componentWillUnmount"><a href="#componentWillUnmount" class="headerlink" title="componentWillUnmount"></a>componentWillUnmount</h5><p>componentWillUnmountä¸­çš„å·¥ä½œå¾€å¾€å’Œ componentDidMount æœ‰å…³</p><h2 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h2><p>redux å¼ºè°ƒçš„ä¸‰ä¸ªåŸºæœ¬åŸåˆ™ï¼š</p><ul><li>å”¯ä¸€æ•°æ®æº</li><li>ä¿æŒçŠ¶æ€å¯è¯»</li><li>æ•°æ®æ”¹å˜åªèƒ½é€šè¿‡çº¯å‡½æ•°å®Œæˆ</li></ul><h3 id="ä½¿ç”¨-Redux-è¿‡ç¨‹"><a href="#ä½¿ç”¨-Redux-è¿‡ç¨‹" class="headerlink" title="ä½¿ç”¨ Redux è¿‡ç¨‹"></a>ä½¿ç”¨ Redux è¿‡ç¨‹</h3><ol><li>å®šä¹‰ ActionType å’Œ Action æ„é€ å‡½æ•°ã€‚</li><li>åˆ›å»º reducerï¼Œæ ¹æ® actionTypeåˆ†å‘åŠ¨ä½œï¼Œreducer åªè´Ÿè´£è®¡ç®—çŠ¶æ€ï¼Œä¸è´Ÿè´£å­˜å‚¨çŠ¶æ€</li><li>ç¡®å®š Store çŠ¶æ€ï¼Œåˆ›å»º Store</li><li>åœ¨ view ä¸­ï¼Œä¿æŒ sotre ä¸ŠçŠ¶æ€å’Œ this.state åŒæ­¥ã€‚</li><li>æ´¾å‘ action                </li></ol><h3 id="å®¹å™¨ç»„ä»¶å’Œå‚»ç“œç»„ä»¶"><a href="#å®¹å™¨ç»„ä»¶å’Œå‚»ç“œç»„ä»¶" class="headerlink" title="å®¹å™¨ç»„ä»¶å’Œå‚»ç“œç»„ä»¶"></a>å®¹å™¨ç»„ä»¶å’Œå‚»ç“œç»„ä»¶</h3><p>æ‰¿æ‹…ç¬¬ä¸€ä¸ªä»»åŠ¡çš„ç»„ä»¶ï¼Œè´Ÿè´£å’Œ Redux Store æ‰“äº¤é“çš„ç»„ä»¶ï¼Œå¤„äºå¤–å±‚ï¼Œå«åšå®¹å™¨ç»„ä»¶ã€‚æ‰¿æ‹…ç¬¬äºŒä¸ªä»»åŠ¡çš„ç»„ä»¶ï¼Œä¸“å¿ƒè´Ÿè´£æ¸²æŸ“é¡µé¢çš„ç»„ä»¶ï¼Œå¤„äºå†…å±‚ï¼Œå«åšå±•ç¤ºç»„ä»¶ã€‚</p><p><img src="https://chenxiumiao-1252816278.cos.ap-beijing.myqcloud.com/2019/09/29/rong-qi-zu-jian-he-sha-gua-zu-jian-de-fen-gong.png" alt="å®¹å™¨ç»„ä»¶å’Œå‚»ç“œç»„ä»¶çš„åˆ†å·¥"></p><p>å‚»ç“œç»„ä»¶å°±æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œæ ¹æ® props äº§ç”Ÿç»“æœï¼Œä¸éœ€è¦ state<br>å®¹å™¨ç»„ä»¶ï¼Œæ‰¿æ‹…æ‰€æœ‰å’Œ Store å…³è”çš„å·¥ä½œï¼Œå®ƒçš„ render å‡½æ•°æ˜¯æ¸²æŸ“å‚»ç“œç»„ä»¶ï¼Œè´Ÿè´£ä¼ é€’å¿…è¦çš„ propã€‚</p><h3 id="ç»„ä»¶-Context"><a href="#ç»„ä»¶-Context" class="headerlink" title="ç»„ä»¶ Context"></a>ç»„ä»¶ Context</h3><p>ç›®çš„ï¼šå…¥å£æ–‡ä»¶å¼•å…¥ Storeï¼Œå…¶ä½™ç»„ä»¶é¿å…ç›´æ¥å¯¼å…¥ Store</p><p><img src="https://chenxiumiao-1252816278.cos.ap-beijing.myqcloud.com/2019/09/30/react-de-context.png" alt="React çš„ Context"></p><p>ä½¿ç”¨ï¼šåˆ›å»ºä¸€ä¸ªç‰¹æ®Šçš„ React ç»„ä»¶ï¼Œå®ç°ä¸€ä¸ªå®ä¾‹<code>getChildContext</code>æ–¹æ³•ï¼Œè®©å…¶ä»…è¿”å›<code>store</code>ï¼Œè®© render å‡½æ•°æŠŠå­ç»„ä»¶æ¸²æŸ“å‡ºæ¥ã€‚å†å®šä¹‰ childContextTypesã€‚å­ç»„ä»¶ä¸­ä¹Ÿè¦å®šä¹‰ç›¸åŒçš„ childContextTypesï¼Œå­ç»„ä»¶ä¸­å®šä¹‰çš„æ„é€ å‡½æ•°å‚æ•°è¦åŠ ä¸Š contextï¼Œstore çš„è®¿é—®æ–¹å¼å˜ä¸º<code>this.context.store.xxx</code></p><h3 id="React-Redux"><a href="#React-Redux" class="headerlink" title="React-Redux"></a>React-Redux</h3><p>React-Redux ä¸­çš„ connectï¼šè¿æ¥å®¹å™¨ç»„ä»¶å’Œå‚»ç“œç»„ä»¶ï¼ŒProvider: æä¾›åŒ…å« Store çš„ context</p><h2 id="æ¨¡å—åŒ–-React-å’Œ-Redux-åº”ç”¨"><a href="#æ¨¡å—åŒ–-React-å’Œ-Redux-åº”ç”¨" class="headerlink" title="æ¨¡å—åŒ– React å’Œ Redux åº”ç”¨"></a>æ¨¡å—åŒ– React å’Œ Redux åº”ç”¨</h2><h3 id="ä»£ç æ–‡ä»¶çš„ç»„ç»‡æ–¹å¼"><a href="#ä»£ç æ–‡ä»¶çš„ç»„ç»‡æ–¹å¼" class="headerlink" title="ä»£ç æ–‡ä»¶çš„ç»„ç»‡æ–¹å¼"></a>ä»£ç æ–‡ä»¶çš„ç»„ç»‡æ–¹å¼</h3><p>æ¯ä¸ªåŸºæœ¬åŠŸèƒ½å¯¹åº”ä¸€ä¸ªåŠŸèƒ½æ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—å¯¹åº”ä¸€ä¸ªç›®å½•</p><h3 id="æ¨¡å—æ¥å£"><a href="#æ¨¡å—æ¥å£" class="headerlink" title="æ¨¡å—æ¥å£"></a>æ¨¡å—æ¥å£</h3><p>æ˜ç¡®è¿™ä¸ªæ¨¡å—çš„å¯¹å¤–çš„æ¥å£ï¼Œè¿™ä¸ªæ¥å£åº”å®ç°æŠŠå†…éƒ¨å°è£…èµ·æ¥ã€‚</p><h3 id="çŠ¶æ€æ ‘çš„è®¾è®¡"><a href="#çŠ¶æ€æ ‘çš„è®¾è®¡" class="headerlink" title="çŠ¶æ€æ ‘çš„è®¾è®¡"></a>çŠ¶æ€æ ‘çš„è®¾è®¡</h3><ul><li>ä¸€ä¸ªæ¨¡å—æ§åˆ¶ä¸€ä¸ªçŠ¶æ€èŠ‚ç‚¹ï¼šå¦‚æœ A æ¨¡å—çš„ reducer è´Ÿè´£ä¿®æ”¹çŠ¶æ€æ ‘ä¸Š a å­—æ®µä¸‹çš„æ•°æ®ï¼Œname å¦ä¸€ä¸ªæ¨¡å— B çš„ reducer å°±ä¸èƒ½ä¿®æ”¹ a å­—æ®µä¸‹çš„æ•°æ®ã€‚</li><li>é¿å…å†—ä½™æ•°æ®</li><li>æ ‘å½¢ç»“æ„æ‰å¹³</li></ul><h2 id="React-ç»„ä»¶çš„æ€§èƒ½ä¼˜åŒ–"><a href="#React-ç»„ä»¶çš„æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="React ç»„ä»¶çš„æ€§èƒ½ä¼˜åŒ–"></a>React ç»„ä»¶çš„æ€§èƒ½ä¼˜åŒ–</h2><h3 id="æ€§èƒ½åˆ†æï¼ˆReact-16-ä¸-Chrome-å¼€å‘è€…å·¥å…·ï¼‰"><a href="#æ€§èƒ½åˆ†æï¼ˆReact-16-ä¸-Chrome-å¼€å‘è€…å·¥å…·ï¼‰" class="headerlink" title="æ€§èƒ½åˆ†æï¼ˆReact 16 ä¸ Chrome å¼€å‘è€…å·¥å…·ï¼‰"></a>æ€§èƒ½åˆ†æï¼ˆ<a href="https://calibreapp.com/blog/react-performance-profiling-optimization/">React 16 ä¸ Chrome å¼€å‘è€…å·¥å…·</a>ï¼‰</h3><h3 id="å•ä¸ª-React-ç»„ä»¶çš„æ€§èƒ½ä¼˜åŒ–"><a href="#å•ä¸ª-React-ç»„ä»¶çš„æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="å•ä¸ª React ç»„ä»¶çš„æ€§èƒ½ä¼˜åŒ–"></a>å•ä¸ª React ç»„ä»¶çš„æ€§èƒ½ä¼˜åŒ–</h3><h4 id="React-Redux-çš„-shouldComponentUpdate-å®ç°"><a href="#React-Redux-çš„-shouldComponentUpdate-å®ç°" class="headerlink" title="React-Redux çš„ shouldComponentUpdate å®ç°"></a>React-Redux çš„ shouldComponentUpdate å®ç°</h4><p>React ç»„ä»¶ç±»çš„çˆ¶ç±» Component æä¾›äº† shouldComponentUpdate çš„é»˜è®¤å®ç°æ–¹å¼ï¼Œåªç®€å•è¿”å› trueã€‚å½“éœ€è¦è¾¾åˆ°æ›´é«˜æ€§èƒ½æ—¶éœ€è¦è‡ªå®šä¹‰ shouldComponentUpdateã€‚</p><p>react-redux ç”¨çš„æ˜¯å°½é‡ç®€å•çš„æ–¹æ³•ï¼Œåšçš„æ˜¯â€œæµ…å±‚æ¯”è¾ƒâ€ï¼ˆå’Œ js ä¸­çš„===ç±»ä¼¼ï¼‰ï¼Œå¦‚æœ prop çš„ç±»å‹æ˜¯å­—ç¬¦ä¸²æˆ–è€…æ•°å­—ï¼Œåªè¦å€¼ç›¸åŒï¼Œé‚£ä¹ˆâ€œæµ…å±‚æ¯”è¾ƒâ€çš„æ–¹æ³•ä¼šè®¤ä¸ºäºŒè€…ç›¸åŒï¼Œå¦‚æœ prop çš„ç±»å‹æ˜¯å¤æ‚å¯¹è±¡ï¼Œé‚£ä¹ˆâ€œæµ…å±‚æ¯”è¾ƒâ€çš„æ–¹å¼åªçœ‹è¿™ä¸¤ä¸ª prop æ˜¯ä¸æ˜¯åŒä¸€å¯¹è±¡çš„å¼•ç”¨ã€‚</p><h3 id="å¤šä¸ª-React-ç»„ä»¶çš„æ€§èƒ½ä¼˜åŒ–"><a href="#å¤šä¸ª-React-ç»„ä»¶çš„æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="å¤šä¸ª React ç»„ä»¶çš„æ€§èƒ½ä¼˜åŒ–"></a>å¤šä¸ª React ç»„ä»¶çš„æ€§èƒ½ä¼˜åŒ–</h3><h4 id="React-çš„è°ƒå’Œè¿‡ç¨‹"><a href="#React-çš„è°ƒå’Œè¿‡ç¨‹" class="headerlink" title="React çš„è°ƒå’Œè¿‡ç¨‹"></a>React çš„è°ƒå’Œè¿‡ç¨‹</h4><p>å½“ React è¦å¯¹æ¯”ä¸¤ä¸ª Virtual DOM çš„æ ‘å½¢ç»“æ„çš„æ—¶å€™ï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹é€’å½’å¾€ä¸‹æ¯”å¯¹ï¼Œåœ¨æ ‘å½¢ç»“æ„ä¸Šï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥çœ‹ä½œä¸€ä¸ªè¿™ä¸ªèŠ‚ç‚¹ä»¥ä¸‹éƒ¨åˆ†å­æ ‘çš„æ ¹èŠ‚ç‚¹ã€‚æ‰€ä»¥å…¶å®è¿™ä¸ªå¯¹æ¯”ç®—æ³•å¯ä»¥ä» Virtual DOm ä¸Šä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹å¼€å§‹ã€‚</p><p>React é¦–å…ˆæ£€æŸ¥ä¸¤ä¸ªæ ‘å½¢çš„æ ¹èŠ‚ç‚¹çš„ç±»å‹æ˜¯å¦ç›¸åŒï¼Œæ ¹æ®ç›¸åŒæˆ–è€…ä¸åŒæœ‰ä¸åŒå¤„ç†æ–¹å¼ã€‚</p><h5 id="èŠ‚ç‚¹ç±»å‹ä¸åŒçš„æƒ…å†µ"><a href="#èŠ‚ç‚¹ç±»å‹ä¸åŒçš„æƒ…å†µ" class="headerlink" title="èŠ‚ç‚¹ç±»å‹ä¸åŒçš„æƒ…å†µ"></a><strong>èŠ‚ç‚¹ç±»å‹ä¸åŒçš„æƒ…å†µ</strong></h5><p>å¦‚æœæ ‘å½¢ç»“æ„æ ¹èŠ‚ç‚¹ç±»å‹ä¸ç›¸åŒï¼Œç›´æ¥è®¤ä¸ºåŸæ¥é‚£ä¸ªæ ‘å½¢ç»“æ„å·²ç»æ²¡ç”¨ï¼Œå¯ä»¥æ‰”æ‰ï¼Œéœ€è¦é‡æ–°æ„å»ºæ–°çš„ DOM æ ‘ï¼ŒåŸæœ‰çš„æ ‘å½¢ä¸Šçš„ React ç»„ä»¶ä¼šç»å†â€œå¸è½½â€çš„ç”Ÿå‘½å‘¨æœŸã€‚è¿™æ—¶å€™componentWillUnmount æ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼Œå–è€Œä»£ä¹‹çš„ç»„ä»¶åˆ™ä¼šç»å†è£…è½½è¿‡ç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼Œç»„ä»¶çš„ componentWillMountã€render å’Œ componentDidMount æ–¹æ³•ä¾æ¬¡è¢«è°ƒç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äº Virtual DOM æ ‘è¿™æ˜¯ä¸€ä¸ªâ€œæ›´æ–°â€è¿‡ç¨‹ï¼Œä½†æ˜¯å´å¯èƒ½å¼•å‘è¿™ä¸ªæ ‘ç»“æ„ä¸ŠæŸäº›ç»„ä»¶çš„â€œè£…è½½â€å’Œâ€œå¸è½½â€è¿‡ç¨‹ã€‚</p><p>ä½œä¸ºå¼€å‘è€…ï¼Œä¸€å®šè¦é¿å…ä½œä¸ºåŒ…è£¹åŠŸèƒ½çš„èŠ‚ç‚¹ç±»å‹è¢«éšæ„æ”¹å˜ã€‚</p><p>å¦‚æœ React å¯¹æ¯”ä¸¤ä¸ªæ ‘å½¢ç»“æ„çš„æ ¹èŠ‚ç‚¹å‘ç°ç±»å‹ç›¸åŒï¼Œé‚£ä¹ˆå°±è§‰å¾—å¯ä»¥é‡ç”¨åŸæ¥çš„èŠ‚ç‚¹ï¼Œè¿›å…¥æ›´æ–°é˜¶æ®µï¼ŒæŒ‰ç…§ä¸‹ä¸€æ­¥éª¤æ¥å¤„ç†ã€‚</p><h5 id="èŠ‚ç‚¹ç±»å‹ç›¸åŒçš„æƒ…å†µ"><a href="#èŠ‚ç‚¹ç±»å‹ç›¸åŒçš„æƒ…å†µ" class="headerlink" title="èŠ‚ç‚¹ç±»å‹ç›¸åŒçš„æƒ…å†µ"></a><strong>èŠ‚ç‚¹ç±»å‹ç›¸åŒçš„æƒ…å†µ</strong></h5><p>ä¸¤ä¸ªæ ‘å½¢ç»“æ„çš„æ ¹èŠ‚ç‚¹ç±»å‹ç›¸åŒï¼ŒReact å°±è®¤ä¸ºåŸæ¥çš„æ ¹èŠ‚ç‚¹åªéœ€è¦æ›´æ–°è¿‡ç¨‹ï¼Œä¸ä¼šå°†å…¶å¸è½½ï¼Œä¹Ÿä¸ä¼šå¼•å‘æ ¹èŠ‚ç‚¹çš„é‡æ–°è£…è½½ã€‚</p><p>å¯¹äº DOM ç±»å‹å…ƒç´ ï¼ŒReact ä¼šä¿ç•™èŠ‚ç‚¹å¯¹åº”çš„ DOM å…ƒç´ ï¼Œåªå¯¹æ ‘å½¢ç»“æ„æ ¹èŠ‚ç‚¹ä¸Šçš„æ ‘å½¢å’Œå†…å®¹åšä¸€ä¸‹æ¯”å¯¹ï¼Œç„¶ååªæ›´æ–°ä¿®æ”¹çš„éƒ¨åˆ†ã€‚</p><p>å¯¹äº React ç»„ä»¶ç±»å‹ï¼ŒReactèƒ½åšçš„åªæ˜¯æ ¹æ®æ–°èŠ‚ç‚¹çš„ props å»æ›´æ–°åŸæ¥æ ¹èŠ‚ç‚¹çš„ç»„ä»¶å®ä¾‹ï¼Œå¼•å‘è¿™ä¸ªç»„ä»¶å®ä¾‹çš„æ›´æ–°è¿‡ç¨‹ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœ shouldComponentUpdate å‡½æ•°è¿”å› falseï¼Œæ›´æ–°è¿‡ç¨‹å°±æ­¤æ‰“ä½ï¼Œä¸å†ç»§ç»­ã€‚</p><p>åœ¨å¤„ç†å®Œæ ¹èŠ‚ç‚¹çš„å¯¹æ¯”åï¼ŒReact çš„ç®—æ³•ä¼šå¯¹æ ¹èŠ‚ç‚¹çš„æ¯ä¸ªå­èŠ‚ç‚¹é‡å¤ä¸€æ ·çš„åŠ¨ä½œï¼Œè¿™æ—¶å€™æ¯ä¸ªå­èŠ‚ç‚¹å°±æˆä¸ºå®ƒæ‰€è¦†ç›–éƒ¨åˆ†çš„æ ¹èŠ‚ç‚¹ï¼Œå¤„ç†æ–¹å¼å’Œå®ƒçš„çˆ¶èŠ‚ç‚¹å®Œå…¨ä¸€æ ·ã€‚</p><h5 id="å¤šä¸ªå­ç»„ä»¶çš„æƒ…å†µ"><a href="#å¤šä¸ªå­ç»„ä»¶çš„æƒ…å†µ" class="headerlink" title="å¤šä¸ªå­ç»„ä»¶çš„æƒ…å†µ"></a><strong>å¤šä¸ªå­ç»„ä»¶çš„æƒ…å†µ</strong></h5><p>åœ¨åºåˆ—åå¢åŠ ä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼ŒReact ä¼šå‘ç°å¤šå‡ºäº†ä¸€ä¸ªç»„ä»¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç»„ä»¶å®ä¾‹ï¼Œè¿™ä¸ªç»„ä»¶å®ä¾‹éœ€è¦ç»å†è£…è½½è¿‡ç¨‹ï¼Œå¯¹äºä¹‹å‰çš„å®ä¾‹ï¼ŒReact ä¼šå¼•å‘ä»–ä»¬çš„æ›´æ–°è¿‡ç¨‹ï¼Œåªè¦shouldComponentUpdate å‡½æ•°å®ç°æ°å½“ï¼Œæ£€æŸ¥ props ä¹‹åå°±è¿”å› false çš„è¯ï¼Œå¯ä»¥é¿å…å®è´¨çš„æ›´æ–°æ“ä½œã€‚</p><p>åœ¨åºåˆ—å‰å¢åŠ ä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼ŒReact ä¼šæŒ¨ä¸ªæ¯”è¾ƒï¼Œè®¤ä¸ºæ–°å¢çš„ç»„ä»¶æ˜¯ä¹‹å‰ç¬¬ä¸€ä¸ªç»„ä»¶å±æ€§çš„å˜æ›´ï¼Œå¹¶å¢åŠ äº†æœ€åä¸€ä¸ªç»„ä»¶ã€‚</p><p>ä½¿ç”¨ key å¯ä»¥å…‹æœè¿™ç§æµªè´¹</p><h4 id="key"><a href="#key" class="headerlink" title="key"></a>key</h4><p>key åœ¨ä»£ç ä¸­å¯ä»¥æ˜ç¡®çš„å‘Šè¯‰ react æ¯ä¸ªç»„ä»¶çš„å”¯ä¸€æ ‡è¯†ã€‚</p><p>å½“é‡åˆ°åœ¨åºåˆ—å‰æ·»åŠ ä¸€ä¸ªæ–°çš„ç»„ä»¶æ—¶ï¼ŒReact æ ¹æ® key å€¼ï¼Œå¯ä»¥çŸ¥é“ä¹‹å‰çš„ç»„ä»¶ï¼Œæ‰€ä»¥ React ä¼šæŠŠæ–°åˆ›å»ºçš„ç»„ä»¶æ’åœ¨å‰é¢ï¼Œå¯¹äºåŸæœ‰ç»„ä»¶å®ä¾‹åªç”¨åŸæœ‰çš„ props æ¥å¯åŠ¨æ›´æ–°è¿‡ç¨‹ã€‚</p><h3 id="ç”¨-reselect-æé«˜æ•°æ®è·å–æ€§èƒ½"><a href="#ç”¨-reselect-æé«˜æ•°æ®è·å–æ€§èƒ½" class="headerlink" title="ç”¨ reselect æé«˜æ•°æ®è·å–æ€§èƒ½"></a>ç”¨ reselect æé«˜æ•°æ®è·å–æ€§èƒ½</h3><h4 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h4><p>åªè¦ç›¸å…³çŠ¶æ€æ²¡æœ‰æ”¹å˜ï¼Œé‚£å°±ç›´æ¥ä½¿ç”¨ä¸Šä¸€æ¬¡çš„ç¼“å­˜ç»“æœã€‚</p><h4 id="è®¡ç®—è¿‡ç¨‹"><a href="#è®¡ç®—è¿‡ç¨‹" class="headerlink" title="è®¡ç®—è¿‡ç¨‹"></a>è®¡ç®—è¿‡ç¨‹</h4><ol><li>ä»è¾“å…¥å‚æ•° state æŠ½å–ç¬¬ä¸€å±‚ç»“æœï¼Œå°†è¿™ç¬¬ä¸€å±‚ç»“æœå’Œä¹‹å‰æŠ½å–çš„ç¬¬ä¸€å±‚ç»“æœåšæ¯”è¾ƒï¼Œå¦‚æœå‘ç°å®Œå…¨ç›¸åŒï¼Œå°±æ²¡æœ‰å¿…è¦è¿›è¡Œç¬¬äºŒéƒ¨åˆ†è¿ç®—äº†ï¼Œé€‰æ‹©å™¨ç›´æ¥æŠŠä¹‹å‰ç¬¬äºŒéƒ¨åˆ†çš„è¿ç®—ç»“æœè¿”å›å°±å¯ä»¥äº†ã€‚è¿™é‡Œçš„æ¯”è¾ƒå°±æ˜¯ js ä¸­çš„<code>===</code>æ“ä½œç¬¦æ¯”è¾ƒï¼Œå¦‚æœç¬¬ä¸€å±‚ç»“æœæ˜¯å¯¹è±¡çš„è¯ï¼Œåªæœ‰æ˜¯åŒä¸€å¯¹è±¡æ‰ä¼šè¢«è®¤ä¸ºæ˜¯ç›¸åŒã€‚</li><li>æ ¹æ®ç¬¬ä¸€å±‚ç»“æœè®¡ç®—å‡ºé€‰æ‹©å™¨éœ€è¦è¿”å›çš„æœ€ç»ˆç»“æœ</li></ol><h4 id="åŸåˆ™"><a href="#åŸåˆ™" class="headerlink" title="åŸåˆ™"></a>åŸåˆ™</h4><p>æ­¥éª¤ä¸€è¿ç®—å› ä¸ºæ¯æ¬¡é€‰æ‹©å™¨éƒ½è¦ä½¿ç”¨ï¼Œæ‰€ä»¥ä¸€å®šè¦å¿«ï¼Œè¿ç®—è¦éå¸¸ç®€å•ï¼Œæœ€å¥½æ˜¯ä¸€ä¸ªæ˜ å°„è¿ç®—ï¼Œé€šå¸¸å°±åªæ˜¯ä» state å‚æ•°ä¸­å¾—åˆ°æŸä¸ªå­—æ®µçš„å¼•ç”¨å°±è¶³å¤Ÿï¼ŒæŠŠå‰©ä¸‹æ¥çš„é‡æ´»ç´¯æ´»éƒ½äº¤ç»™æ­¥éª¤äºŒå»åšã€‚ </p><h2 id="React-é«˜çº§ç»„ä»¶ï¼ˆå¤§æ¦‚ç•¥è¯»äº†ä¸€ä¸‹ï¼Œä»¥åå†ç»†çœ‹ï¼Œå¾…æ›´æ–°ï¼‰"><a href="#React-é«˜çº§ç»„ä»¶ï¼ˆå¤§æ¦‚ç•¥è¯»äº†ä¸€ä¸‹ï¼Œä»¥åå†ç»†çœ‹ï¼Œå¾…æ›´æ–°ï¼‰" class="headerlink" title="React é«˜çº§ç»„ä»¶ï¼ˆå¤§æ¦‚ç•¥è¯»äº†ä¸€ä¸‹ï¼Œä»¥åå†ç»†çœ‹ï¼Œå¾…æ›´æ–°ï¼‰"></a>React é«˜çº§ç»„ä»¶ï¼ˆå¤§æ¦‚ç•¥è¯»äº†ä¸€ä¸‹ï¼Œä»¥åå†ç»†çœ‹ï¼Œå¾…æ›´æ–°ï¼‰</h2><h2 id="Redux-å’Œ-æœåŠ¡å™¨é€šä¿¡"><a href="#Redux-å’Œ-æœåŠ¡å™¨é€šä¿¡" class="headerlink" title="Redux å’Œ æœåŠ¡å™¨é€šä¿¡"></a>Redux å’Œ æœåŠ¡å™¨é€šä¿¡</h2><h3 id="React-ç»„ä»¶è®¿é—®æœåŠ¡å™¨"><a href="#React-ç»„ä»¶è®¿é—®æœåŠ¡å™¨" class="headerlink" title="React ç»„ä»¶è®¿é—®æœåŠ¡å™¨"></a>React ç»„ä»¶è®¿é—®æœåŠ¡å™¨</h3><p>é€šå¸¸åœ¨ç»„ä»¶çš„ ComponentDidMount å‡½æ•°ä¸­åšè¯·æ±‚æœåŠ¡å™¨çš„äº‹æƒ…ï¼Œå› ä¸ºå½“è¯¥å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œè£…è½½è¿‡ç¨‹å·²å®Œæˆï¼Œç»„ä»¶éœ€è¦æ¸²æŸ“çš„å†…å®¹å·²ç»å‡ºç°åœ¨ DOM æ ‘ä¸Šã€‚</p><h4 id="fetch"><a href="#fetch" class="headerlink" title="fetch"></a>fetch</h4><p><img src="https://chenxiumiao-1252816278.cos.ap-beijing.myqcloud.com/2019/10/12/15708622641712.jpg" alt="-w615"></p><p>fetch å‡½æ•°è¿”å›çš„ç»“æœæ˜¯ä¸€ä¸ª Promise å¯¹è±¡ã€‚fetch è®¤ä¸ºåªè¦æœåŠ¡å™¨è¿”å›ä¸€ä¸ªåˆæ³•çš„ HTTP å“åº”å°±ç®—æˆåŠŸï¼Œå°±ä¼šè°ƒç”¨ then æä¾›çš„å›è°ƒå‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ å½“ HTTP å“åº”çš„çŠ¶æ€ç ä¸º 400 æˆ–è€… 500 çš„æ—¶å€™ä¹Ÿä¼šè°ƒç”¨ thenã€‚</p><h3 id="Redux-è®¿é—®æœåŠ¡å™¨"><a href="#Redux-è®¿é—®æœåŠ¡å™¨" class="headerlink" title="Redux è®¿é—®æœåŠ¡å™¨"></a>Redux è®¿é—®æœåŠ¡å™¨</h3><h4 id="redux-thunk-ä¸­é—´ä»¶"><a href="#redux-thunk-ä¸­é—´ä»¶" class="headerlink" title="redux-thunk ä¸­é—´ä»¶"></a>redux-thunk ä¸­é—´ä»¶</h4><p>Redux-thunk çš„æ€è·¯ï¼šåœ¨ Redux çš„å•å‘æ•°æ®æµä¸­ï¼Œåœ¨ action å¯¹è±¡è¢« reducer å‡½æ•°å¤„ç†ä¹‹å‰ï¼Œæ˜¯æ’å…¥å¼‚æ­¥åŠŸèƒ½çš„æ—¶æœºã€‚</p><p>åœ¨ Redux æ¶æ„ä¸‹ï¼Œä¸€ä¸ª action å¯¹è±¡åœ¨é€šè¿‡ store.dispatch æ´¾å‘ï¼Œåœ¨è°ƒç”¨ reducer å‡½æ•°ä¹‹å‰ï¼Œä¼šå…ˆç»è¿‡ä¸€ä¸ªä¸­é—´ä»¶çš„ç¯èŠ‚ï¼Œè¿™å°±æ˜¯äº§ç”Ÿå¼‚æ­¥æ“ä½œçš„æœºä¼šï¼Œå®é™…ä¸Š redux-thunk æä¾›çš„å°±æ˜¯ä¸€ä¸ª Redux ä¸­é—´ä»¶ï¼Œéœ€è¦åœ¨åˆ›å»º Store æ—¶ç”¨ä¸Šè¿™ä¸ªä¸­é—´ä»¶ã€‚</p><p><img src="https://chenxiumiao-1252816278.cos.ap-beijing.myqcloud.com/2019/10/12/redux-de-action-chu-li-liu-cheng.png" alt="Redux çš„ action å¤„ç†æµç¨‹"></p><h3 id="å¼‚æ­¥-action-å¯¹è±¡"><a href="#å¼‚æ­¥-action-å¯¹è±¡" class="headerlink" title="å¼‚æ­¥ action å¯¹è±¡"></a>å¼‚æ­¥ action å¯¹è±¡</h3><p>redux-thunk çš„å·¥ä½œæ˜¯æ£€æŸ¥ action å¯¹è±¡æ˜¯å¦ä¸ºå‡½æ•°ï¼Œå¦‚æœä¸æ˜¯å‡½æ•°å°±æ”¾è¡Œï¼Œå®Œæˆæ™®é€š action å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¦‚æœå‘ç° action å¯¹è±¡æ˜¯å‡½æ•°ï¼Œé‚£å°±æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œå¹¶æŠŠ Store çš„ dispatch çš„å‡½æ•°å’Œ getState å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’åˆ°å‡½æ•°ä¸­å»ï¼Œå¤„ç†è¿‡ç¨‹åˆ°æ­¤ä¸ºæ­¢ï¼Œä¼šè®©è¿™ä¸ªå¼‚æ­¥ action å¯¹è±¡ç»§ç»­å¾€å‰æ´¾å‘åˆ° reducer å‡½æ•°ã€‚</p><p>å¼‚æ­¥ action æ„é€ å‡½æ•°çš„ä»£ç åŸºæœ¬ä¸Šéƒ½æ˜¯å¦‚ä¸‹å¥—è·¯ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JavaScript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> sampleAsyncAction = <span class="hljs-function">()=&gt;</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">dispatch,getState</span>)=&gt;</span>&#123;<br>        <span class="hljs-comment">//åœ¨è¿™ä¸ªå‡½æ•°é‡Œå¯ä»¥è°ƒç”¨ä¸€æ­¥å‡½æ•°ï¼Œ</span><br>        <span class="hljs-comment">//è‡ªè¡Œå†³å®šåœ¨åˆé€‚çš„å®é™…é€šè¿‡ dispatch å‚æ•°</span><br>        <span class="hljs-comment">//æ´¾å‘å‡ºæ–°çš„ action å¯¹è±¡</span><br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ—§åšå®¢æ–‡ç« </category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‰ç«¯</tag>
      
      <tag>React</tag>
      
      <tag>Redux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TSå­¦ä¹ è®°å½•</title>
    <link href="/article/aa58022d/"/>
    <url>/article/aa58022d/</url>
    
    <content type="html"><![CDATA[<h1 id="TS-å¸¸ç”¨ç‚¹æ•´ç†"><a href="#TS-å¸¸ç”¨ç‚¹æ•´ç†" class="headerlink" title="TS å¸¸ç”¨ç‚¹æ•´ç†"></a>TS å¸¸ç”¨ç‚¹æ•´ç†</h1><p>[scode type=â€greenâ€]å…·ä½“å®è·µå¯ä»¥çœ‹<br>githubï¼š<a href="https://github.com/chenxiumiao/component-with-ts">component-with-ts</a><br>æœ¬æ¥æƒ³è¯¦ç»†ä»‹ç»ç»„ä»¶çš„å¼€å‘è¿‡ç¨‹çš„ï¼Œä½†æ˜¯å¥ˆä½•è¯­è¨€ç»„ç»‡èƒ½åŠ›æ¯”è¾ƒå·®ï¼Œè„‘å­çŸ¥é“å¦‚ä½•å»åšï¼Œä½†æ˜¯ä¸çŸ¥é“è½¬æ¢æˆæ–‡å­—æ€ä¹ˆæè¿°ï¼Œæ‰€ä»¥å°±å…ˆæš‚æ—¶éšè—äº†å®ç°è¿‡ç¨‹<br>[/scode]</p><h2 id="åŸå§‹æ•°æ®ç±»å‹"><a href="#åŸå§‹æ•°æ®ç±»å‹" class="headerlink" title="åŸå§‹æ•°æ®ç±»å‹"></a>åŸå§‹æ•°æ®ç±»å‹</h2><ol><li>boolean <code>let isOkï¼šboolean = false</code></li><li>number <code>let age: number = 20</code></li><li>string <code>let message: string = &#39;isOk&#39;</code></li><li>undefined <code>let u: undefined = undefined</code></li><li>null <code>let n : null = null</code></li></ol><h2 id="any-ç±»å‹å’Œ-è”åˆç±»å‹"><a href="#any-ç±»å‹å’Œ-è”åˆç±»å‹" class="headerlink" title="any ç±»å‹å’Œ è”åˆç±»å‹"></a>any ç±»å‹å’Œ è”åˆç±»å‹</h2><ol><li>any ç±»å‹ <code>let notSure:any = 4</code> <code>notSure = &#39;maybe&#39;</code></li><li>è”åˆç±»å‹ <code>let numberOrString: number|string = 234</code> <code>numberOrString = &#39;abc&#39;</code></li></ol><h2 id="Array-å’Œå…ƒç¥–"><a href="#Array-å’Œå…ƒç¥–" class="headerlink" title="Array å’Œå…ƒç¥–"></a>Array å’Œå…ƒç¥–</h2><ol><li>Array <code>let arrOfNumbers: number[] = [1,2,3,4]</code></li><li>å…ƒç¥– <code>let user:[string, number] = [&#39;isOk&#39;,&#39;234&#39;]</code></li></ol><p>å…ƒç¥–å®é™…ä¸Šå°±æ˜¯è§„å®šäº†ä¸åŒç±»å‹çš„å·²çŸ¥é•¿åº¦æ•°ç»„<br>typescript</p><h2 id="interface-æ¥å£"><a href="#interface-æ¥å£" class="headerlink" title="interface æ¥å£"></a>interface æ¥å£</h2><p>æ¥å£çš„ä¸»è¦åŠŸèƒ½ï¼š</p><ol><li>å¯¹å¯¹è±¡çš„å½¢çŠ¶è¿›è¡Œæè¿°</li><li>å¯¹ç±»è¿›è¡ŒæŠ½è±¡</li><li>Duck Typingï¼ˆå¯¹è±¡çš„ä¸€ç§æ¨æ–­ç­–ç•¥ï¼‰</li></ol><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">interface</span> IPerson &#123;<br>    <span class="hljs-keyword">readonly</span> id: <span class="hljs-built_in">number</span>; <span class="hljs-comment">//åªè¯»å±æ€§</span><br>    name: <span class="hljs-built_in">string</span>;<br>    age?: <span class="hljs-built_in">number</span>; <span class="hljs-comment">// ?ä»£è¡¨å¯é€‰å±æ€§</span><br>&#125;<br><br><span class="hljs-keyword">let</span> chenxiumiao: IPreson = &#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-number">1</span><br>    <span class="hljs-attr">name</span> : <span class="hljs-string">&#x27;chenxiumiao&#x27;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">23</span><br>&#125;<br><br><br></code></pre></div></td></tr></table></figure><p>readonly ä¸ const åŒºåˆ«ï¼šreadonly æ˜¯ç”¨åœ¨å±æ€§ä¸Šçš„ï¼Œconst æ˜¯ç”¨åœ¨å˜é‡ä¸Šçš„ã€‚</p><h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><p>æè¿°å‡½æ•°æ—¶æè¿°çš„ä¸ºå‚æ•°ä¸è¿”å›å€¼</p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-comment">//å‡½æ•°å£°æ˜</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">x: <span class="hljs-built_in">number</span>, y: <span class="hljs-built_in">number</span>, z?: <span class="hljs-built_in">number</span></span>): <span class="hljs-title">number</span> </span>&#123;<br>  <span class="hljs-comment">//å¯é€‰å‚æ•°è¦æ”¾åœ¨æœ€å</span><br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> z === <span class="hljs-string">&quot;number&quot;</span>) &#123;<br>    <span class="hljs-keyword">return</span> x + y + z;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">return</span> x + y;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//å‡½æ•°è¡¨è¾¾å¼</span><br><br><span class="hljs-keyword">const</span> add = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">x: <span class="hljs-built_in">number</span>, y: <span class="hljs-built_in">number</span>, z: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span></span>): <span class="hljs-title">number</span> </span>&#123;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> z === <span class="hljs-string">&quot;number&quot;</span>) &#123;<br>    <span class="hljs-keyword">return</span> x + y + z;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">return</span> x + y;<br>  &#125;<br>&#125;;<br><br><span class="hljs-keyword">const</span> add2: <span class="hljs-function">(<span class="hljs-params">x: <span class="hljs-built_in">number</span>, y: <span class="hljs-built_in">number</span>, z?: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">number</span> = add; <span class="hljs-comment">//=&gt;ä¸æ˜¯ç®­å¤´å‡½æ•°ï¼Œè€Œæ˜¯å‡½æ•°è¡¨è¾¾å¼è¿”å›å€¼çš„è¡¨è¾¾æ–¹å¼ã€‚</span><br></code></pre></div></td></tr></table></figure><h2 id="ç±»"><a href="#ç±»" class="headerlink" title="ç±»"></a>ç±»</h2><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span> </span>&#123;<br>  <span class="hljs-keyword">public</span> name: <span class="hljs-built_in">string</span>;<br>  <span class="hljs-keyword">static</span> categoies: <span class="hljs-built_in">string</span>[] = [<span class="hljs-string">&quot;mammal&quot;</span>, <span class="hljs-string">&quot;bird&quot;</span>]; <span class="hljs-comment">//é™æ€å±æ€§ï¼Œä¸å®ä¾‹å…³ç³»ä¸å¤§</span><br>  <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-title">isAnimal</span>(<span class="hljs-params">a</span>)</span> &#123;<br>    <span class="hljs-keyword">return</span> a <span class="hljs-keyword">instanceof</span> Animal;<br>  &#125;<br>  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>)</span> &#123;<br>    <span class="hljs-built_in">this</span>.name = name;<br>  &#125;<br>  <span class="hljs-function"><span class="hljs-title">run</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">$&#123;<span class="hljs-built_in">this</span>.name&#125;</span> is running`</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> snake = <span class="hljs-keyword">new</span> Animal(<span class="hljs-string">&quot;lily&quot;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-title">bark</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">$&#123;<span class="hljs-built_in">this</span>.name&#125;</span> is barking`</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> xiaobao = <span class="hljs-keyword">new</span> Dog(<span class="hljs-string">&quot;xiaobao&quot;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cat</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">name</span>)</span> &#123;<br>    <span class="hljs-built_in">super</span>(name);<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.name);<br>  &#125;<br>  <span class="hljs-function"><span class="hljs-title">run</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Meow,&quot;</span> + <span class="hljs-built_in">super</span>.run();<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> maomao = <span class="hljs-keyword">new</span> Cat(<span class="hljs-string">&quot;maomao&quot;</span>);<br></code></pre></div></td></tr></table></figure><table><thead><tr><th></th><th>è‡ªèº«æƒé™</th><th>å­ç±»æƒé™</th></tr></thead><tbody><tr><td>public</td><td>å¯ä»¥</td><td>å¯ä»¥</td></tr><tr><td>private</td><td>å¯ä»¥</td><td>ä¸å¯ä»¥</td></tr><tr><td>protected</td><td>å¯ä»¥</td><td>å¯ä»¥</td></tr><tr><td>readonly</td><td>åªè¯»</td><td>åªè¯»</td></tr></tbody></table><h2 id="interface-æ¥å£ä¸ç±»"><a href="#interface-æ¥å£ä¸ç±»" class="headerlink" title="interface æ¥å£ä¸ç±»"></a>interface æ¥å£ä¸ç±»</h2><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-comment">//æ‰¾ä¸å‡ºCar ä¸ Cellphoneå…±æ€§ï¼Œæ‰€ä»¥æå–ä¸º interface</span><br><span class="hljs-keyword">interface</span> Radio &#123;<br>  switchRadio(triggerL: <span class="hljs-built_in">boolean</span>): <span class="hljs-built_in">void</span>;<br>&#125;<br><br><span class="hljs-keyword">interface</span> Battery &#123;<br>  checkBatteryStatus();<br>&#125;<br><br><span class="hljs-keyword">interface</span> RadioWithBattery <span class="hljs-keyword">extends</span> Radio &#123;<br>  checkBatteryStatus();<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Car</span> <span class="hljs-title">implements</span> <span class="hljs-title">Radio</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-title">switchRadio</span>(<span class="hljs-params"></span>)</span> &#123;&#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cellphone</span> <span class="hljs-title">implements</span> /*<span class="hljs-title">Radio</span>,<span class="hljs-title">Battery</span>*/ <span class="hljs-title">RadioWithBattery</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-title">switchRadio</span>(<span class="hljs-params"></span>)</span> &#123;&#125;<br>  <span class="hljs-function"><span class="hljs-title">checkBatteryStatus</span>(<span class="hljs-params"></span>)</span> &#123;&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="æšä¸¾-enums"><a href="#æšä¸¾-enums" class="headerlink" title="æšä¸¾ enums"></a>æšä¸¾ enums</h2><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-comment">//ä½¿ç”¨ const å¯ä»¥æå‡æ€§èƒ½ï¼Œå…·ä½“çœ‹ ts ç¼–è¯‘åçš„ js æ–‡ä»¶å¯¹æ¯”</span><br><span class="hljs-keyword">const</span> <span class="hljs-built_in">enum</span> Direction &#123;<br>  Up, <span class="hljs-comment">//è¿›è¡Œæ•°å­—èµ‹å€¼åï¼Œåç»­ä¼šæŒ‰ç…§è‡ªå¢æ–¹å¼è¿›è¡Œèµ‹å€¼ã€‚å­—ç¬¦ä¸²èµ‹å€¼æ—¶å¿…é¡»å°†æ¯é¡¹éƒ½èµ‹å€¼</span><br>  Down,<br>  Left,<br>  Right,<br>&#125;<br><span class="hljs-built_in">console</span>.log(Direction.Up);<br><span class="hljs-built_in">console</span>.log(Direction[<span class="hljs-number">0</span>]);<br></code></pre></div></td></tr></table></figure><h2 id="æ³›å‹-Generics"><a href="#æ³›å‹-Generics" class="headerlink" title="æ³›å‹ Generics"></a>æ³›å‹ Generics</h2><p>æ³›å‹ï¼šå®šä¹‰å‡½æ•°æ¥å£æˆ–ç±»æ—¶ï¼Œä¸é¢„å…ˆæŒ‡å®šå…·ä½“ç±»å‹ï¼Œåœ¨ä½¿ç”¨æ—¶æŒ‡å®šç±»å‹ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">echo</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params">arg: T</span>): <span class="hljs-title">T</span> </span>&#123;<br>  <span class="hljs-comment">//&lt;&gt;æ˜¯æ³›å‹åç§°ï¼Œç›¸å½“äºåˆ›å»ºäº†ä¸€ä¸ªå ä½ç¬¦</span><br>  <span class="hljs-keyword">return</span> arg;<br>&#125;<br><span class="hljs-keyword">const</span> str: <span class="hljs-built_in">string</span> = <span class="hljs-string">&quot;str&quot;</span>;<br><br><span class="hljs-keyword">const</span> result = echo(str);<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">swap</span>&lt;<span class="hljs-title">T</span>, <span class="hljs-title">U</span>&gt;(<span class="hljs-params">tuple: [T, U]</span>): [<span class="hljs-title">U</span>, <span class="hljs-title">T</span>] </span>&#123;<br>  <span class="hljs-keyword">return</span> [tuple[<span class="hljs-number">1</span>], tuple[<span class="hljs-number">0</span>]];<br>&#125;<br><br><span class="hljs-keyword">const</span> result = swap([<span class="hljs-string">&quot;str&quot;</span>, <span class="hljs-number">1234</span>]);<br></code></pre></div></td></tr></table></figure><p>çº¦æŸæ³›å‹</p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-comment">//å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">echoWitchArr</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params">arg: T[]</span>): <span class="hljs-title">T</span>[] </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(arg.length);<br>  <span class="hljs-keyword">return</span> arg;<br>&#125;<br><br><span class="hljs-keyword">const</span> arrs = echoWitch([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]);<br><br><span class="hljs-keyword">interface</span> IWitchLength &#123;<br>  <span class="hljs-attr">length</span>: <span class="hljs-built_in">number</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">echoWitchLength</span>&lt;<span class="hljs-title">T</span> <span class="hljs-title">extends</span> <span class="hljs-title">IWithLength</span>&gt;(<span class="hljs-params">arg: T</span>): <span class="hljs-title">T</span> </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(arg.length);<br>  <span class="hljs-keyword">return</span> arg;<br>&#125;<br><span class="hljs-keyword">const</span> str = echoWithLength(<span class="hljs-string">&quot;str&quot;</span>);<br><span class="hljs-keyword">const</span> obj = echoWithLength(&#123; <span class="hljs-attr">length</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">12</span> &#125;); <span class="hljs-comment">//åªè¦åŒ…å« length å±æ€§å°±å¯ä»¥</span><br><span class="hljs-keyword">const</span> arr2 = echoWithLength([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]);<br></code></pre></div></td></tr></table></figure><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-comment">//ç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Queuq</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>  <span class="hljs-keyword">private</span> data = [];<br><br>  <span class="hljs-function"><span class="hljs-title">push</span>(<span class="hljs-params">item: T</span>)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.data.push(item);<br>  &#125;<br><br>  pop(): T &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.data.shift();<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> queue = <span class="hljs-keyword">new</span> Queue&lt;<span class="hljs-built_in">number</span>&gt;();<br></code></pre></div></td></tr></table></figure><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-comment">//interface</span><br><span class="hljs-keyword">interface</span> KeyPair&lt;T, U&gt; &#123;<br>  <span class="hljs-attr">key</span>: T;<br>  value: U;<br>&#125;<br><span class="hljs-keyword">let</span> kp1: KeyPair&lt;<span class="hljs-built_in">number</span>, <span class="hljs-built_in">string</span>&gt; = &#123; <span class="hljs-attr">key</span>: <span class="hljs-number">111</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&quot;str&quot;</span> &#125;;<br><br><span class="hljs-keyword">let</span> arr: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];<br><span class="hljs-keyword">let</span> arrTwo: <span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">number</span>&gt; = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];<br><br><span class="hljs-keyword">interface</span> IPlus&lt;T&gt; &#123;<br>  (a: T, <span class="hljs-attr">b</span>: T): T;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">plus</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-title">number</span> </span>&#123;<br>  <span class="hljs-keyword">return</span> a + b;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">connect</span>(<span class="hljs-params">a: <span class="hljs-built_in">string</span>, b: <span class="hljs-built_in">string</span></span>): <span class="hljs-title">string</span> </span>&#123;<br>  <span class="hljs-keyword">return</span> a + b;<br>&#125;<br><span class="hljs-keyword">const</span> a: IPlus&lt;<span class="hljs-built_in">number</span>&gt; = plus;<br><span class="hljs-keyword">const</span> b: IPlus&lt;<span class="hljs-built_in">string</span>&gt; = connect;<br></code></pre></div></td></tr></table></figure><h2 id="ç±»å‹"><a href="#ç±»å‹" class="headerlink" title="ç±»å‹"></a>ç±»å‹</h2><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-comment">//type aliases</span><br><span class="hljs-keyword">type</span> PlusType = <span class="hljs-function">(<span class="hljs-params">x: <span class="hljs-built_in">number</span>, y: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">number</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sum</span>(<span class="hljs-params">x: <span class="hljs-built_in">number</span>, y: <span class="hljs-built_in">number</span></span>): <span class="hljs-title">number</span> </span>&#123;<br>  <span class="hljs-keyword">return</span> x + y;<br>&#125;<br><br><span class="hljs-keyword">const</span> sum2: PlusType = sum;<br><br><span class="hljs-keyword">type</span> NameResolver = <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">string</span>;<br><span class="hljs-keyword">type</span> NameOrResolver = <span class="hljs-built_in">string</span> | NameResolver;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getName</span>(<span class="hljs-params">n: NameOrResolver</span>): <span class="hljs-title">string</span> </span>&#123;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> n === <span class="hljs-string">&quot;string&quot;</span>) &#123;<br>    <span class="hljs-keyword">return</span> n;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">return</span> n();<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//type assertion ç±»å‹æ–­è¨€</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getLength</span>(<span class="hljs-params">input: <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span></span>): <span class="hljs-title">number</span> </span>&#123;<br>  <span class="hljs-comment">// const str = input as String</span><br>  <span class="hljs-comment">// if(str.length)&#123;</span><br>  <span class="hljs-comment">//     return str.length</span><br>  <span class="hljs-comment">// &#125;else&#123;</span><br>  <span class="hljs-comment">//    const number = input as Number</span><br>  <span class="hljs-comment">// &#125;</span><br>  <span class="hljs-comment">// return number.toString().length</span><br><br>  <span class="hljs-keyword">if</span> ((&lt;<span class="hljs-built_in">string</span>&gt;input).length) &#123;<br>    <span class="hljs-keyword">return</span> (&lt;<span class="hljs-built_in">string</span>&gt;input).length;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">return</span> input.toString().length;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="å£°æ˜æ–‡ä»¶"><a href="#å£°æ˜æ–‡ä»¶" class="headerlink" title="å£°æ˜æ–‡ä»¶"></a>å£°æ˜æ–‡ä»¶</h2><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-comment">//å£°æ˜æ–‡ä»¶ä»¥.d.ts ä¸ºåç¼€</span><br><span class="hljs-keyword">declare</span> <span class="hljs-keyword">var</span> jQuery: <span class="hljs-function">(<span class="hljs-params">selector: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">any</span>;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ—§åšå®¢æ–‡ç« </category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‰ç«¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ·±ä¿¡æœå‰ç«¯é¢è¯•-æ ¡æ‹›-2019</title>
    <link href="/article/61660c91/"/>
    <url>/article/61660c91/</url>
    
    <content type="html"><![CDATA[<h2 id="GET-å’Œ-POST-çš„åŒºåˆ«"><a href="#GET-å’Œ-POST-çš„åŒºåˆ«" class="headerlink" title="GET å’Œ POST çš„åŒºåˆ«"></a>GET å’Œ POST çš„åŒºåˆ«</h2><ul><li>GET å’Œ POST æœ¬è´¨æ²¡æœ‰åŒºåˆ«ã€‚GET å’Œ POST æ˜¯ HTTP åè®®ä¸­çš„ä¸¤ç§å‘é€è¯·æ±‚çš„æ–¹æ³•ã€‚HTTP æ˜¯åŸºäº TCP/IP çš„å…³äºæ•°æ®å¦‚ä½•åœ¨ä¸‡ç»´ç½‘ä¸­å¦‚ä½•é€šä¿¡çš„åè®®ã€‚HTTP çš„åº•å±‚æ˜¯ TCP/IPã€‚æ‰€ä»¥ GET å’Œ POST çš„åº•å±‚ä¹Ÿæ˜¯ TCP/IPï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒGET/POST éƒ½æ˜¯ TCP é“¾æ¥ã€‚GET å’Œ POST èƒ½åšçš„äº‹æƒ…æ˜¯ä¸€æ ·ä¸€æ ·çš„ã€‚ä¹Ÿå¯ä»¥ç»™ GET åŠ ä¸Š request bodyï¼Œç»™ POST å¸¦ä¸Š url å‚æ•°</li><li>GET é•¿åº¦å—æµè§ˆå™¨é•¿åº¦é™åˆ¶ã€‚POST æ²¡æœ‰</li><li>GET è¯·æ±‚åªèƒ½è¿›è¡Œ url ç¼–ç  ASCII å­—ç¬¦ï¼Œè€Œ POST æ”¯æŒå¤šç§ç¼–ç æ–¹å¼ã€‚</li><li>GET å‚æ•°é€šè¿‡ URL ä¼ é€’ï¼ŒPOST æ”¾åœ¨ Request body ä¸­ã€‚</li><li>GET äº§ç”Ÿä¸€ä¸ª TCP æ•°æ®åŒ…ï¼›POST äº§ç”Ÿä¸¤ä¸ª TCP æ•°æ®åŒ…ã€‚ï¼ˆå¯¹äº GET æ–¹å¼çš„è¯·æ±‚ï¼Œæµè§ˆå™¨ä¼šæŠŠ http header å’Œ data ä¸€å¹¶å‘é€å‡ºå»ï¼ŒæœåŠ¡å™¨å“åº” 200ï¼ˆè¿”å›æ•°æ®ï¼‰ï¼›è€Œå¯¹äº POSTï¼Œæµè§ˆå™¨å…ˆå‘é€ headerï¼ŒæœåŠ¡å™¨å“åº” 100 continueï¼Œæµè§ˆå™¨å†å‘é€ dataï¼ŒæœåŠ¡å™¨å“åº” 200 okï¼ˆè¿”å›æ•°æ®ï¼‰ã€‚ï¼‰</li></ul><h2 id="ä»è¾“å…¥-url-åˆ°æ˜¾ç¤ºç»å†äº†ä»€ä¹ˆï¼Ÿ"><a href="#ä»è¾“å…¥-url-åˆ°æ˜¾ç¤ºç»å†äº†ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ä»è¾“å…¥ url åˆ°æ˜¾ç¤ºç»å†äº†ä»€ä¹ˆï¼Ÿ"></a>ä»è¾“å…¥ url åˆ°æ˜¾ç¤ºç»å†äº†ä»€ä¹ˆï¼Ÿ</h2><ol><li><p>æµè§ˆå™¨æœ‰äº”å¤§çº¿ç¨‹ï¼šå®šæ—¶å™¨çº¿ç¨‹ï¼Œäº‹ä»¶çº¿ç¨‹ï¼Œç½‘ç»œçº¿ç¨‹ï¼Œæ¸²æŸ“çº¿ç¨‹ï¼Œjs çº¿ç¨‹</p></li><li><p>å½“è¾“å…¥ url åï¼Œæµè§ˆå™¨ä¼šå¼€è¾Ÿä¸€æ¡ç½‘ç»œçº¿ç¨‹ï¼Œç»å† DNS æŸ¥è¯¢ï¼Œä¸‰æ¬¡æ¡æ‰‹ï¼Œå››æ¬¡æŒ¥æ‰‹ã€‚</p><ul><li>DNS æŸ¥è¯¢ï¼šå…ˆæ£€æŸ¥æµè§ˆå™¨æœ¬èº«æœ‰æ²¡æœ‰ç¼“å­˜ï¼Œå¦‚æœæ²¡æœ‰åˆ™æŸ¥æ‰¾æœ¬åœ°ï¼Œå¦‚æœæœ¬åœ°ä¹Ÿæ²¡ç”¨æŸ¥æ‰¾ hostï¼Œå¦‚æœä¹Ÿæ²¡ç”¨å°±å»æ‰¾æ ¹æœåŠ¡å™¨</li><li>ä¸‰æ¬¡æ¡æ‰‹</li><li>å››æ¬¡æŒ¥æ‰‹</li></ul></li><li><p>åç«¯æ¥æ”¶åˆ°è¯·æ±‚åï¼Œç»è¿‡ä¸€ç³»åˆ—ç»Ÿä¸€æ€§éªŒè¯åï¼Œæ‰§è¡Œåç«¯ä»£ç ï¼Œç„¶å HTTP å“åº”åŒ…å‘é€ç»™å‰ç«¯ï¼Œå®Œæˆäº¤äº’</p></li><li><p>å‰ç«¯æ¥å—åˆ°æŠ¥æ–‡åå…ˆè§£æ HTMLï¼Œæ„å»º DOM æ ‘</p></li><li><p>è§£æ CSSï¼Œæ„å»º CSSOM æ ‘</p></li><li><p>åˆå¹¶ DOM æ ‘å’Œ CSSOM æ ‘ï¼Œæ„å»º render æ ‘</p></li><li><p>å¸ƒå±€ render æ ‘</p></li><li><p>ç»˜åˆ¶ render æ ‘</p></li><li><p>æµè§ˆå™¨ä¼šå°†å„å±‚çš„ä¿¡æ¯å‘é€ç»™ GPU,GPU å°†å„å±‚åˆæˆæ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚</p></li><li><p>é‡åˆ° script æ ‡ç­¾æ—¶ï¼Œä¼šæ‰§è¡Œå¹¶é˜»å¡æ¸²æŸ“:å› ä¸ºæµè§ˆå™¨æ¸²æŸ“å’Œ js æ‰§è¡Œå…¬ç”¨ä¸€ä¸ªçº¿ç¨‹,è€Œä¸”è¿™é‡Œå¿…é¡»æ˜¯å•çº¿ç¨‹æ“ä½œ,å¤šçº¿ç¨‹ä¼šäº§ç”Ÿæ¸²æŸ“ DOM å†²çª.ç­‰ script æ ‡ç­¾å®Œæˆå,æµè§ˆå™¨ä¼šç»§ç»­æ¸²æŸ“.è¿™ä¹Ÿå¯ä»¥è§£é‡Šä¸ºä»€ä¹ˆ js æ”¾åœ¨ html åº•éƒ¨,JS æ”¾åœ¨åº•éƒ¨å¯ä»¥ä¿è¯è®©æµè§ˆå™¨ä¼˜å…ˆæ¸²æŸ“å®Œç°æœ‰çš„ HTML å†…å®¹ï¼Œè®©ç”¨æˆ·å…ˆçœ‹åˆ°å†…å®¹ï¼Œä½“éªŒå¥½ã€‚å¦å¤–ï¼ŒJS æ‰§è¡Œå¦‚æœæ¶‰åŠ DOM æ“ä½œï¼Œå¾—ç­‰å¾… DOM è§£æå®Œæˆæ‰è¡Œï¼ŒJS æ”¾åœ¨åº•éƒ¨æ‰§è¡Œæ—¶ï¼ŒHTML è‚¯å®šéƒ½è§£ææˆäº† DOM ç»“æ„ã€‚JS å¦‚æœæ”¾åœ¨ HTML é¡¶éƒ¨ï¼ŒJS æ‰§è¡Œçš„æ—¶å€™ HTML è¿˜æ²¡æ¥å¾—åŠè½¬æ¢ä¸º DOM ç»“æ„ï¼Œå¯èƒ½ä¼šæŠ¥é”™ã€‚</p></li></ol><h2 id="è·¨åŸŸ"><a href="#è·¨åŸŸ" class="headerlink" title="è·¨åŸŸ"></a>è·¨åŸŸ</h2><p>è·¨åŸŸæ˜¯æµè§ˆå™¨ä¸èƒ½æ‰§è¡Œå…¶ä»–ç½‘ç«™çš„è„šæœ¬ã€‚å®ƒæ˜¯ç”±æµè§ˆå™¨çš„åŒæºç­–ç•¥é€ æˆçš„ï¼Œæ˜¯æµè§ˆå™¨æ–½åŠ çš„å®‰å…¨é™åˆ¶.åŒæºæ˜¯æŒ‡åŸŸååè®®ç«¯å£å‡ç›¸åŒ.åŒæºç­–ç•¥ä¸»è¦ç”¨æ¥é˜²æ­¢ CSRF æ”»å‡»<br>è§£å†³æ–¹æ¡ˆ:</p><ol><li>JSONP:JSONP = json + padding å¡«å……å¼ json åˆ©ç”¨çš„æ˜¯åŠ¨æ€åˆ›å»º script æ ‡ç­¾ï¼Œå‘æœåŠ¡å™¨è¯·æ±‚ json æ•°æ®ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼ŒæœåŠ¡å™¨å°†ä¼ å›æ¥çš„æ•°æ®æ”¾åœ¨æŒ‡å®šåå­—çš„å›è°ƒå‡½æ•°ä¸­ä¼ å›æ¥ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°è·¨åŸŸè®¿é—®ã€‚ç®€å•å®ç”¨ï¼Œè€æ—§æµè§ˆå™¨éƒ½é€‚ç”¨</li><li>é…ç½® nginx ä»£ç†</li><li>CORS:æœåŠ¡ç«¯è®¾ç½® Access-Control-Allow-Origin å°±å¯ä»¥å¼€å¯ CORSã€‚ è¯¥å±æ€§è¡¨ç¤ºå“ªäº›åŸŸåå¯ä»¥è®¿é—®èµ„æºï¼Œå¦‚æœè®¾ç½®é€šé…ç¬¦åˆ™è¡¨ç¤ºæ‰€æœ‰ç½‘ç«™éƒ½å¯ä»¥è®¿é—®èµ„æºã€‚</li></ol><h3 id="BFC"><a href="#BFC" class="headerlink" title="BFC"></a>BFC</h3><p>BFCï¼ˆBlock Formatting Contextï¼‰ç›´è¯‘ä¸ºâ€œå—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡â€ï¼Œæ˜¯ç”¨äºå¸ƒå±€å—çº§ç›’å­çš„ä¸€å—æ¸²æŸ“åŒºåŸŸã€‚å®ƒè§„å®šäº†å†…éƒ¨çš„å—çº§å¦‚ä½•å¸ƒå±€ï¼Œå¹¶ä¸”ä¸è¿™ä¸ªåŒºåŸŸå¤–éƒ¨æ¯«ä¸ç›¸å¹²ã€‚ç®€å•çš„æ¦‚æ‹¬ä¸ºï¼šæ‰€è°“çš„ BFC å°±æ˜¯ CSS å¸ƒå±€çš„ä¸€ä¸ªæ¦‚å¿µï¼Œæ˜¯ä¸€å—åŒºåŸŸï¼Œä¸€ä¸ªç¯å¢ƒã€‚<br>é€šä¿—çš„æ¥è®² BFC å°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ªç‹¬ç«‹é»‘ç›’å­ï¼Œè¿™ä¸ªé»‘ç›’å­ä¸å¤–éƒ¨æ²¡æœ‰å…³ç³»ï¼Œå†…å¤–ä¸èƒ½äº’ç›¸å½±å“ã€‚</p><blockquote><p>åˆ›å»ºä¸€ä¸ª BFC æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼</p></blockquote><ul><li>æ ¹å…ƒç´ </li><li>overflow å€¼é visible</li><li>ä½¿ç”¨ç»å¯¹å®šä½å’Œå›ºå®šå®šä½ absoluteï¼Œfixed</li><li>ä½¿ç”¨ float</li><li>display ä¸º inline-blockï¼Œtable-cellï¼Œflexï¼Œinline-flex</li><li><strong>ç°åœ¨å¯ä»¥ä½¿ç”¨ display çš„ flow-root å±æ€§æ¥åˆ›å»º BFC</strong></li></ul><blockquote><p>BFC å¸ƒå±€çš„è§„åˆ™</p></blockquote><ul><li>åˆ›å»º BFC å…ƒç´ çš„å†…éƒ¨çš„ box ä¼šå‚ç›´æ’åˆ—</li><li>è®¡ç®— BFC é«˜åº¦çš„æ—¶å€™ï¼Œæµ®åŠ¨å…ƒç´ ä¹Ÿä¼šç®—åœ¨å†…</li><li>BFC å†…éƒ¨ç›¸é‚»çš„ box çš„å‚ç›´å¤–è¾¹è·ä¼šåˆå¹¶</li><li>BFC å°±æ˜¯é¡µé¢ä¸Šä¸€ä¸ªç‹¬ç«‹çš„å®¹å™¨ï¼Œå†…éƒ¨æ˜¯ä¸ä¼šå½±å“å¤–éƒ¨çš„å…ƒç´ ï¼Œåä¹‹äº¦ç„¶</li></ul><blockquote><p>BFC çš„ä½¿ç”¨</p></blockquote><ul><li>é¦–å…ˆå®ƒå¯ä»¥ç”¨åœ¨é¿å…å¤–è¾¹è·åˆå¹¶ä¸Šï¼Œåº”ä¸º BFC æ˜¯ç‹¬ç«‹çš„å®¹å™¨ï¼Œæ‰€ä»¥å¯ä»¥ç»™æŸä¸ªå…ƒç´ å¤–é¢åŒ…è£¹ä¸€ä¸ª BFCï¼Œè¿™æ ·å°±å¯ä»¥é¿å…å¤–è¾¹è·åˆå¹¶</li><li>æ¸…é™¤æµ®åŠ¨ï¼Œå› ä¸ºä½¿ç”¨ overflow çš„ hiddenï¼Œauto æ—¶ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ª BFCï¼Œè€Œ BFC è®¡ç®—æœ¬èº«å®¹å™¨é«˜åº¦çš„æ—¶å€™æ˜¯å°†æµ®åŠ¨å…ƒç´ ä¹Ÿæ˜¯è®¡ç®—åœ¨å†…çš„ï¼Œæ‰€ä»¥ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥é¿å…æµ®åŠ¨å¼•èµ·çš„é«˜åº¦å¡Œé™·ï¼Œä»è€Œæ¸…é™¤æµ®åŠ¨</li><li>é¿å…æ–‡å­—ç¯ç»•ã€‚å¯ä»¥ä¸ºå…ƒç´ æ˜¾ç¤ºçš„åˆ©ç”¨ overflow å°†å…¶å˜ä¸º bfcï¼Œè¿™æ ·å°±å˜ä¸ºä¸€ä¸ªç‹¬ç«‹çš„å®¹å™¨ï¼Œè¿™æ ·å°±ä¸ä¼šå‡ºç°æ–‡å­—ç¯ç»•</li></ul><h3 id="æ¸…é™¤æµ®åŠ¨"><a href="#æ¸…é™¤æµ®åŠ¨" class="headerlink" title="æ¸…é™¤æµ®åŠ¨"></a>æ¸…é™¤æµ®åŠ¨</h3><h4 id="ç¬¬ä¸€ç§-çˆ¶å…ƒç´ æŒ‡å®šå›ºå®šé«˜åº¦"><a href="#ç¬¬ä¸€ç§-çˆ¶å…ƒç´ æŒ‡å®šå›ºå®šé«˜åº¦" class="headerlink" title="ç¬¬ä¸€ç§ çˆ¶å…ƒç´ æŒ‡å®šå›ºå®šé«˜åº¦"></a>ç¬¬ä¸€ç§ çˆ¶å…ƒç´ æŒ‡å®šå›ºå®šé«˜åº¦</h4><blockquote><p>é«˜åº¦å·²çŸ¥ï¼Œæ‰‹åŠ¨æ’‘å¼€æµ®åŠ¨å…ƒç´ çš„åŒ…å«æ¡†</p></blockquote><h4 id="ç¬¬äºŒç§-ç»“å°¾å¢åŠ ç©ºçš„-divï¼Œç„¶åå¯¹å…¶ä½¿ç”¨-clearï¼šboth"><a href="#ç¬¬äºŒç§-ç»“å°¾å¢åŠ ç©ºçš„-divï¼Œç„¶åå¯¹å…¶ä½¿ç”¨-clearï¼šboth" class="headerlink" title="ç¬¬äºŒç§ ç»“å°¾å¢åŠ ç©ºçš„ divï¼Œç„¶åå¯¹å…¶ä½¿ç”¨ clearï¼šboth"></a>ç¬¬äºŒç§ ç»“å°¾å¢åŠ ç©ºçš„ divï¼Œç„¶åå¯¹å…¶ä½¿ç”¨ clearï¼šboth</h4><blockquote><p>è®©çˆ¶çº§ div è‡ªåŠ¨è·å–é«˜åº¦</p></blockquote><h4 id="ç¬¬ä¸‰ç§-çˆ¶çº§-div-ä½¿ç”¨ä¼ªç±»-afterï¼Œzoomï¼ˆIEï¼‰"><a href="#ç¬¬ä¸‰ç§-çˆ¶çº§-div-ä½¿ç”¨ä¼ªç±»-afterï¼Œzoomï¼ˆIEï¼‰" class="headerlink" title="ç¬¬ä¸‰ç§ çˆ¶çº§ div ä½¿ç”¨ä¼ªç±» afterï¼Œzoomï¼ˆIEï¼‰"></a>ç¬¬ä¸‰ç§ çˆ¶çº§ div ä½¿ç”¨ä¼ªç±» afterï¼Œzoomï¼ˆIEï¼‰</h4><blockquote><p>ä½¿ç”¨ clearï¼šboth<br>å’Œç¬¬äºŒç§æ•ˆæœä¸€æ ·ï¼Œä½†æ˜¯ IE8 ä»¥ä¸‹ä¸æ”¯æŒ after ä¼ªç±»ï¼Œä»£æ›¿ä»–çš„æ˜¯ï¼Œzoom=1</p></blockquote><h4 id="ç¬¬å››ç§-çˆ¶çº§ä½¿ç”¨-overflowï¼šhidden"><a href="#ç¬¬å››ç§-çˆ¶çº§ä½¿ç”¨-overflowï¼šhidden" class="headerlink" title="ç¬¬å››ç§ çˆ¶çº§ä½¿ç”¨ overflowï¼šhidden"></a>ç¬¬å››ç§ çˆ¶çº§ä½¿ç”¨ overflowï¼šhidden</h4><blockquote><p>åŸç†æ˜¯è¶…å‡ºå…ƒç´ åŒºåŸŸå°†è¿›è¡Œè£å‰ªï¼Œè™½ç„¶æµ®åŠ¨å…ƒç´ è„±ç¦»æ–‡æ¡£æµï¼Œä½†æ˜¯ä»–å’Œæ™®é€šæµç»„æˆäº†ä¸€ä¸ªç«‹ä½“æµï¼Œæ‰€ä»¥ä½¿ç”¨ overflow æ—¶ï¼Œè¦ç¡®å®šå†…å®¹åŒºåŸŸé«˜åº¦ï¼Œå°±ä¼šå°†æµ®åŠ¨å…ƒç´ ä¹Ÿç®—è¿›æ¥</p></blockquote><h4 id="ç¬¬äº”ç§-çˆ¶çº§å®šä¹‰-overflowï¼šauto"><a href="#ç¬¬äº”ç§-çˆ¶çº§å®šä¹‰-overflowï¼šauto" class="headerlink" title="ç¬¬äº”ç§ çˆ¶çº§å®šä¹‰ overflowï¼šauto"></a>ç¬¬äº”ç§ çˆ¶çº§å®šä¹‰ overflowï¼šauto</h4><blockquote><p>åŸç†å’Œä½¿ç”¨ hidden ä¸€æ ·ï¼Œä½†æ˜¯è¿™ä¸ªä¼šå‡ºç°æ»šåŠ¨æ¡</p></blockquote><h4 id="ç¬¬å…­ç§-çˆ¶çº§-div-è·Ÿç€ä¸€èµ·æµ®åŠ¨"><a href="#ç¬¬å…­ç§-çˆ¶çº§-div-è·Ÿç€ä¸€èµ·æµ®åŠ¨" class="headerlink" title="ç¬¬å…­ç§ çˆ¶çº§ div è·Ÿç€ä¸€èµ·æµ®åŠ¨"></a>ç¬¬å…­ç§ çˆ¶çº§ div è·Ÿç€ä¸€èµ·æµ®åŠ¨</h4><blockquote><p>è¿™æ ·æµ®åŠ¨å…ƒç´ å°±è‡ªæˆä¸€æ´¾ï¼Œç§°ä¸ºä¸€ä¸ªæ•´ä½“</p></blockquote><h4 id="ç¬¬ä¸ƒç§-å°†çˆ¶çº§å…ƒç´ -display-ä¸º-tableï¼Œå˜æˆè¡¨æ ¼"><a href="#ç¬¬ä¸ƒç§-å°†çˆ¶çº§å…ƒç´ -display-ä¸º-tableï¼Œå˜æˆè¡¨æ ¼" class="headerlink" title="ç¬¬ä¸ƒç§ å°†çˆ¶çº§å…ƒç´  display ä¸º tableï¼Œå˜æˆè¡¨æ ¼"></a>ç¬¬ä¸ƒç§ å°†çˆ¶çº§å…ƒç´  display ä¸º tableï¼Œå˜æˆè¡¨æ ¼</h4><h4 id="ç¬¬å…«ç§-ç»“å°¾ä½¿ç”¨-brã€‚è®©å…¶-clearï¼šboth"><a href="#ç¬¬å…«ç§-ç»“å°¾ä½¿ç”¨-brã€‚è®©å…¶-clearï¼šboth" class="headerlink" title="ç¬¬å…«ç§ ç»“å°¾ä½¿ç”¨ brã€‚è®©å…¶ clearï¼šboth"></a>ç¬¬å…«ç§ ç»“å°¾ä½¿ç”¨ brã€‚è®©å…¶ clearï¼šboth</h4>]]></content>
    
    
    <categories>
      
      <category>æ—§åšå®¢æ–‡ç« </category>
      
    </categories>
    
    
    <tags>
      
      <tag>é¢ç»</tag>
      
      <tag>å‰ç«¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è…¾è®¯å‰ç«¯é¢è¯•-æ ¡æ‹›-2019</title>
    <link href="/article/6dcc487f/"/>
    <url>/article/6dcc487f/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘åœ¨å‡†å¤‡ç¬”è¯•é¢è¯•ï¼Œæ‰€ä»¥åˆæç½®äº†åšæ–‡æ›´æ–°è®¡åˆ’ã€‚å¼ºè¿«è‡ªå·±æ›´æ–°æ–‡ç« ï¼Œæ‰€ä»¥æ¥ä¸€ä¸ªè…¾è®¯çš„é¢ç»ã€‚å°†ä¹‹å‰ç¿»è½¦çš„ç­”æ¡ˆéƒ½æ›´æ­£ä¸ºæ­£ç¡®ç­”æ¡ˆã€‚</p><h2 id="ä¸€é¢"><a href="#ä¸€é¢" class="headerlink" title="ä¸€é¢"></a>ä¸€é¢</h2><p>ä¸€é¢çš„æœºä¼šçº¯å±å¶ç„¶è·å¾—ï¼Œå’Œç¬”è¯•ç›¸éš”äº†å¾ˆä¹…ï¼Œæ—©å·²ç»å¿˜è®°äº†è…¾è®¯çš„äº‹ï¼Œéƒ½å·²ç»æ„‰å¿«çš„æ”¾é£è‡ªæˆ‘äº†ï¼Œå„ç§åƒå–ç©ä¹ï¼Œçªç„¶ä¹‹é—´å°±æ”¶åˆ°äº†è…¾è®¯çš„ä¸€é¢ï¼Œä¸€å¤©éƒ½å¾ˆäº¢å¥‹ã€‚</p><h3 id="è¾“å…¥-url-åˆ°æ˜¾ç¤ºçš„è¿‡ç¨‹"><a href="#è¾“å…¥-url-åˆ°æ˜¾ç¤ºçš„è¿‡ç¨‹" class="headerlink" title="è¾“å…¥ url åˆ°æ˜¾ç¤ºçš„è¿‡ç¨‹"></a>è¾“å…¥ url åˆ°æ˜¾ç¤ºçš„è¿‡ç¨‹</h3><blockquote><ol><li>é¦–å…ˆæµè§ˆå™¨æœ‰äº”å¤§çº¿ç¨‹:æ¸²æŸ“çº¿ç¨‹ï¼ŒJS çº¿ç¨‹ï¼Œäº‹ä»¶çº¿ç¨‹ï¼Œç½‘ç»œçº¿ç¨‹ï¼Œå®šæ—¶å™¨çº¿ç¨‹</li><li>è¾“å…¥ URl åä¼šè¿›è¡Œè§£æ.ç„¶åå¼€è¾Ÿä¸€ä¸ªç½‘ç»œçº¿ç¨‹,è¯·æ±‚èµ„æºã€‚ä»åº”ç”¨å±‚å‘é€çš„ http è¯·æ±‚,åˆ°ä¼ è¾“å±‚é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹ tcp/ip é“¾æ¥,å†åˆ°ç½‘ç»œå±‚çš„ ip å¯»å€,ç„¶åå†åˆ°æ•°æ®é“¾è·¯å±‚çš„å°è£…æˆå¸§,æœ€ååˆ°ç‰©ç†å±‚çš„åˆ©ç”¨ç‰©ç†ä»‹è´¨ä¼ è¾“ã€‚</li></ol><ul><li>DNS æŸ¥è¯¢ï¼šå¦‚æœæµè§ˆå™¨æœ‰ç¼“å­˜,åˆ™ç›´æ¥ä½¿ç”¨æµè§ˆå™¨ç¼“å­˜å¦åˆ™ä½¿ç”¨æœ¬æœºç¼“å­˜,å†æ²¡æœ‰å°±æ˜¯ç”¨ host.å¦‚æœæ²¡æœ‰ç¼“å­˜å°±å‘ dns åŸŸåæœåŠ¡å™¨æŸ¥è¯¢,æŸ¥è¯¢åˆ°å¯¹åº” ip</li><li>ä¸‰æ¬¡æ¡æ‰‹ seq-&gt;ack seq ack</li><li>å››æ¬¡æŒ¥æ‰‹</li></ul><ol start="3"><li>ä»æœåŠ¡å™¨æ¥å—åˆ°çš„è¯·æ±‚åˆ°å¯¹åº”åå°æ”¶åˆ°è¯·æ±‚,åå°è¿›è¡Œå¤„ç†.ä¸€èˆ¬æœ‰çš„åå°æœ‰ç»Ÿä¸€æ€§éªŒè¯,å®‰å…¨æ‹¦æˆª,è·¨åŸŸéªŒè¯ä¹‹ç±»çš„.å¦‚æœè¿™ä¸€æ­¥ä¸ç¬¦åˆè§„åˆ™,å°±ç›´æ¥è¿”å›äº†ç›¸åº”çš„ http æŠ¥æ–‡,å¦‚æœé€šè¿‡,æ‰ä¼šè¿›è¡Œå®é™…çš„åå°ä»£ç ,æ­¤æ—¶æ˜¯ç¨‹åºæ¥æ”¶åˆ°è¯·æ±‚,ç„¶åæ‰§è¡Œ.ç­‰ç¨‹åºæ‰§è¡Œå®Œæ¯•å,å°±ä¼šè¿”å›ä¸€ä¸ª http å“åº”åŒ….ç„¶åå°†è¿™ä¸ªåŒ…ä»åç«¯å‘é€åˆ°å‰ç«¯,å®Œæˆäº¤äº’ã€‚å‰ç«¯åç«¯äº¤äº’æ—¶ http æŠ¥æ–‡ä½œä¸ºä¿¡æ¯çš„è½½ä½“.</li><li>ç„¶åå¼€å§‹å‰ç«¯æ¸²æŸ“</li><li>æµè§ˆå™¨è§£æ html,æ„å»º dom æ ‘ è¿‡ç¨‹:å­—èŠ‚æ•°æ® å­—ç¬¦ä¸² tokens nodes dom</li><li>è§£æ css ç”Ÿæˆ css è§„åˆ™æ ‘ è¿‡ç¨‹:å­—èŠ‚æ•°æ® å­—ç¬¦ä¸² tokens nodes cssom åœ¨è¿™è¿‡ç¨‹ä¸­æµè§ˆå™¨ä¼šç¡®å®šä¸‹æ¯ä¸€ä¸ªèŠ‚ç‚¹çš„æ ·å¼.</li><li>åˆå¹¶ dom æ ‘å’Œ css è§„åˆ™,ç”Ÿæˆ render æ ‘ è®¡ç®— css æ ·å¼,æ¸²æŸ“æ ‘åªä¼šåŒ…æ‹¬éœ€è¦ç°å®çš„èŠ‚ç‚¹å’Œè¿™äº›èŠ‚ç‚¹çš„æ ·å¼ä¿¡æ¯</li><li>å¸ƒå±€ render æ ‘</li><li>ç»˜åˆ¶ render æ ‘</li><li>æµè§ˆå™¨ä¼šå°†å„å±‚çš„ä¿¡æ¯å‘é€ç»™ GPU,GPU å°†å„å±‚åˆæˆæ˜¾ç¤ºåœ¨å±å¹•ä¸Š</li><li>é‡åˆ° script æ ‡ç­¾æ—¶ï¼Œä¼šæ‰§è¡Œå¹¶é˜»å¡æ¸²æŸ“:å› ä¸ºæµè§ˆå™¨æ¸²æŸ“å’Œ js æ‰§è¡Œå…¬ç”¨ä¸€ä¸ªçº¿ç¨‹,è€Œä¸”è¿™é‡Œå¿…é¡»æ˜¯å•çº¿ç¨‹æ“ä½œ,å¤šçº¿ç¨‹ä¼šäº§ç”Ÿæ¸²æŸ“ DOM å†²çª.ç­‰ script æ ‡ç­¾å®Œæˆå,æµè§ˆå™¨ä¼šç»§ç»­æ¸²æŸ“.è¿™ä¹Ÿå¯ä»¥è§£é‡Šä¸ºä»€ä¹ˆ js æ”¾åœ¨ html åº•éƒ¨,JS æ”¾åœ¨åº•éƒ¨å¯ä»¥ä¿è¯è®©æµè§ˆå™¨ä¼˜å…ˆæ¸²æŸ“å®Œç°æœ‰çš„ HTML å†…å®¹ï¼Œè®©ç”¨æˆ·å…ˆçœ‹åˆ°å†…å®¹ï¼Œä½“éªŒå¥½ã€‚å¦å¤–ï¼ŒJS æ‰§è¡Œå¦‚æœæ¶‰åŠ DOM æ“ä½œï¼Œå¾—ç­‰å¾… DOM è§£æå®Œæˆæ‰è¡Œï¼ŒJS æ”¾åœ¨åº•éƒ¨æ‰§è¡Œæ—¶ï¼ŒHTML è‚¯å®šéƒ½è§£ææˆäº† DOM ç»“æ„ã€‚JS å¦‚æœæ”¾åœ¨ HTML é¡¶éƒ¨ï¼ŒJS æ‰§è¡Œçš„æ—¶å€™ HTML è¿˜æ²¡æ¥å¾—åŠè½¬æ¢ä¸º DOM ç»“æ„ï¼Œå¯èƒ½ä¼šæŠ¥é”™ã€‚</li></ol></blockquote><h3 id="linux-æŒ‡ä»¤"><a href="#linux-æŒ‡ä»¤" class="headerlink" title="linux æŒ‡ä»¤"></a>linux æŒ‡ä»¤</h3><p>æŒ‡ä»¤æœ‰ç‚¹å¤šï¼Œé—®æˆ‘çš„æˆ‘ä¹Ÿè®°ä¸å¤ªæ¸…äº† 2333ï¼Œå¤šçœ‹çœ‹<a href="http://linux.vbird.org/linux_basic/">é¸Ÿå“¥çš„ç§æˆ¿èœ</a>å§</p><h3 id="åŒæºç­–ç•¥æ€ä¹ˆå›äº‹ï¼Ÿä»¥åŠå¦‚ä½•å®ç°è·¨åŸŸè¯·æ±‚"><a href="#åŒæºç­–ç•¥æ€ä¹ˆå›äº‹ï¼Ÿä»¥åŠå¦‚ä½•å®ç°è·¨åŸŸè¯·æ±‚" class="headerlink" title="åŒæºç­–ç•¥æ€ä¹ˆå›äº‹ï¼Ÿä»¥åŠå¦‚ä½•å®ç°è·¨åŸŸè¯·æ±‚"></a>åŒæºç­–ç•¥æ€ä¹ˆå›äº‹ï¼Ÿä»¥åŠå¦‚ä½•å®ç°è·¨åŸŸè¯·æ±‚</h3><blockquote><p>åŒæºç­–ç•¥ç›®çš„æ˜¯ä¸ºäº†ä¿æŠ¤ç”¨æˆ·çš„ä¿¡æ¯å®‰å…¨ï¼Œé˜²æ­¢æ¶æ„çš„ç½‘ç«™çªƒå–æ•°æ®ï¼Œæ¯”å¦‚ A ç½‘ç«™çš„ cookieï¼ŒB ç½‘ç«™å°±ä¸èƒ½ä½¿ç”¨ï¼ŒåŒæºæŒ‡çš„æ˜¯åè®®ï¼Œurlï¼Œç«¯å£å…¨éƒ¨ä¸€è‡´ã€‚å®ç°è·¨åŸŸçš„æ–¹æ³•æœ‰å¤šç§ã€‚<br>åŒæºç­–ç•¥é™åˆ¶äº†ä»¥ä¸‹ä¸‰ç§è¡Œä¸º:</p><ul><li>Ajax è¯·æ±‚ä¸èƒ½å‘é€ï¼Œæ‰€ä»¥å°±å‡ºç°äº†è·¨åŸŸ</li><li>DOM æ— æ³•è·å¾—</li><li>cookieï¼Œlocalstrogeï¼ŒindexDB æ— æ³•è¯»å–<br>è§£å†³ cookie ä¸èƒ½å…±äº«ï¼Œå¯ä»¥è®¾ç½®ç›¸åŒçš„ document.domain å°±å¯ä»¥.<br>è·¨åŸŸè§£å†³æ–¹æ¡ˆ:</li></ul><ol><li>JSONP:JSONP = json + padding å¡«å……å¼ json åˆ©ç”¨çš„æ˜¯åŠ¨æ€åˆ›å»º script æ ‡ç­¾ï¼Œå‘æœåŠ¡å™¨è¯·æ±‚ json æ•°æ®ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼ŒæœåŠ¡å™¨å°†ä¼ å›æ¥çš„æ•°æ®æ”¾åœ¨æŒ‡å®šåå­—çš„å›è°ƒå‡½æ•°ä¸­ä¼ å›æ¥ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°è·¨åŸŸè®¿é—®ã€‚ç®€å•å®ç”¨ï¼Œè€æ—§æµè§ˆå™¨éƒ½é€‚ç”¨,ä½†æ˜¯åªæ”¯æŒ GET è¯·æ±‚ã€‚</li><li>é…ç½® nginx ä»£ç†</li><li>CORS:æœåŠ¡ç«¯è®¾ç½® Access-Control-Allow-Origin å°±å¯ä»¥å¼€å¯ CORSã€‚ è¯¥å±æ€§è¡¨ç¤ºå“ªäº›åŸŸåå¯ä»¥è®¿é—®èµ„æºï¼Œå¦‚æœè®¾ç½®é€šé…ç¬¦åˆ™è¡¨ç¤ºæ‰€æœ‰ç½‘ç«™éƒ½å¯ä»¥è®¿é—®èµ„æºã€‚</li></ol></blockquote><h3 id="ç”¨ä»€ä¹ˆç‰ˆæœ¬æ§åˆ¶å™¨"><a href="#ç”¨ä»€ä¹ˆç‰ˆæœ¬æ§åˆ¶å™¨" class="headerlink" title="ç”¨ä»€ä¹ˆç‰ˆæœ¬æ§åˆ¶å™¨"></a>ç”¨ä»€ä¹ˆç‰ˆæœ¬æ§åˆ¶å™¨</h3><p>gitã€‚git æŒ‡ä»¤æ¨èçœ‹çœ‹ï¼š<a href="https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000">å»–é›ªå³° Git æ•™ç¨‹</a></p><h3 id="é—­åŒ…æ˜¯ä»€ä¹ˆï¼Ÿé—­åŒ…ä¼šå¸¦æ¥ä»€ä¹ˆé—®é¢˜ï¼Ÿ"><a href="#é—­åŒ…æ˜¯ä»€ä¹ˆï¼Ÿé—­åŒ…ä¼šå¸¦æ¥ä»€ä¹ˆé—®é¢˜ï¼Ÿ" class="headerlink" title="é—­åŒ…æ˜¯ä»€ä¹ˆï¼Ÿé—­åŒ…ä¼šå¸¦æ¥ä»€ä¹ˆé—®é¢˜ï¼Ÿ"></a>é—­åŒ…æ˜¯ä»€ä¹ˆï¼Ÿé—­åŒ…ä¼šå¸¦æ¥ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h3><blockquote><p>å½“æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­åˆ›å»ºçš„å‡½æ•°æ‰§è¡Œæ—¶,å¦‚æœè®¿é—®äº†æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­å˜é‡å¯¹è±¡ä¸­çš„å€¼,é—­åŒ…å°±ä¼šäº§ç”Ÿ<br>JavaScript æ‹¥æœ‰è‡ªåŠ¨çš„åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œå…³äºåƒåœ¾å›æ”¶æœºåˆ¶ï¼Œæœ‰ä¸€ä¸ªé‡è¦çš„è¡Œä¸ºï¼Œé‚£å°±æ˜¯ï¼Œå½“ä¸€ä¸ªå€¼ï¼Œåœ¨å†…å­˜ä¸­å¤±å»å¼•ç”¨æ—¶ï¼Œåƒåœ¾å›æ”¶æœºåˆ¶ä¼šæ ¹æ®ç‰¹æ®Šçš„ç®—æ³•æ‰¾åˆ°å®ƒï¼Œå¹¶å°†å…¶å›æ”¶ï¼Œé‡Šæ”¾å†…å­˜ã€‚å‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œåœ¨æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œç”Ÿå‘½å‘¨æœŸç»“æŸï¼Œé‚£ä¹ˆè¯¥å‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡å°±ä¼šå¤±å»å¼•ç”¨ã€‚å…¶å ç”¨çš„å†…å­˜ç©ºé—´å¾ˆå¿«å°±ä¼šè¢«åƒåœ¾å›æ”¶å™¨é‡Šæ”¾ã€‚å¯æ˜¯é—­åŒ…çš„å­˜åœ¨ï¼Œä¼šé˜»æ­¢è¿™ä¸€è¿‡ç¨‹ã€‚<br>é—­åŒ…å‰¯ä½œç”¨ä¼šé€ æˆå†…å­˜æ³„éœ²ï¼Œæ­£é¢ä½œç”¨åˆ©ç”¨é—­åŒ…å¯ä»¥å®ç°å—çº§ä½œç”¨åŸŸï¼ŒIIFEï¼Œæ¨¡å—åŒ–</p></blockquote><h3 id="æ€§èƒ½ä¼˜åŒ–"><a href="#æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–"></a>æ€§èƒ½ä¼˜åŒ–</h3><blockquote><p>æ€§èƒ½ä¼˜åŒ–å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼šå‡å°‘é¡µé¢ä½“ç§¯,æå‡ç½‘ç»œåŠ è½½ å’Œ ä¼˜åŒ–é¡µé¢æ¸²æŸ“</p><ul><li>å‡å°‘é¡µé¢ä½“ç§¯,æå‡ç½‘ç»œåŠ è½½<ul><li>é™æ€èµ„æºçš„å‹ç¼©åˆå¹¶ï¼ˆJS ä»£ç å‹ç¼©åˆå¹¶ã€CSS ä»£ç å‹ç¼©åˆå¹¶ã€é›ªç¢§å›¾ï¼‰</li><li>é™æ€èµ„æºç¼“å­˜ï¼ˆèµ„æºåç§°åŠ  MD5 æˆ³ï¼‰</li><li>ä½¿ç”¨ CDN è®©èµ„æºåŠ è½½æ›´å¿«</li></ul></li><li>ä¼˜åŒ–é¡µé¢æ¸²æŸ“<ul><li>CSS æ”¾å‰é¢ï¼ŒJS æ”¾åé¢</li><li>æ‡’åŠ è½½ï¼ˆå›¾ç‰‡æ‡’åŠ è½½ã€ä¸‹æ‹‰åŠ è½½æ›´å¤šï¼‰</li><li>å‡å°‘ DOM æŸ¥è¯¢ï¼Œå¯¹ DOM æŸ¥è¯¢åšç¼“å­˜</li><li>å‡å°‘ DOM æ“ä½œï¼Œå¤šä¸ªæ“ä½œå°½é‡åˆå¹¶åœ¨ä¸€èµ·æ‰§è¡Œï¼ˆDocumentFragmentï¼‰</li><li>äº‹ä»¶èŠ‚æµ</li><li>å°½æ—©æ‰§è¡Œæ“ä½œï¼ˆDOMContentLoadedï¼‰</li><li>ä½¿ç”¨ SSR åç«¯æ¸²æŸ“ï¼Œæ•°æ®ç›´æ¥è¾“å‡ºåˆ° HTML ä¸­ï¼Œå‡å°‘æµè§ˆå™¨ä½¿ç”¨ JS æ¨¡æ¿æ¸²æŸ“é¡µé¢ HTML çš„æ—¶é—´</li></ul></li></ul></blockquote><h4 id="ä¸ºä»€ä¹ˆæ“ä½œ-DOM-æ…¢"><a href="#ä¸ºä»€ä¹ˆæ“ä½œ-DOM-æ…¢" class="headerlink" title="ä¸ºä»€ä¹ˆæ“ä½œ DOM æ…¢"></a>ä¸ºä»€ä¹ˆæ“ä½œ DOM æ…¢</h4><p>å› ä¸º DOM æ˜¯å±äºæ¸²æŸ“å¼•æ“ä¸­çš„ä¸œè¥¿ï¼Œè€Œ JS åˆæ˜¯ JS å¼•æ“ä¸­çš„ä¸œè¥¿ã€‚å½“é€šè¿‡ JS æ“ä½œ DOM çš„æ—¶å€™ï¼Œå…¶å®è¿™ä¸ªæ“ä½œæ¶‰åŠåˆ°äº†ä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œç„¶åä¼šå¸¦æ¥ä¸€äº›æ€§èƒ½ä¸Šçš„æŸè€—ã€‚æ“ä½œ DOM æ¬¡æ•°ä¸€å¤šï¼Œä¹Ÿå°±ç­‰åŒäºä¸€ç›´åœ¨è¿›è¡Œçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œå¹¶ä¸”æ“ä½œ DOM å¯èƒ½è¿˜ä¼šå¸¦æ¥é‡ç»˜å›æµçš„æƒ…å†µï¼Œæ‰€ä»¥ä¹Ÿå°±å¯¼è‡´äº†æ€§èƒ½ä¸Šçš„é—®é¢˜ã€‚</p><h3 id="å¦‚ä½•é˜»æ­¢äº‹ä»¶å†’æ³¡"><a href="#å¦‚ä½•é˜»æ­¢äº‹ä»¶å†’æ³¡" class="headerlink" title="å¦‚ä½•é˜»æ­¢äº‹ä»¶å†’æ³¡"></a>å¦‚ä½•é˜»æ­¢äº‹ä»¶å†’æ³¡</h3><blockquote><p>dom æ ‡å‡†äº‹ä»¶æµçš„è§¦å‘çš„å…ˆåé¡ºåºä¸ºï¼šå…ˆæ•è·å†å†’æ³¡.äº‹ä»¶æ•è·ï¼šé€šä¿—çš„ç†è§£å°±æ˜¯ï¼Œå½“é¼ æ ‡ç‚¹å‡»æˆ–è€…è§¦å‘ dom äº‹ä»¶æ—¶ï¼Œæµè§ˆå™¨ä¼šä»æ ¹èŠ‚ç‚¹å¼€å§‹ç”±å¤–åˆ°å†…è¿›è¡Œäº‹ä»¶ä¼ æ’­ï¼Œå³ç‚¹å‡»äº†å­å…ƒç´ ï¼Œå¦‚æœçˆ¶å…ƒç´ é€šè¿‡äº‹ä»¶æ•è·æ–¹å¼æ³¨å†Œäº†å¯¹åº”çš„äº‹ä»¶çš„è¯ï¼Œä¼šå…ˆè§¦å‘çˆ¶å…ƒç´ ç»‘å®šçš„äº‹ä»¶ã€‚äº‹ä»¶å†’æ³¡ï¼šä¸äº‹ä»¶æ•è·æ°æ°ç›¸åï¼Œäº‹ä»¶å†’æ³¡é¡ºåºæ˜¯ç”±å†…åˆ°å¤–è¿›è¡Œäº‹ä»¶ä¼ æ’­ï¼Œç›´åˆ°æ ¹èŠ‚ç‚¹ã€‚ä½¿ç”¨ stopPropagation()é˜»æ­¢äº‹ä»¶å†’æ³¡.ä½¿ç”¨ preventDefault()é˜»æ­¢é»˜è®¤è¡Œä¸º</p></blockquote><h2 id="äºŒé¢"><a href="#äºŒé¢" class="headerlink" title="äºŒé¢"></a>äºŒé¢</h2><p>äºŒé¢å’Œä¸€é¢ç›¸éš”äº†ä¸‰å¤©ï¼Œä¸è¿‡ä¸€é¢é¢å®Œçš„ä¸‹åˆå°±å˜æˆäº†å¤è¯•çŠ¶æ€ï¼Œæˆªæ­¢å†™æ­¤æ–‡ä¸ºæ­¢è¿˜æ²¡æ¶ˆæ¯ï¼Œä¸€ç›´æ˜¯å¤è¯•çŠ¶æ€ã€‚æ„Ÿè§‰è¦åŠ é¢ã€‚</p><h3 id="React-æœ‰å“ªäº›ä¼˜ç‚¹"><a href="#React-æœ‰å“ªäº›ä¼˜ç‚¹" class="headerlink" title="React æœ‰å“ªäº›ä¼˜ç‚¹"></a>React æœ‰å“ªäº›ä¼˜ç‚¹</h3><ol><li>ä½¿ç”¨äº†è™šæ‹ŸèŠ‚ç‚¹ï¼Œæ€§èƒ½å¥½</li><li>å› ä¸ºå¼ºè°ƒåªä» this.props å’Œ this.state ç”Ÿæˆ HTMLï¼Œå¯¹å‡½æ•°å¼ç¼–ç¨‹å‹å¥½</li><li>ç”Ÿæ€å¥½ï¼Œåº”å¯¹å„ç§åœºæ™¯çš„åŒ…éƒ½æœ‰ã€‚</li></ol><h3 id="æ€ä¹ˆå®ç°çš„è™šæ‹ŸèŠ‚ç‚¹ï¼Ÿ"><a href="#æ€ä¹ˆå®ç°çš„è™šæ‹ŸèŠ‚ç‚¹ï¼Ÿ" class="headerlink" title="æ€ä¹ˆå®ç°çš„è™šæ‹ŸèŠ‚ç‚¹ï¼Ÿ"></a>æ€ä¹ˆå®ç°çš„è™šæ‹ŸèŠ‚ç‚¹ï¼Ÿ</h3><blockquote><p>è™šæ‹ŸèŠ‚ç‚¹çš„æœ¬è´¨ï¼šè™šæ‹ŸèŠ‚ç‚¹çš„æœ¬è´¨å°±æ˜¯åœ¨ JS å’Œ DOM ä¹‹é—´åšä¸€ä¸ªç¼“å­˜ï¼Œå¯ä»¥ç±»æ¯” CPU å’Œç¡¬ç›˜ï¼Œæ—¢ç„¶ç¡¬ç›˜è¿™ä¹ˆæ…¢ï¼Œæˆ‘ä»¬å°±ä¹Ÿåœ¨ä»–ä»¬ä¹‹é—´æ·»åŠ ä¸€ä¸ªç¼“å­˜ï¼› æ—¢ç„¶ DOM è¿™ä¹ˆæ…¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ JS å’Œ DOM ä¹‹é—´æ·»åŠ ä¸€ä¸ªç¼“å­˜ã€‚ CPUï¼ˆJSï¼‰åªæ“ä½œå†…å­˜ï¼ˆè™šæ‹Ÿ DOMï¼‰ï¼Œæœ€åçš„æ—¶å€™åœ¨æŠŠå˜æ›´å†™å…¥ç¡¬ç›˜ï¼ˆDOMï¼‰ã€‚</p><p>diff ç®—æ³•ï¼š</p><ol><li>ç”¨ Js å¯¹è±¡æ¥è¡¨ç¤º DOM æ ‘çš„ç»“æ„ï¼Œéœ€è¦è®°å½•ä»–çš„èŠ‚ç‚¹ç±»å‹ï¼ˆtagNameï¼‰ã€å±æ€§ï¼ˆpropsï¼‰ã€å­èŠ‚ç‚¹ï¼ˆchildrenï¼‰ï¼› ç„¶åç”¨è¿™ä¸ªæ ‘æ„å»ºä¸€ä¸ªçœŸæ­£çš„ DOM æ ‘ï¼Œæ’å…¥åˆ°æ–‡æ¡£ä¸­ã€‚</li><li>å½“çŠ¶æ€å˜æ›´çš„æ—¶å€™ï¼Œé‡æ–°æ„é€ ä¸€ä¸ªæ–°çš„å¯¹è±¡æ ‘ï¼Œç„¶åç”¨è¿™ä¸ªæ–°çš„æ ‘å’Œæ—§çš„æ ‘ä½œå¯¹æ¯”ï¼Œè®°å½•ä¸¤ä¸ªæ ‘çš„å·®å¼‚ã€‚</li><li>æ·±åº¦éå†ä¼˜å…ˆï¼Œè®°å½•å·®å¼‚</li><li>åœ¨æ·±åº¦ä¼˜å…ˆéå†çš„æ—¶å€™ï¼Œæ¯éå†åˆ°ä¸€ä¸ªèŠ‚ç‚¹å°±æŠŠè¯¥èŠ‚ç‚¹å’Œæ–°çš„æ ‘è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœæœ‰å·®å¼‚çš„è¯å°±è®°å½•åˆ°ä¸€ä¸ªå¯¹è±¡é‡Œé¢ã€‚å·®å¼‚åŒ…æ‹¬ï¼šæ›¿æ¢åŸæ¥çš„èŠ‚ç‚¹ï¼› ç§»åŠ¨ã€åˆ é™¤ã€æ–°å¢å­èŠ‚ç‚¹ï¼›ä¿®æ”¹äº†èŠ‚ç‚¹çš„å±æ€§ã€‚ ï¼›å¯¹äºæ–‡æœ¬èŠ‚ç‚¹ï¼Œæ–‡æœ¬å†…å®¹å¯èƒ½ä¼šæ”¹å˜ã€‚</li><li>æŠŠ 2 æ‰€è®°å½•çš„å·®å¼‚åº”ç”¨åœ¨æ­¥éª¤ä¸€æ‰€æ„å»ºçš„çœŸæ­£çš„ DOM æ ‘ä¸Šï¼Œè§†å›¾å°±æ›´æ–°äº†ã€‚</li></ol></blockquote><h3 id="è§£é‡Šä¸€ä¸‹-304"><a href="#è§£é‡Šä¸€ä¸‹-304" class="headerlink" title="è§£é‡Šä¸€ä¸‹ 304"></a>è§£é‡Šä¸€ä¸‹ 304</h3><p>304 not modifiedï¼Œè¡¨ç¤ºæœåŠ¡å™¨å…è®¸è®¿é—®èµ„æºï¼Œä½†å› ä¸ºå‘ç”Ÿè¯·æ±‚æœªæ»¡è¶³æ¡ä»¶çš„æƒ…å†µã€‚ç”¨äºåå•†ç¼“å­˜ï¼Œç¼“å­˜åˆ†ä¸ºå¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ï¼Œåå•†ç¼“å­˜çš„æœºåˆ¶æ˜¯å¦‚æœç¼“å­˜è¿‡æœŸäº†ï¼Œå°±éœ€è¦å‘èµ·è¯·æ±‚éªŒè¯èµ„æºæ˜¯å¦æœ‰æ›´æ–°ã€‚å½“æµè§ˆå™¨å‘èµ·è¯·æ±‚éªŒè¯èµ„æºæ—¶ï¼Œå¦‚æœèµ„æºæ²¡æœ‰åšæ”¹å˜ï¼Œé‚£ä¹ˆæœåŠ¡ç«¯å°±ä¼šè¿”å› 304 çŠ¶æ€ï¼Œå¹¶ä¸”æ›´æ–°æœåŠ¡å™¨ç¼“å­˜æœ‰æ•ˆæœŸã€‚</p><h3 id="å¦‚ä½•åˆ¤æ–­æœåŠ¡å™¨èµ„æºæ˜¯å¦æ›´æ–°"><a href="#å¦‚ä½•åˆ¤æ–­æœåŠ¡å™¨èµ„æºæ˜¯å¦æ›´æ–°" class="headerlink" title="å¦‚ä½•åˆ¤æ–­æœåŠ¡å™¨èµ„æºæ˜¯å¦æ›´æ–°"></a>å¦‚ä½•åˆ¤æ–­æœåŠ¡å™¨èµ„æºæ˜¯å¦æ›´æ–°</h3><blockquote><p>last-modified:last-modified å’Œ if-modified-since æ˜¯æˆå¯¹å‡ºç°çš„</p><ul><li>last-modified åœ¨å“åº”å¤´é‡Œï¼ŒæœåŠ¡å™¨å‘Šè¯‰æµè§ˆå™¨ï¼Œè¿™ä¸ªèµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´æ˜¯ä»€ä¹ˆ</li><li>if-modified-since åœ¨è¯·æ±‚å¤´é‡Œï¼Œå‘Šè¯‰æœåŠ¡å™¨æˆ‘æ‰€è¯·æ±‚çš„è¿™ä¸ªèµ„æºæœ€åä¿®æ”¹æ—¶é—´æ˜¯ä»€ä¹ˆã€‚æœåŠ¡å™¨æ ¹æ®è¿™ä¸ªå€¼æ¥åˆ¤æ–­ï¼Œå¦‚æœè¿™ä¸ªå€¼å’ŒæœåŠ¡ç«¯è¿™ä¸ªèµ„æºç°æœ‰çš„å€¼ä¸€è‡´ï¼Œç›´æ¥è¿”å› 304 å’Œç©ºçš„ bodyï¼Œå¦‚æœå’ŒæœåŠ¡ç«¯ç°æœ‰çš„å€¼ä¸ä¸€è‡´ï¼ˆèµ„æºå·²ç»æ›´æ–°ï¼‰ï¼Œåˆ™è¿”å› 200 å’Œæœ€æ–°èµ„æºã€‚<br>etag:etag å’Œ if-none-match æ˜¯æˆå¯¹å‡ºç°çš„</li><li>etag æ˜¯æœåŠ¡å™¨æ ¹æ®ä¸€å®šè§„åˆ™ç”Ÿæˆçš„èµ„æºâ€˜æŒ‡çº¹â€™ï¼Œä¼ é€’ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å°†å…¶ä¸ç¼“å­˜ä¸€èµ·ä¿å­˜</li><li>if-none-match æ˜¯å®¢æˆ·ç«¯åœ¨å‘æœåŠ¡ç«¯è¯·æ±‚æŒ‡å®šèµ„æºæ—¶ï¼Œå°†æœ¬åœ°çš„ etag å€¼é€šè¿‡ä¿¡æ¯å¤´ä¼ é€’ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯ä¸å…¶å½“å‰ç‰ˆæœ¬çš„èµ„æºçš„ ETag è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœä¸¤ä¸ªå€¼åŒ¹é…ï¼ˆå³èµ„æºæœªæ›´æ”¹ï¼‰ï¼ŒæœåŠ¡å™¨å°†è¿”å›ä¸å¸¦ä»»ä½•å†…å®¹çš„ 304 æœªä¿®æ”¹çŠ¶æ€ï¼Œå‘Šè¯‰å®¢æˆ·ç«¯ç¼“å­˜ç‰ˆæœ¬å¯ç”¨ã€‚å¦‚æœ etag å€¼åŒ¹é…ä¸æˆåŠŸï¼Œè¿”å› 200 code å’Œèµ„æºå†…å®¹ã€‚</li></ul></blockquote><h3 id="å¯¹-http-äº†è§£å¤šå°‘ï¼Ÿhttp-header-ä¸­éƒ½æœ‰å“ªäº›ä¸œè¥¿ï¼Ÿ"><a href="#å¯¹-http-äº†è§£å¤šå°‘ï¼Ÿhttp-header-ä¸­éƒ½æœ‰å“ªäº›ä¸œè¥¿ï¼Ÿ" class="headerlink" title="å¯¹ http äº†è§£å¤šå°‘ï¼Ÿhttp header ä¸­éƒ½æœ‰å“ªäº›ä¸œè¥¿ï¼Ÿ"></a>å¯¹ http äº†è§£å¤šå°‘ï¼Ÿhttp header ä¸­éƒ½æœ‰å“ªäº›ä¸œè¥¿ï¼Ÿ</h3><blockquote><p>HTTP åè®®æœ€å¤§çš„ç‰¹ç‚¹æ˜¯ã€Œæ— çŠ¶æ€ã€ã€‚å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘èµ·ä¸€ä¸ªè¯·æ±‚ã€‚ç„¶åæœåŠ¡å™¨ç«¯è¿”å›ä¸€ä¸ªå“åº”ã€‚HTTP åè®®ä¼ è¾“çš„å†…å®¹æ˜¯ HTTP messageã€‚<br>æŠ¥æ–‡åˆ†æˆä¸¤ç§ï¼Œä¸€ç§æ˜¯ Request è¯·æ±‚ï¼Œé€šå¸¸ç”¨äºæµè§ˆå™¨å‘Šè¯‰æœåŠ¡å™¨å®ƒæƒ³è¦ä»€ä¹ˆï¼›ä¸€ç§æ˜¯ Response å“åº”ï¼Œé€šå¸¸ç”¨äºæœåŠ¡å™¨ç»™æµè§ˆå™¨è¿”å›å®ƒè¦çš„å†…å®¹ã€‚<br>æŠ¥æ–‡çš„åŸºæœ¬æ ¼å¼ï¼šå¼€å§‹è¡Œï¼Œæ¶ˆæ¯å¤´ï¼Œç©ºè¡Œï¼Œæ¶ˆæ¯ä½“ã€‚<br>Request:è¯·æ±‚è¡Œï¼Œè¯·æ±‚å¤´ï¼Œç©ºè¡Œï¼Œæ¶ˆæ¯ä½“ï¼ˆå¯ç©ºï¼‰</p><ul><li>è¯·æ±‚è¡Œï¼šè¯·æ±‚æ–¹æ³• URI åè®®ç‰ˆæœ¬å· ã€‚</li><li>è¯·æ±‚å¤´ï¼šReferrer è¯·æ±‚å‘èµ·é¡µé¢çš„åœ°å€ User-Agent å®¢æˆ·ç«¯ä¿¡æ¯ Host ä¸»æœºåŸŸå Max-forwards è¯·æ±‚æœ€å¤§è½¬å‘æ¬¡æ•°<br>Responseï¼šçŠ¶æ€è¡Œï¼Œå“åº”å¤´ï¼Œç©ºè¡Œï¼Œæ¶ˆæ¯ä½“ã€‚</li><li>çŠ¶æ€è¡Œï¼šåè®®ç‰ˆæœ¬å· çŠ¶æ€ç </li><li>å“åº”å¤´ï¼šETageï¼šEntity çš„å”¯ä¸€ç¼–ç ï¼Œä¿®æ”¹åæ›´æ–°ï¼›Retry-afterï¼šN ç§’åé‡è¯•ï¼›Locationï¼šè½¬å‘åˆ° Server Web Server ç›¸å…³ä¿¡æ¯<br>æ¶ˆæ¯ä½“ï¼šå¯ç©ºã€‚<br>å®ä½“å¤´å­—æ®µï¼šAllowï¼šæ”¯æŒçš„ HTTP æ–¹æ³•ï¼›Expiresï¼šè¿‡æœŸæ—¶é—´ï¼› Content-Encodingï¼šç¼–ç æ ¼å¼ï¼›Content-Languageï¼šç¼–ç æ ¼å¼ï¼› Content-Lengthï¼šå†…å®¹é•¿åº¦ï¼ˆå­—èŠ‚ï¼‰ï¼›Content-Typeï¼šåª’ä½“ç±»å‹ã€‚</li></ul></blockquote><h3 id="é¡µé¢å‡ºç°ç©ºç™½ï¼Œæ€ä¹ˆæ’æŸ¥å®šä½é—®é¢˜ï¼Ÿ"><a href="#é¡µé¢å‡ºç°ç©ºç™½ï¼Œæ€ä¹ˆæ’æŸ¥å®šä½é—®é¢˜ï¼Ÿ" class="headerlink" title="é¡µé¢å‡ºç°ç©ºç™½ï¼Œæ€ä¹ˆæ’æŸ¥å®šä½é—®é¢˜ï¼Ÿ"></a>é¡µé¢å‡ºç°ç©ºç™½ï¼Œæ€ä¹ˆæ’æŸ¥å®šä½é—®é¢˜ï¼Ÿ</h3><ol><li>å…ˆç¡®ä¿ç½‘ç»œè¿æ¥é€šç•…ã€‚</li><li>æŸ¥çœ‹ç½‘ç»œ url åœ°å€æ˜¯å¦è¾“å…¥æœ‰è¯¯ã€‚</li><li>æ‰“å¼€æ§åˆ¶å°æŸ¥çœ‹æŠ¥é”™ä¿¡æ¯ã€‚</li><li>æŸ¥çœ‹æ¥å£è®¿é—®æ˜¯å¦æœ‰è¯·æ±‚ã€‚</li><li>æŸ¥çœ‹è·¯ç”±æ˜¯å¦æœ‰ path æˆ–è€… name çš„é”™è¯¯ï¼Œå¯¼è‡´åŠ è½½äº†ä¸å­˜åœ¨çš„é¡µé¢ã€‚</li></ol><h3 id="ä¸€ä¸ªçˆ¶å…ƒç´ -div-é‡Œé¢æœ‰-n-ä¸ª-a-æ ‡ç­¾ï¼Œå¯¹-a-æœ‰ä¸€äº›äº‹ä»¶éœ€è¦å¤„ç†ï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ"><a href="#ä¸€ä¸ªçˆ¶å…ƒç´ -div-é‡Œé¢æœ‰-n-ä¸ª-a-æ ‡ç­¾ï¼Œå¯¹-a-æœ‰ä¸€äº›äº‹ä»¶éœ€è¦å¤„ç†ï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ" class="headerlink" title="ä¸€ä¸ªçˆ¶å…ƒç´  div é‡Œé¢æœ‰ n ä¸ª a æ ‡ç­¾ï¼Œå¯¹ a æœ‰ä¸€äº›äº‹ä»¶éœ€è¦å¤„ç†ï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ"></a>ä¸€ä¸ªçˆ¶å…ƒç´  div é‡Œé¢æœ‰ n ä¸ª a æ ‡ç­¾ï¼Œå¯¹ a æœ‰ä¸€äº›äº‹ä»¶éœ€è¦å¤„ç†ï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ</h3><p>ä½¿ç”¨äº‹ä»¶ä»£ç†ï¼Œç»‘å®šåœ¨çˆ¶å…ƒç´ ä¸Šï¼Œçœ‹äº‹ä»¶çš„å‡ºå‘ç‚¹æ˜¯ä¸æ˜¯ a æ ‡ç­¾ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js">$(<span class="hljs-string">&quot;#div&quot;</span>).addEventListener(<span class="hljs-string">&quot;click&quot;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>&#123;<br>  <span class="hljs-comment">// e.target å¯ä»¥ç›‘å¬åˆ°è§¦å‘ç‚¹å‡»äº‹ä»¶çš„å…ƒç´ æ˜¯å“ªä¸€ä¸ª</span><br>  <span class="hljs-keyword">var</span> target = e.target;<br>  <span class="hljs-keyword">if</span> (e.nodeName === <span class="hljs-string">&quot;A&quot;</span>) &#123;<br>    <span class="hljs-comment">// ç‚¹å‡»çš„æ˜¯ &lt;a&gt; å…ƒç´ </span><br>    <span class="hljs-comment">// è¿›è¡Œè¦å¤„ç†çš„å†…å®¹</span><br>  &#125;<br>&#125;);<br></code></pre></div></td></tr></table></figure><h3 id="åˆ©ç”¨äº†ä»€ä¹ˆæ€§è´¨ï¼Ÿ"><a href="#åˆ©ç”¨äº†ä»€ä¹ˆæ€§è´¨ï¼Ÿ" class="headerlink" title="åˆ©ç”¨äº†ä»€ä¹ˆæ€§è´¨ï¼Ÿ"></a>åˆ©ç”¨äº†ä»€ä¹ˆæ€§è´¨ï¼Ÿ</h3><blockquote><p>äº‹ä»¶å†’æ³¡ã€‚dom æ ‡å‡†äº‹ä»¶æµçš„è§¦å‘çš„å…ˆåé¡ºåºä¸ºï¼šå…ˆæ•è·å†å†’æ³¡<br>äº‹ä»¶æ•è·ï¼šé€šä¿—çš„ç†è§£å°±æ˜¯ï¼Œå½“é¼ æ ‡ç‚¹å‡»æˆ–è€…è§¦å‘ dom äº‹ä»¶æ—¶ï¼Œæµè§ˆå™¨ä¼šä»æ ¹èŠ‚ç‚¹å¼€å§‹ç”±å¤–åˆ°å†…è¿›è¡Œäº‹ä»¶ä¼ æ’­ï¼Œå³ç‚¹å‡»äº†å­å…ƒç´ ï¼Œå¦‚æœçˆ¶å…ƒç´ é€šè¿‡äº‹ä»¶æ•è·æ–¹å¼æ³¨å†Œäº†å¯¹åº”çš„äº‹ä»¶çš„è¯ï¼Œä¼šå…ˆè§¦å‘çˆ¶å…ƒç´ ç»‘å®šçš„äº‹ä»¶ã€‚<br>äº‹ä»¶å†’æ³¡ï¼šä¸äº‹ä»¶æ•è·æ°æ°ç›¸åï¼Œäº‹ä»¶å†’æ³¡é¡ºåºæ˜¯ç”±å†…åˆ°å¤–è¿›è¡Œäº‹ä»¶ä¼ æ’­ï¼Œç›´åˆ°æ ¹èŠ‚ç‚¹ã€‚ä½¿ç”¨ stopPropagation()é˜»æ­¢äº‹ä»¶å†’æ³¡.ä½¿ç”¨ preventDefault()é˜»æ­¢é»˜è®¤è¡Œä¸º</p></blockquote><h3 id="å‚ç›´æ°´å¹³å±…ä¸­æ€ä¹ˆåšï¼Ÿ"><a href="#å‚ç›´æ°´å¹³å±…ä¸­æ€ä¹ˆåšï¼Ÿ" class="headerlink" title="å‚ç›´æ°´å¹³å±…ä¸­æ€ä¹ˆåšï¼Ÿ"></a>å‚ç›´æ°´å¹³å±…ä¸­æ€ä¹ˆåšï¼Ÿ</h3><ol><li>åˆ©ç”¨ css3 çš„ translate å±æ€§ï¼Œè®¾ç½®å­å…ƒç´ ä¸ºç»å¯¹å®šä½ï¼Œtopï¼Œleft ä¸º 50%ï¼Œtranslateï¼ˆ-50%ã€‚-50%ï¼‰</li><li>åˆ©ç”¨ flex å¸ƒå±€ï¼Œå¯¹çˆ¶å…ƒç´ ä½¿ç”¨ï¼Œalign-itemsï¼šcenter è®©å…¶åœ¨ä¾§è½´å‚ç›´ï¼Œå°±æ˜¯è¯´å‚ç›´å±…ä¸­,å¦‚æœè¦æ°´å¹³å±…ä¸­çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ justify-cententï¼šcenter</li></ol><h3 id="å¯¹äºæ€§èƒ½ä¼˜åŒ–ä½ æœ‰ä»€ä¹ˆçœ‹æ³•"><a href="#å¯¹äºæ€§èƒ½ä¼˜åŒ–ä½ æœ‰ä»€ä¹ˆçœ‹æ³•" class="headerlink" title="å¯¹äºæ€§èƒ½ä¼˜åŒ–ä½ æœ‰ä»€ä¹ˆçœ‹æ³•"></a>å¯¹äºæ€§èƒ½ä¼˜åŒ–ä½ æœ‰ä»€ä¹ˆçœ‹æ³•</h3><p>å‚çœ‹ä¸€é¢</p><h3 id="ä¸ºä»€ä¹ˆè¯´-dom-æ“ä½œè€—æ—¶ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¯´-dom-æ“ä½œè€—æ—¶ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¯´ dom æ“ä½œè€—æ—¶ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¯´ dom æ“ä½œè€—æ—¶ï¼Ÿ</h3><p>å› ä¸º DOM æ˜¯å±äºæ¸²æŸ“å¼•æ“ä¸­çš„ä¸œè¥¿ï¼Œè€Œ JS åˆæ˜¯ JS å¼•æ“ä¸­çš„ä¸œè¥¿ã€‚å½“é€šè¿‡ JS æ“ä½œ DOM çš„æ—¶å€™ï¼Œè¿™ä¸ªæ“ä½œæ¶‰åŠåˆ°äº†ä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œç„¶åä¼šå¸¦æ¥ä¸€äº›æ€§èƒ½ä¸Šçš„æŸè€—ã€‚æ“ä½œ DOM æ¬¡æ•°ä¸€å¤šï¼Œä¹Ÿå°±ç­‰åŒäºä¸€ç›´åœ¨è¿›è¡Œçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚æ“ä½œ DOM å¯èƒ½è¿˜ä¼šå¸¦æ¥é‡ç»˜å›æµçš„æƒ…å†µï¼Œæ‰€ä»¥ä¹Ÿå°±å¯¼è‡´äº†æ€§èƒ½ä¸Šçš„é—®é¢˜ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯é‡ç»˜ï¼Ÿä»€ä¹ˆæ˜¯å›æµï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯é‡ç»˜ï¼Ÿä»€ä¹ˆæ˜¯å›æµï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯é‡ç»˜ï¼Ÿä»€ä¹ˆæ˜¯å›æµï¼Ÿ"></a>ä»€ä¹ˆæ˜¯é‡ç»˜ï¼Ÿä»€ä¹ˆæ˜¯å›æµï¼Ÿ</h3><blockquote><p>é‡ç»˜æ˜¯å½“èŠ‚ç‚¹éœ€è¦æ›´æ”¹å¤–è§‚è€Œä¸ä¼šå½±å“å¸ƒå±€çš„ï¼Œæ¯”å¦‚æ”¹å˜ color å°±å«ç§°ä¸ºé‡ç»˜<br>å›æµæ˜¯å¸ƒå±€æˆ–è€…å‡ ä½•å±æ€§éœ€è¦æ”¹å˜å°±ç§°ä¸ºå›æµã€‚<br>å›æµä¸€å®šä¼šè§¦å‘é‡ç»˜ï¼Œè€Œé‡ç»˜ä¸ä¸€å®šä¼šå›æµ<br>åŸå› :</p><ul><li>æ·»åŠ æˆ–åˆ é™¤å¯è§çš„ DOM å…ƒç´ </li><li>å…ƒç´ çš„ä½ç½®å‘ç”Ÿå˜åŒ–</li><li>å…ƒç´ çš„å°ºå¯¸å‘ç”Ÿå˜åŒ–ï¼ˆåŒ…æ‹¬å¤–è¾¹è·ã€å†…è¾¹æ¡†ã€è¾¹æ¡†å¤§å°ã€é«˜åº¦å’Œå®½åº¦ç­‰ï¼‰</li><li>å†…å®¹å‘ç”Ÿå˜åŒ–ï¼Œæ¯”å¦‚æ–‡æœ¬å˜åŒ–æˆ–å›¾ç‰‡è¢«å¦ä¸€ä¸ªä¸åŒå°ºå¯¸çš„å›¾ç‰‡æ‰€æ›¿ä»£ã€‚</li><li>é¡µé¢ä¸€å¼€å§‹æ¸²æŸ“çš„æ—¶å€™ï¼ˆè¿™è‚¯å®šé¿å…ä¸äº†ï¼‰</li><li>æµè§ˆå™¨çš„çª—å£å°ºå¯¸å˜åŒ–ï¼ˆå› ä¸ºå›æµæ˜¯æ ¹æ®è§†å£çš„å¤§å°æ¥è®¡ç®—å…ƒç´ çš„ä½ç½®å’Œå¤§å°çš„ï¼‰</li></ul><p>å¦‚ä½•é¿å…:</p><ul><li>ä½¿ç”¨ transform æ›¿ä»£ top,left,right,bottom</li><li>ä½¿ç”¨ visibility æ›¿æ¢ display:none,å‰è€…åªä¼šé‡ç»˜,åè€…ä¼šå¼•å‘å›æµ</li><li>ä¸æŠŠç•Œé¢çš„å±æ€§å€¼æ”¾åœ¨ä¸€ä¸ªå¾ªç¯é‡Œå½“å¾ªç¯çš„å˜é‡</li><li>ä¸ç”¨ table å¸ƒå±€</li></ul></blockquote>]]></content>
    
    
    <categories>
      
      <category>æ—§åšå®¢æ–‡ç« </category>
      
    </categories>
    
    
    <tags>
      
      <tag>é¢ç»</tag>
      
      <tag>å‰ç«¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>çŒè±¹ç§»åŠ¨å¤§å‰ç«¯é¢è¯•-æ ¡æ‹›-2020å±Š</title>
    <link href="/article/2e796c8e/"/>
    <url>/article/2e796c8e/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€é¢"><a href="#ä¸€é¢" class="headerlink" title="ä¸€é¢"></a>ä¸€é¢</h2><h3 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h3><h4 id="ç›’æ¨¡å‹"><a href="#ç›’æ¨¡å‹" class="headerlink" title="ç›’æ¨¡å‹"></a>ç›’æ¨¡å‹</h4><p>ç›’æ¨¡å‹æœ‰ä¸¤ç§æ ‡å‡†ï¼Œä¸€ä¸ªæ˜¯æ ‡å‡†æ¨¡å‹ï¼Œä¸€ä¸ªæ˜¯ IE æ¨¡å‹ã€‚<br>åœ¨æ ‡å‡†æ¨¡å‹ä¸­ï¼Œç›’æ¨¡å‹çš„å®½é«˜åªæ˜¯å†…å®¹ï¼ˆcontentï¼‰çš„å®½é«˜ï¼Œ<br>è€Œåœ¨ IE æ¨¡å‹ä¸­ç›’æ¨¡å‹çš„å®½é«˜æ˜¯å†…å®¹(content)+å¡«å……(padding)+è¾¹æ¡†(border)çš„æ€»å®½é«˜ã€‚<br><img src="https://chenxiumiao-1252816278.cos.ap-beijing.myqcloud.com/2019/10/11/15707306022767.jpg" alt="-w435"></p><h3 id="JS"><a href="#JS" class="headerlink" title="JS"></a>JS</h3><h4 id="é—­åŒ…"><a href="#é—­åŒ…" class="headerlink" title="é—­åŒ…"></a>é—­åŒ…</h4><p>é—­åŒ…æ˜¯æŒ‡ä¸€ä¸ªä½œç”¨åŸŸä¸­çš„å‡½æ•°å¯ä»¥è®¿é—®è¯¥ä½œç”¨åŸŸä¸­çš„å‡½æ•°ï¼Œå˜é‡ç­‰ã€‚å½“ä¸€ä¸ªå€¼ï¼Œåœ¨å†…å­˜ä¸­å¤±å»å¼•ç”¨æ—¶ï¼Œåƒåœ¾å›æ”¶æœºåˆ¶ä¼šæ ¹æ®ç‰¹æ®Šçš„ç®—æ³•æ‰¾åˆ°å®ƒï¼Œå¹¶å°†å…¶å›æ”¶ï¼Œé‡Šæ”¾å†…å­˜ã€‚å‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡åœ¨æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œç”Ÿå‘½å‘¨æœŸç»“æŸï¼Œè¯¥å‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡å°±ä¼šå¤±å»å¼•ç”¨ã€‚å…¶å ç”¨çš„å†…å­˜ç©ºé—´å¾ˆå¿«å°±ä¼šè¢«åƒåœ¾å›æ”¶å™¨é‡Šæ”¾ã€‚é—­åŒ…çš„å­˜åœ¨ï¼Œä¼šé˜»æ­¢è¿™ä¸€è¿‡ç¨‹ã€‚</p><h4 id="this"><a href="#this" class="headerlink" title="this"></a>this</h4><p>1.å…¨å±€å¯¹è±¡ä¸­çš„ this æŒ‡å‘å®ƒæœ¬èº« 2.å‡½æ•°ä¸­çš„ this</p><blockquote><p>åœ¨ä¸€ä¸ªå‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ï¼Œthis ç”±è¯¥å‡½æ•°çš„è°ƒç”¨è€…æä¾›ï¼Œç”±è°ƒç”¨å‡½æ•°çš„æ–¹å¼å†³å®šå…¶æŒ‡å‘ã€‚<br>å¦‚æœè°ƒç”¨è€…è¢«æŸä¸€ä¸ªå¯¹è±¡æ‰€æ‹¥æœ‰ï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œå†…éƒ¨çš„ this æŒ‡å‘è¯¥å¯¹è±¡ã€‚å¦‚æœè°ƒç”¨è€…å‡½æ•°ç‹¬ç«‹è°ƒç”¨ï¼Œé‚£ä¹ˆè¯¥å‡½æ•°å†…éƒ¨çš„ this åˆ™æŒ‡å‘ undefinedã€‚åœ¨éä¸¥æ ¼æ¨¡å¼ä¸­ï¼Œå½“ this æŒ‡å‘ undefined æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨æŒ‡å‘å…¨å±€å¯¹è±¡ã€‚<br>call/apply/bind æ˜¾å¼æŒ‡å®š thisã€‚</p></blockquote><h4 id="ES6"><a href="#ES6" class="headerlink" title="ES6"></a>ES6</h4><h5 id="æ–°å¢å†…å®¹"><a href="#æ–°å¢å†…å®¹" class="headerlink" title="æ–°å¢å†…å®¹"></a>æ–°å¢å†…å®¹</h5><ul><li>æ–°çš„å˜é‡å£°æ˜æ–¹å¼ let/const</li><li>ç®­å¤´å‡½æ•°</li><li>æ¨¡æ¿å­—ç¬¦ä¸²</li><li>è§£æç»“æ„</li><li>å‡½æ•°é»˜è®¤å‚æ•°</li><li>å±•å¼€è¿ç®—ç¬¦</li><li>class,construction,extends</li><li>promise</li><li>Module</li></ul><h5 id="foreach-ç”¨æ³•"><a href="#foreach-ç”¨æ³•" class="headerlink" title="foreach ç”¨æ³•"></a>foreach ç”¨æ³•</h5><p><img src="https://chenxiumiao-1252816278.cos.ap-beijing.myqcloud.com/2019/10/11/15707313633613.jpg" alt="-w536"></p><h3 id="æ¡†æ¶ç›¸å…³"><a href="#æ¡†æ¶ç›¸å…³" class="headerlink" title="æ¡†æ¶ç›¸å…³"></a>æ¡†æ¶ç›¸å…³</h3><h4 id="React-ç”Ÿå‘½å‘¨æœŸ"><a href="#React-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="React ç”Ÿå‘½å‘¨æœŸ"></a>React ç”Ÿå‘½å‘¨æœŸ</h4><p>React ç”Ÿå‘½å‘¨æœŸåˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼šè£…è½½ï¼Œæ›´æ–°ï¼Œå¸è½½</p><p>è£…è½½é˜¶æ®µä¸­ä¼šä¾æ¬¡æ‰§è¡Œä»¥ä¸‹å‡½æ•°ï¼š</p><ol><li>constructor</li><li>getInitialState</li><li>getDefaultProps</li><li>componentWillMount</li><li>render</li><li>componentDidMount</li></ol><p>æ›´æ–°é˜¶æ®µä¼šä¾æ¬¡æ‰§è¡Œä»¥ä¸‹å‡½æ•°</p><ol><li>componentWillReceiveProps</li><li>shouldComponentUpdate</li><li>componentWillUpdate</li><li>render</li><li>componentDidUpdate</li></ol><p>å¸è½½é˜¶æ®µä¼šæ‰§è¡Œï¼šcomponentWillUnmount</p><h4 id="ç»„ä»¶é€šä¿¡"><a href="#ç»„ä»¶é€šä¿¡" class="headerlink" title="ç»„ä»¶é€šä¿¡"></a>ç»„ä»¶é€šä¿¡</h4><ul><li><p>çˆ¶å­é€šä¿¡<br>çˆ¶ç»„ä»¶é€šè¿‡ props ä¼ é€’æ•°æ®ç»™å­ç»„ä»¶ï¼Œå­ç»„ä»¶é€šè¿‡è°ƒç”¨çˆ¶ç»„ä»¶ä¼ æ¥çš„å‡½æ•°ä¼ é€’æ•°æ®ç»™çˆ¶ç»„ä»¶ï¼Œè¿™ä¸¤ç§æ–¹å¼æ˜¯æœ€å¸¸ç”¨çš„çˆ¶å­é€šä¿¡å®ç°åŠæ³•ã€‚<br>è¿™ç§çˆ¶å­é€šä¿¡æ–¹å¼ä¹Ÿå°±æ˜¯å…¸å‹çš„å•å‘æ•°æ®æµï¼Œçˆ¶ç»„ä»¶é€šè¿‡ props ä¼ é€’æ•°æ®ï¼Œå­ç»„ä»¶ä¸èƒ½ç›´æ¥ä¿®æ”¹ propsï¼Œ è€Œæ˜¯å¿…é¡»é€šè¿‡è°ƒç”¨çˆ¶ç»„ä»¶å‡½æ•°çš„æ–¹å¼å‘ŠçŸ¥çˆ¶ç»„ä»¶ä¿®æ”¹æ•°æ®ã€‚</p></li><li><p>å…„å¼Ÿç»„ä»¶é€šä¿¡<br>å¯¹äºè¿™ç§æƒ…å†µå¯ä»¥é€šè¿‡å…±åŒçš„çˆ¶ç»„ä»¶æ¥ç®¡ç†çŠ¶æ€å’Œäº‹ä»¶å‡½æ•°ã€‚æ¯”å¦‚è¯´å…¶ä¸­ä¸€ä¸ªå…„å¼Ÿç»„ä»¶è°ƒç”¨çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„äº‹ä»¶å‡½æ•°ä¿®æ”¹çˆ¶ç»„ä»¶ä¸­çš„çŠ¶æ€ï¼Œç„¶åçˆ¶ç»„ä»¶å°†çŠ¶æ€ä¼ é€’ç»™å¦ä¸€ä¸ªå…„å¼Ÿç»„ä»¶ã€‚</p></li><li><p>è·¨å¤šå±‚æ¬¡ç»„ä»¶é€šä¿¡<br>Context APIã€‚</p></li></ul><h3 id="ç½‘ç»œ"><a href="#ç½‘ç»œ" class="headerlink" title="ç½‘ç»œ"></a>ç½‘ç»œ</h3><h4 id="http-çŠ¶æ€ç "><a href="#http-çŠ¶æ€ç " class="headerlink" title="http çŠ¶æ€ç "></a>http çŠ¶æ€ç </h4><h5 id="2XX-æˆåŠŸ"><a href="#2XX-æˆåŠŸ" class="headerlink" title="2XX æˆåŠŸ"></a>2XX æˆåŠŸ</h5><ul><li>200 OKï¼Œè¡¨ç¤ºä»å®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚åœ¨æœåŠ¡å™¨ç«¯è¢«æ­£ç¡®å¤„ç†</li><li>204 No contentï¼Œè¡¨ç¤ºè¯·æ±‚æˆåŠŸï¼Œä½†å“åº”æŠ¥æ–‡ä¸å«å®ä½“çš„ä¸»ä½“éƒ¨åˆ†</li><li>205 Reset Contentï¼Œè¡¨ç¤ºè¯·æ±‚æˆåŠŸï¼Œä½†å“åº”æŠ¥æ–‡ä¸å«å®ä½“çš„ä¸»ä½“éƒ¨åˆ†ï¼Œä½†æ˜¯ä¸ 204 å“åº”ä¸åŒåœ¨äºè¦æ±‚è¯·æ±‚æ–¹é‡ç½®å†…å®¹</li><li>206 Partial Contentï¼Œè¿›è¡ŒèŒƒå›´è¯·æ±‚</li></ul><h5 id="3XX-é‡å®šå‘"><a href="#3XX-é‡å®šå‘" class="headerlink" title="3XX é‡å®šå‘"></a>3XX é‡å®šå‘</h5><ul><li>301 moved permanentlyï¼Œæ°¸ä¹…æ€§é‡å®šå‘ï¼Œè¡¨ç¤ºèµ„æºå·²è¢«åˆ†é…äº†æ–°çš„ URL</li><li>302 foundï¼Œä¸´æ—¶æ€§é‡å®šå‘ï¼Œè¡¨ç¤ºèµ„æºä¸´æ—¶è¢«åˆ†é…äº†æ–°çš„ URL</li><li>303 see otherï¼Œè¡¨ç¤ºèµ„æºå­˜åœ¨ç€å¦ä¸€ä¸ª URLï¼Œåº”ä½¿ç”¨ GET æ–¹æ³•è·å–èµ„æº</li><li>304 not modifiedï¼Œè¡¨ç¤ºæœåŠ¡å™¨å…è®¸è®¿é—®èµ„æºï¼Œä½†å› å‘ç”Ÿè¯·æ±‚æœªæ»¡è¶³æ¡ä»¶çš„æƒ…å†µ</li><li>307 temporary redirectï¼Œä¸´æ—¶é‡å®šå‘ï¼Œå’Œ 302 å«ä¹‰ç±»ä¼¼ï¼Œä½†æ˜¯æœŸæœ›å®¢æˆ·ç«¯ä¿æŒè¯·æ±‚æ–¹æ³•ä¸å˜å‘æ–°çš„åœ°å€å‘å‡ºè¯·æ±‚</li></ul><h5 id="4XX-å®¢æˆ·ç«¯é”™è¯¯"><a href="#4XX-å®¢æˆ·ç«¯é”™è¯¯" class="headerlink" title="4XX å®¢æˆ·ç«¯é”™è¯¯"></a>4XX å®¢æˆ·ç«¯é”™è¯¯</h5><ul><li>400 bad requestï¼Œè¯·æ±‚æŠ¥æ–‡å­˜åœ¨è¯­æ³•é”™è¯¯</li><li>401 unauthorizedï¼Œè¡¨ç¤ºå‘é€çš„è¯·æ±‚éœ€è¦æœ‰é€šè¿‡ HTTP è®¤è¯çš„è®¤è¯ä¿¡æ¯</li><li>403 forbiddenï¼Œè¡¨ç¤ºå¯¹è¯·æ±‚èµ„æºçš„è®¿é—®è¢«æœåŠ¡å™¨æ‹’ç»</li><li>404 not foundï¼Œè¡¨ç¤ºåœ¨æœåŠ¡å™¨ä¸Šæ²¡æœ‰æ‰¾åˆ°è¯·æ±‚çš„èµ„æº</li></ul><h5 id="5XX-æœåŠ¡å™¨é”™è¯¯"><a href="#5XX-æœåŠ¡å™¨é”™è¯¯" class="headerlink" title="5XX æœåŠ¡å™¨é”™è¯¯"></a>5XX æœåŠ¡å™¨é”™è¯¯</h5><ul><li>500 internal sever errorï¼Œè¡¨ç¤ºæœåŠ¡å™¨ç«¯åœ¨æ‰§è¡Œè¯·æ±‚æ—¶å‘ç”Ÿäº†é”™è¯¯</li><li>501 Not Implementedï¼Œè¡¨ç¤ºæœåŠ¡å™¨ä¸æ”¯æŒå½“å‰è¯·æ±‚æ‰€éœ€è¦çš„æŸä¸ªåŠŸèƒ½</li><li>503 service unavailableï¼Œè¡¨æ˜æœåŠ¡å™¨æš‚æ—¶å¤„äºè¶…è´Ÿè½½æˆ–æ­£åœ¨åœæœºç»´æŠ¤ï¼Œæ— æ³•å¤„ç†è¯·æ±‚</li></ul><h3 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h3><h4 id="æ’åºç®—æ³•"><a href="#æ’åºç®—æ³•" class="headerlink" title="æ’åºç®—æ³•"></a>æ’åºç®—æ³•</h4><h5 id="å¿«æ’"><a href="#å¿«æ’" class="headerlink" title="å¿«æ’"></a>å¿«æ’</h5>]]></content>
    
    
    <categories>
      
      <category>æ—§åšå®¢æ–‡ç« </category>
      
    </categories>
    
    
    <tags>
      
      <tag>é¢ç»</tag>
      
      <tag>å‰ç«¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MWebå‘å¸ƒæœåŠ¡é…ç½®ä¸å›¾åºŠé…ç½®æ•™ç¨‹</title>
    <link href="/article/a6acd6f/"/>
    <url>/article/a6acd6f/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä½¿ç”¨ MWeb å®Œå…¨æ˜¯å› ä¸ºå†™åšå®¢ï¼Œåå¤æ‰“å¼€åšå®¢è¿›è¡Œç¼–è¾‘ä¸å¤ªæ–¹ä¾¿ã€‚å°±å»æ‰¾äº†ä¸€ä¸‹æ˜¯å¦æœ‰æœ¬åœ°çš„ä¸œè¥¿èƒ½è·Ÿåšå®¢æ¥å£è¿æ¥çš„ä¸œè¥¿ã€‚</p><h2 id="å‘å¸ƒæœåŠ¡çš„é…ç½®"><a href="#å‘å¸ƒæœåŠ¡çš„é…ç½®" class="headerlink" title="å‘å¸ƒæœåŠ¡çš„é…ç½®"></a>å‘å¸ƒæœåŠ¡çš„é…ç½®</h2><ol><li>é¦–å…ˆè¿›å…¥ typecho çš„åå°ï¼Œæ‰“å¼€<code>è®¾ç½®-åŸºæœ¬</code>æ‰¾åˆ°<code>XMLRPC æ¥å£</code>å°†å…¶è®¾ç½®ä¸ºæ‰“å¼€</li><li>æ‰“å¼€<code>æ§åˆ¶å°-ä¸ªäººè®¾ç½®</code>ï¼Œæ‰“å¼€<code>åœ¨ XMLRPC æ¥å£ä¸­ä½¿ç”¨ Markdown è¯­æ³•</code>ï¼ˆä¸æ‰“å¼€çš„è¯ä¼šè¢«è§£æä¸º htmlï¼Œå½“æ—¶è¢«è¿™ä¸ªçº ç»“è¿‡ã€‚ï¼‰</li><li>æ‰“å¼€ MWeb çš„<code>åå¥½è®¾ç½®-å‘å¸ƒæœåŠ¡</code>ï¼Œç‚¹å‡»<code>Metawebblog API</code>ã€‚æŒ‰ç…§è¦æ±‚å¡«å†™å³å¯ã€‚ç„¶åç‚¹å‡»æµ‹è¯•å³å¯ã€‚</li></ol><blockquote><p>æ³¨ï¼šAPI åœ°å€ä¸ºï¼šåšå®¢ç½‘å€/action/xmlrpc è´¦å·å¯†ç ä¸ºå‘å¸ƒäººçš„è´¦å·å¯†ç ã€‚</p></blockquote><h2 id="å›¾åºŠé…ç½®"><a href="#å›¾åºŠé…ç½®" class="headerlink" title="å›¾åºŠé…ç½®"></a>å›¾åºŠé…ç½®</h2><p>æˆ‘ä»¬éœ€è¦ä¸¤ä¸ªæ’ä»¶ï¼Œ<code>coscmd</code>å’Œ<code>qcloud-cos-mweb</code>ã€‚ä»–ä»¬çš„ github è¿æ¥å¦‚ä¸‹ã€‚</p><p>[button color=â€infoâ€ icon=â€glyphicon glyphicon-download-altâ€ url=â€<a href="https://github.com/tencentyun/coscmd&quot;">https://github.com/tencentyun/coscmd&quot;</a> type=â€â€]Coscmd[/button]</p><p>[button color=â€infoâ€ icon=â€glyphicon glyphicon-download-altâ€ url=â€<a href="https://github.com/scue/qcloud-cos-mweb&quot;">https://github.com/scue/qcloud-cos-mweb&quot;</a> type=â€â€]qcloud-cos-mweb[/button]</p><ol><li>å®‰è£…<code>coscmd</code>ï¼Œæ‰“å¼€æ§åˆ¶å°ã€‚è¾“å…¥<code>pip3 install coscmd == 1.8.5.5</code>ï¼ˆéœ€è¦å®‰è£…è¿‡ python3,ä¸ºä»€ä¹ˆé€‰æ‹© coscmd çš„ 1.8.5.5 ç‰ˆæœ¬ï¼Ÿå› ä¸ºæœ€æ–°ç‰ˆæœ‰ BUGã€‚æŸ¥è¿‡ issue åå¾—çŸ¥åªæœ‰ 1.8.5.5 å¯ä»¥ä½¿ç”¨ã€‚ï¼‰</li><li>æ‰¾ä¸ªè‡ªå·±èƒ½æ‰¾åˆ°çš„åœ°æ–¹è¾“å…¥<code>git clone https://github.com/scue/qcloud-cos-mweb.git</code>å°†å…¶ä¸‹è½½åˆ°æœ¬åœ°ã€‚</li><li>è¾“å…¥<code>coscmd config -a &lt;secret_id&gt; -s &lt;secret_key&gt; -b &lt;bucket&gt; -r &lt;region&gt;</code>ï¼Œæˆ–è€…ç›´æ¥<code>vim ~/.cos.conf</code>æ¥è®¾ç½®ç›¸å…³ä¿¡æ¯<ul><li><code>&lt;secret_id&gt;</code> ä¸ <code>&lt;secret_key&gt;</code>å¯ä»¥åœ¨è…¾è®¯äº‘çš„<code>æ§åˆ¶å°-è®¿é—®ç®¡ç†-APIå¯†é’¥ç®¡ç†</code>ä¸­æŸ¥çœ‹</li><li><code>&lt;bucket&gt;</code>å¯¹åº”<code>å¯¹è±¡å­˜å‚¨-ç›¸åº”çš„å­˜å‚¨æ¡¶-åŸºç¡€é…ç½®</code>ä¸­çš„ç©ºé—´åç§°</li><li><code>&lt;region&gt;</code>å¯¹åº”<code>æ‰€å±åœ°åŸŸ</code>åçš„<code>ap-xxxx</code></li><li>å¦‚æœæ˜¯é€šè¿‡ vim ä¿®æ”¹çš„é…ç½®éœ€è¦ä»¥ä¸‹ä¿¡æ¯ï¼š<img src="https://chenxiumiao-1252816278.cos.ap-beijing.myqcloud.com/blog/15562976545322.jpg" alt="-w453"></li></ul></li><li>ç”¨æ§åˆ¶å°è¿›å…¥åˆ°<code>qcloud-cos-mweb</code>ï¼Œè¾“å…¥<code>./qcloud-cos-upload -help</code>æŸ¥çœ‹ç›‘å¬åœ°å€ã€‚ç„¶åè¾“å…¥<code>./qcloud-cos-upload</code>è¿è¡Œè¯¥æœåŠ¡ã€‚</li><li>åœ¨å›¾åºŠè‡ªå®šä¹‰ API åœ°å€è¾“å…¥ï¼š<code>http://ç›‘å¬åœ°å€/upload</code>ï¼Œå…¶ä½™æŒ‰ç…§å–œå¥½å¡«å†™å³å¯ã€‚</li></ol><h2 id="ç»“å°¾"><a href="#ç»“å°¾" class="headerlink" title="ç»“å°¾"></a>ç»“å°¾</h2><p>ä»¥åä½¿ç”¨ Mweb å‘å¸ƒæ–‡ç« æ—¶ï¼Œå¦‚æœæ–‡ç« å†…æœ‰å›¾ç‰‡çš„è¯éœ€è¦å…ˆç‚¹æŠŠå›¾ç‰‡ä¸Šä¼ è‡³å›¾åºŠï¼Œç„¶ååœ¨ç‚¹å‡»åšå®¢åç§°å°±å¯ä»¥å‘å¸ƒæ–‡ç« äº†ã€‚åœ¨å‘å¸ƒæ–‡ç« æ—¶ä¸€å®šè¦é€‰æ‹©å‘å¸ƒä¸º MarkDownã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æ—§åšå®¢æ–‡ç« </category>
      
    </categories>
    
    
    <tags>
      
      <tag>MWEB</tag>
      
      <tag>å·¥å…·</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
